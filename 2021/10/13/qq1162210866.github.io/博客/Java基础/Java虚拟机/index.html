<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="JVM基础概念​    Java源文件通过编译器产生class文件，字节码文件再通过Java虚拟机中的解释器，编译成特定机器上的机器码。这也是Java跨平台的原因。 JVM内存区域​    Java内存模型分为两大类，线程私有和共享数据。线程私有：程序计数器、虚拟机栈、本地方法栈。共享数据有：常量池（方法区的一部分）、方法区、Java堆。如下图：   程序计数器：当前线程执行的字节码行号指示器。">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/Java%E5%9F%BA%E7%A1%80/Java%E8%99%9A%E6%8B%9F%E6%9C%BA/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="JVM基础概念​    Java源文件通过编译器产生class文件，字节码文件再通过Java虚拟机中的解释器，编译成特定机器上的机器码。这也是Java跨平台的原因。 JVM内存区域​    Java内存模型分为两大类，线程私有和共享数据。线程私有：程序计数器、虚拟机栈、本地方法栈。共享数据有：常量池（方法区的一部分）、方法区、Java堆。如下图：   程序计数器：当前线程执行的字节码行号指示器。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/IMG_21E692D0E9A8-1.jpeg">
<meta property="og:image" content="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/IMG_A22B848C2C43-1.jpeg">
<meta property="og:image" content="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/IMG_B2026A3771A2-1.jpeg">
<meta property="article:published_time" content="2021-10-13T13:28:21.187Z">
<meta property="article:modified_time" content="2021-10-13T13:28:21.187Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/IMG_21E692D0E9A8-1.jpeg">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-qq1162210866.github.io/博客/Java基础/Java虚拟机" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/Java%E5%9F%BA%E7%A1%80/Java%E8%99%9A%E6%8B%9F%E6%9C%BA/" class="article-date">
  <time datetime="2021-10-13T13:28:21.187Z" itemprop="datePublished">2021-10-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="JVM基础概念"><a href="#JVM基础概念" class="headerlink" title="JVM基础概念"></a>JVM基础概念</h2><p>​    Java源文件通过编译器产生class文件，字节码文件再通过Java虚拟机中的解释器，编译成特定机器上的机器码。这也是Java跨平台的原因。</p>
<h3 id="JVM内存区域"><a href="#JVM内存区域" class="headerlink" title="JVM内存区域"></a>JVM内存区域</h3><p>​    Java内存模型分为两大类，线程私有和共享数据。线程私有：程序计数器、虚拟机栈、本地方法栈。共享数据有：常量池（方法区的一部分）、方法区、Java堆。如下图：</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/IMG_21E692D0E9A8-1.jpeg" alt="IMG_21E692D0E9A8-1"></p>
<ul>
<li>程序计数器：当前线程执行的字节码行号指示器。</li>
<li>虚拟机栈：Java方法执行的内存模型，生命周期和线程一致。栈帧是进行方法执行的数据结构。虚拟机栈主要有两种异常：堆栈异常和内存超出异常。</li>
<li>本地方法栈：虚拟机使用到的native方法的内存空间。抛出的异常也是堆栈异常和内存超出异常。</li>
<li>堆：主要存放着对象的实例和数组的数据。抛出的异常为内存溢出异常。</li>
</ul>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/IMG_A22B848C2C43-1.jpeg" alt="IMG_A22B848C2C43-1"></p>
<ul>
<li>方法区：主要存放虚拟机加载的类信息、常量、静态变量、编译后的代码。主要抛出内存溢出异常。</li>
<li>运行时常量池：属于方法区的一部分，主要存放编译器生成的各种字面量和符号的引用。不会抛出内存溢出异常。</li>
</ul>
<h3 id="垃圾回收算法"><a href="#垃圾回收算法" class="headerlink" title="垃圾回收算法"></a>垃圾回收算法</h3><ul>
<li>标记清除算法：将存活的对象标记，然后将为标记的对象的内存空间进行回收。</li>
<li>复制算法：将内存空间分为两块，一块用满后，将存活对象复制到另外一块，然后直接将之前的内存空间清理掉。</li>
<li>标记整理算法：将存活对象进行标记，然后将存活的对象都移动到一端，再将边界后面的内存空间清理。</li>
<li>分代收集算法：将内存分为两个区域：新年代和老年代。比例为1:2.新年代又分为Eden、From、To三个区域，比例为：8:1:1.每次进行回收时，将Eden和From存活对象复制到To中，然后将Eden和From清理。老年代因为对象存活时间久，执行的是标记整理算法。<ul>
<li>当标记对象达到15次时，就会移动到老年代。</li>
<li>当To的空间不足时，会将对象移动到老年代。</li>
<li>当老年代也满了或者空间不够了，会触发新年代和老年代的GC，两者分别为：MinorGC和FullGC。</li>
</ul>
</li>
</ul>
<h3 id="标记算法"><a href="#标记算法" class="headerlink" title="标记算法"></a>标记算法</h3><ul>
<li>引用计数法：有地方引用这个对象，计数器久加一，引用失效久减一。但是不能解决相互引用的问题。</li>
<li>可达性分析算法：以根作为起始点，沿着节点向下搜索，如果一个对象没有可以搜索到的路径，认为该对象不可达，即该对象不可用，可以回收。</li>
</ul>
<h3 id="四种引用类型"><a href="#四种引用类型" class="headerlink" title="四种引用类型"></a>四种引用类型</h3><p>​    通过new关键字创建的引用就是强引用，强引用就算内存不足，gc也不会删除它。软引用可以和ReferenceQueue一块使用，只有当 JVM 认为内存不足时，才会去试图回收软引用指向的对象。弱引用通过WeakReference类实现，弱引用的生命周期比软引用短，无论当前内存空间是否足够，弱引用都会被删除。虚引用也叫幻象引用，通过PhantomReference类来实现。如果一个对象仅持有虚引用，那么它就和没有任何引用一样，在任何时候都可能被垃圾回收器回收。</p>
<h3 id="垃圾收集器的种类"><a href="#垃圾收集器的种类" class="headerlink" title="垃圾收集器的种类"></a>垃圾收集器的种类</h3><ul>
<li>Serial垃圾收集器：单线程、复制算法。进行垃圾回收的同时，必须暂停其他所有工作线程。</li>
<li>ParNew垃圾收集器：Serial收集器的多线程版本。也是需要暂停其他线程，在垃圾回收过程中。</li>
<li>Paraller Scavenge垃圾收集器：多线程复制算法、高效。</li>
<li>Serial Old垃圾收集器：单线程标记整理算法。主要回收老年代。</li>
<li>Paraller Old垃圾收集器：多线程标记整理算法。</li>
<li>CMS收集器：多线程标记清楚算法。有四个阶段：1）初始标记。2）并发标记。3）重新标记。4）并发清楚。</li>
<li>G1垃圾收集器：基于标记整理算法，不产生内存碎片。可以精确控制停顿时间，在不牺牲吞吐量的情况下实现低停顿垃圾回收。</li>
</ul>
<h3 id="JVM调优的工具"><a href="#JVM调优的工具" class="headerlink" title="JVM调优的工具"></a>JVM调优的工具</h3><ul>
<li>jconsole：对jvm中的内存、线程和类进行监控</li>
<li>jvisualvm：可以分析内存快照、线程快照、程序死锁、监控内存变化、gc等</li>
</ul>
<h3 id="类加载过程"><a href="#类加载过程" class="headerlink" title="类加载过程"></a>类加载过程</h3><p>​    类加载机制分为五个部分：加载-验证-准备-解析-初始化。</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/IMG_B2026A3771A2-1.jpeg" alt="IMG_B2026A3771A2-1"></p>
<ul>
<li><p>加载：生成该类的Class对象。</p>
</li>
<li><p>验证：主要是确保Class文件是否符合要求。</p>
</li>
<li><p>准备：为类变量分配内存空间。</p>
</li>
<li><p>解析：虚拟机将常量池中的符号引用替换为直接引用的过程。</p>
</li>
<li><p>初始化：执行类中定义的Java代码。</p>
</li>
</ul>
<h4 id="类加载器"><a href="#类加载器" class="headerlink" title="类加载器"></a>类加载器</h4><p>​    对于任意一个类，需要加载它的类加载器和这个类本身一同确立这个类在JVM中的唯一性，每一个类加载器都有一个独立的类名称空间。类加载器就是通过完全限定名将class文件加载到jvm中，再转换为class对象。</p>
<p>  类加载器有三种：启动类加载器、扩展类加载器、应用类加载器。</p>
<ul>
<li>双亲委派模型：类加载器接收到类加载任务时，会交给父类加载器完成，这样，所有的加载请求都会传递到启动类加载器，只有当父类无法完成加载请求，子加载器才会去尝试加载类。好处就是无论哪个类加载器进行加载，最后得到的都是jvm中唯一的class对象。</li>
</ul>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ul>
<li>对于两个类的情况，即一个父类和一个子类，执行顺序如下。执行父类的静态初始化块。执行子类的静态初始化块。执行父类的非静态初始化块。执行父类的构造器。执行子类的非静态初始化块。执行子类的构造器。</li>
<li>编译是javac test.java。运行是java test。</li>
<li>静态域,main(),构造代码块,构造方法。</li>
<li>Java通过垃圾回收回收不再引用的变量，垃圾回收时对象的finallize（）不一定会得到执行。</li>
<li>判断对象是否可以回收有两个算法，引用计数算法和根搜索算法。垃圾回收算法则有四种，标记清楚算法、复制算法、标记整理算法、分代收集算法Minor GC 指发生在新生代的垃圾回收操作。因为大多数对象的生命周期都很短，因此 Minor GC 会频繁执行，一般回收速度也比较快。Full GC 也称 Major GC，指发生在老年代的垃圾回收操作。出现了 Full GC，经常会伴随至少一次的 Minor GC。老年代对象的存活时间长，因此 Full GC 很少执行，而且执行速度会比 Minor GC 慢很多。优先在新生代区存放对象，大对象直接放在老年代区，新生代区的对象经历15次GC后就会进入老年代区。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/Java%E5%9F%BA%E7%A1%80/Java%E8%99%9A%E6%8B%9F%E6%9C%BA/" data-id="ckupl1rqd000n6rup0iyx4244" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/Java%E5%9F%BA%E7%A1%80/Java%E7%BA%BF%E7%A8%8B%E6%B7%B1%E5%85%A5%E5%AD%A6%E4%B9%A0/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/Java%E5%9F%BA%E7%A1%80/Java%E8%BE%93%E5%85%A5%E4%B8%8E%E8%BE%93%E5%87%BA/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/test/" rel="tag">test</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/test/" style="font-size: 10px;">test</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%95%B0%E6%8D%AE%E4%BD%8D%E5%AD%A6%E4%B9%A0/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%9D%82%E9%A1%B9/%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E8%AE%B0%E5%BD%95/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%9D%82%E9%A1%B9/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>