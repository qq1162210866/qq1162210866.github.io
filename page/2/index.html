<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-qq1162210866.github.io/博客/框架/Spring相关框架/SpringBoot整合MQTT" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%A1%86%E6%9E%B6/Spring%E7%9B%B8%E5%85%B3%E6%A1%86%E6%9E%B6/SpringBoot%E6%95%B4%E5%90%88MQTT/" class="article-date">
  <time datetime="2021-10-13T13:28:21.198Z" itemprop="datePublished">2021-10-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="SpringBoot整合MQTT"><a href="#SpringBoot整合MQTT" class="headerlink" title="SpringBoot整合MQTT"></a>SpringBoot整合MQTT</h2><p>​    公司的项目重新进行了优化，换成了SpringBoot的架构。之前写的一个SSM整合MQTT的demo不能使用了，其实之前的代码写的也是有点烂，所以就来了解一下SpringBoot整合MQTT，顺便写一个比较好的代码。下面直接开始。</p>
<p>​    关于MQTT协议的一些介绍之前已经讲过了，之前对于协议的记录博客还是可以的。博客地址：<code>https://blog.csdn.net/qq_38533859/article/details/81872622</code>。所以这里不再介绍，直接开整。</p>
<p>​    需要添加pom依赖，这个是官方整合的依赖，官方也有例子（虽然不怎么样）。依赖如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--  MQTT依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.integration<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-integration-mqtt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.1.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    剩下就是配置入站适配器和出站适配器了。这个是借鉴了一下官方的文档，文档地址在这里：<code>https://docs.spring.io/spring-integration/reference/html/mqtt.html#mqtt</code></p>
<p>​    因为之前是使用xml文件对mqtt适配器进行配置，所以这个新项目非常不想这样做，最后采用JavaConfig的形式配置。官方的例子写的很清楚了。我的入站适配器和出站适配器写在一起了。MQTT的配置文件如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psq.train.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.eclipse.paho.client.mqttv3.MqttConnectOptions;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.integration.annotation.MessagingGateway;</span><br><span class="line"><span class="keyword">import</span> org.springframework.integration.annotation.ServiceActivator;</span><br><span class="line"><span class="keyword">import</span> org.springframework.integration.channel.DirectChannel;</span><br><span class="line"><span class="keyword">import</span> org.springframework.integration.core.MessageProducer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.integration.mqtt.core.DefaultMqttPahoClientFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.integration.mqtt.core.MqttPahoClientFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.integration.mqtt.inbound.MqttPahoMessageDrivenChannelAdapter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.integration.mqtt.outbound.MqttPahoMessageHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.integration.mqtt.support.DefaultPahoMessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.integration.mqtt.support.MqttHeaders;</span><br><span class="line"><span class="keyword">import</span> org.springframework.messaging.Message;</span><br><span class="line"><span class="keyword">import</span> org.springframework.messaging.MessageChannel;</span><br><span class="line"><span class="keyword">import</span> org.springframework.messaging.MessageHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.messaging.MessagingException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.messaging.handler.annotation.Header;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * MQTTConfig.java</span></span><br><span class="line"><span class="comment"> * Description:  MQTT的配置类，主要配置出入站适配器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Peng Shiquan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/7/13</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MQTTConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * =====================================入站适配器1=====================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MessageChannel <span class="title">mqttInputChannel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DirectChannel();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MessageProducer <span class="title">inbound</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        MqttPahoMessageDrivenChannelAdapter adapter =</span><br><span class="line">                <span class="keyword">new</span> MqttPahoMessageDrivenChannelAdapter(<span class="string">&quot;tcp://127.0.0.1:1883&quot;</span>, <span class="string">&quot;testClient1&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;testTopic2&quot;</span>);</span><br><span class="line">        adapter.setCompletionTimeout(<span class="number">5000</span>);</span><br><span class="line">        adapter.setConverter(<span class="keyword">new</span> DefaultPahoMessageConverter());</span><br><span class="line">        adapter.setQos(<span class="number">1</span>);</span><br><span class="line">        adapter.setOutputChannel(mqttInputChannel());</span><br><span class="line">        <span class="keyword">return</span> adapter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ServiceActivator(inputChannel = &quot;mqttInputChannel&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MessageHandler <span class="title">handler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MessageHandler() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message&lt;?&gt; message)</span> <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">                System.out.println(message.getPayload() + <span class="string">&quot;=====&quot;</span> + message.getHeaders().get(<span class="string">&quot;mqtt_receivedTopic&quot;</span>));</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * =====================================入站适配器2=====================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MessageChannel <span class="title">mqttInputChannelTwo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DirectChannel();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MessageProducer <span class="title">inboundTwo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        MqttPahoMessageDrivenChannelAdapter adapter =</span><br><span class="line">                <span class="keyword">new</span> MqttPahoMessageDrivenChannelAdapter(<span class="string">&quot;tcp://127.0.0.1:1883&quot;</span>, <span class="string">&quot;testClient3&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;testTopic2&quot;</span>);</span><br><span class="line">        adapter.setCompletionTimeout(<span class="number">5000</span>);</span><br><span class="line">        adapter.setConverter(<span class="keyword">new</span> DefaultPahoMessageConverter());</span><br><span class="line">        adapter.setQos(<span class="number">1</span>);</span><br><span class="line">        adapter.setOutputChannel(mqttInputChannelTwo());</span><br><span class="line">        <span class="keyword">return</span> adapter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ServiceActivator(inputChannel = &quot;mqttInputChannelTwo&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MessageHandler <span class="title">handlerTwo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MessageHandler() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message&lt;?&gt; message)</span> <span class="keyword">throws</span> MessagingException </span>&#123;</span><br><span class="line">                System.out.println(message.getPayload() + <span class="string">&quot;=====&quot;</span> + message.getHeaders().get(<span class="string">&quot;mqtt_receivedTopic&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * =====================================出站适配器=====================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MqttPahoClientFactory <span class="title">mqttClientFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        DefaultMqttPahoClientFactory factory = <span class="keyword">new</span> DefaultMqttPahoClientFactory();</span><br><span class="line">        MqttConnectOptions options = <span class="keyword">new</span> MqttConnectOptions();</span><br><span class="line">        options.setServerURIs(<span class="keyword">new</span> String[]&#123;<span class="string">&quot;tcp://127.0.0.1:1883&quot;</span>&#125;);</span><br><span class="line">        options.setUserName(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        options.setPassword(<span class="string">&quot;password&quot;</span>.toCharArray());</span><br><span class="line">        factory.setConnectionOptions(options);</span><br><span class="line">        <span class="keyword">return</span> factory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ServiceActivator(inputChannel = &quot;mqttOutboundChannel&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MessageHandler <span class="title">mqttOutbound</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        MqttPahoMessageHandler messageHandler =</span><br><span class="line">                <span class="keyword">new</span> MqttPahoMessageHandler(<span class="string">&quot;testClient2&quot;</span>, mqttClientFactory());</span><br><span class="line">        messageHandler.setAsync(<span class="keyword">true</span>);</span><br><span class="line">        messageHandler.setDefaultTopic(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> messageHandler;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MessageChannel <span class="title">mqttOutboundChannel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DirectChannel();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * =====================================发送的接口=====================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Component</span></span><br><span class="line">    <span class="meta">@MessagingGateway(defaultRequestChannel = &quot;mqttOutboundChannel&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MyGateway</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">sendToMqtt</span><span class="params">(<span class="meta">@Header(MqttHeaders.TOPIC)</span> String topic, String data)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    上面就是代码，解释都在官方文档里面了，大家搞个翻译，翻译一下官方文档就大致明白了。这里说一些注意的点。</p>
<ul>
<li><p>代码中配置了两个入站适配器，一个出站适配器，这三个适配器的ClientID最好不要一样，要不然会一直出现断连重连现象。</p>
</li>
<li><p>发送的接口最好分离出去一个单独的类，我写在一起，但是实际使用的时候一直出问题，因为时间问题也没有去找原因。</p>
</li>
<li><p>代码的这种写法不是MQTT的单独的写法，我了解到这个好像是Spring的一种模式吧，没有来得及了解，后续肯定会去了解一下。</p>
</li>
<li><p>SpringBoot的这种整合有一些BUG，好像是MQTT官方解决了，但是SpringBoot官方还存在这个问题。具体没有遇到这个问题，所以不清楚现象，留个坑。</p>
</li>
<li><p>官方还可以写一个监听函数，用来监听连接成功和断连的时候，这里没有上代码，没有啥可以讲的。在官方文档的最后面有提到。</p>
</li>
</ul>
<p>​    下面就是上调用的代码，这里直接使用controller调用了，没有啥复杂的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/mqtt&quot;, method = RequestMethod.GET)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">sendMQTTMsg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    myGateway.sendToMqtt(<span class="string">&quot;testTopic1&quot;</span>, <span class="string">&quot;hello1&quot;</span>);</span><br><span class="line">    myGateway.sendToMqtt(<span class="string">&quot;testTopic2&quot;</span>, <span class="string">&quot;hello2&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    剩下就没有啥可以讲的了，时间赶的急，后面遇到再说吧，再次留个坑。</p>
<p>​    就这样吧，结束。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%A1%86%E6%9E%B6/Spring%E7%9B%B8%E5%85%B3%E6%A1%86%E6%9E%B6/SpringBoot%E6%95%B4%E5%90%88MQTT/" data-id="ckupl1rsm002a6rup4udj27lt" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-qq1162210866.github.io/博客/框架/Spring相关框架/SpringBoot相关知识点" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%A1%86%E6%9E%B6/Spring%E7%9B%B8%E5%85%B3%E6%A1%86%E6%9E%B6/SpringBoot%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9/" class="article-date">
  <time datetime="2021-10-13T13:28:21.198Z" itemprop="datePublished">2021-10-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="SpringBoot知识点"><a href="#SpringBoot知识点" class="headerlink" title="SpringBoot知识点"></a>SpringBoot知识点</h2><p>​    Spring Boot 是 Spring 开源组织下的子项目，是 Spring 组件一站式解决方案，主要是简化了使用 Spring 的难度，简省了繁重的配置，提供了各种启动器，开发者能快速上手。</p>
<h3 id="SpringBoot的启动流程"><a href="#SpringBoot的启动流程" class="headerlink" title="SpringBoot的启动流程"></a>SpringBoot的启动流程</h3><p>​    流程图如下：</p>
<p>​    <img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210623161300236.png" alt="image-20210623161300236"></p>
<p>​    流程暂时还不是很清楚，可以后续完善</p>
<h3 id="SpringBoot中的自动配置原理"><a href="#SpringBoot中的自动配置原理" class="headerlink" title="SpringBoot中的自动配置原理"></a>SpringBoot中的自动配置原理</h3><p>​    项目中只要配置了redis的信息，在代码中直接注入redis模版bean，就可以直接使用了，这个就是自动配置。将配置文件中的信息配置到bean上，自动配置分为bean的自动配置和属性的自动配置。</p>
<p>​    其中<code>@EnableAutoConfiguration</code>是关键(启用自动配置)，内部实际上就去加载<code>META-INF/spring.factories</code>文件的信息，然后筛选出以<code>EnableAutoConfiguration</code>为key的数据，加载到IOC容器中，实现自动配置功能！</p>
<h3 id="Spring-JavaConfig"><a href="#Spring-JavaConfig" class="headerlink" title="Spring JavaConfig"></a>Spring JavaConfig</h3><p>​    因为xml配置bean的方式比较复杂，并且不符合面向对象的逻辑。所以就有了Spring JavaConfig，它允许开发者将bean定义和在Spring配置XML文件到Java类中。这两者是可以混用的。</p>
<h3 id="SpringBoot中配置文件加载顺序"><a href="#SpringBoot中配置文件加载顺序" class="headerlink" title="SpringBoot中配置文件加载顺序"></a>SpringBoot中配置文件加载顺序</h3><p>​    spring boot 启动会扫描以下位置的application.properties或者application.yml文件作为Spring boot的默认配置文件。properties优先级会高一些，相同名称的配置，会将 yml内的配置覆盖掉。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">–file:./config/</span><br><span class="line">–file:./</span><br><span class="line">–classpath:/config/</span><br><span class="line">–classpath:/</span><br></pre></td></tr></table></figure>

<p>​    顺序如下，由一到四：</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210623170034583.png" alt="image-20210623170034583"></p>
<p>注意：bootstrap 是应用程序的父上下文，也就是说 bootstrap 加载优先于 applicaton。bootstarp是spring cloud中使用的配置文件。</p>
<h3 id="YAML文件"><a href="#YAML文件" class="headerlink" title="YAML文件"></a>YAML文件</h3><p>​    YAML 的语法和其他高级语言类似，并且可以简单表达清单、散列表，标量等数据形态。它使用空白符号缩进和大量依赖外观的特色，特别适合用来表达或编辑数据结构、各种配置文件、倾印调试内容、文件大纲（例如：许多电子邮件标题格式和YAML非常接近）。</p>
<p>​    YAML 的配置文件后缀为 <strong>.yml</strong>，如：<strong>runoob.yml</strong> 。</p>
<h3 id="SpringBoot中的监听器"><a href="#SpringBoot中的监听器" class="headerlink" title="SpringBoot中的监听器"></a>SpringBoot中的监听器</h3><p>​    监听器模式是由观察者模式发展而来，有一下几个重要部分。</p>
<ul>
<li>事件：步骤1和步骤2，通过对天气进行抽象，并实现下雨和下雪的天气状态</li>
<li>监听器：步骤3和步骤4，规范对天气监听的模式，并且规范对应天气下，需要如何处理</li>
<li>广播器：步骤5、步骤6和步骤7，当有事件发生的时候，广播器发出信号，告知所有的监听器，监听器根据事件作出相应的处理。触发下雨事件的时候，下雨监听器收到消息，它抬头一看乌云密布电闪雷鸣，微微一愣，大喊一句：“打雷下雨收衣服啊！！”，广播器继续通知下一个监听器下雪监听器，下雪监听器看看天空，摆摆手，说：“这事与我无关去找别人”</li>
<li>触发机制：步骤8，demo中采用的硬编码的形式触发的，在实际运用中，可能是湿度仪检测到湿度暴涨开始下雨了，触发广播。</li>
</ul>
<p>​    具体的流程就是：监听器中编写对某些事件发生的处理情况，然后监听器注册到广播器中，当有时间触发时，广播器告知所有的监听器，监听器在做相应的处理。</p>
<p>​    ApplicationListener是Spring事件机制的一部分，与抽象类ApplicationEvent类配合来完成ApplicationContext的事件机制，实现ApplicationListener接口的类，会在SpringBoot加入到广播器中，当ApplicationContext触发了一个事件，就用广播器通知所有实现ApplicationListener接口的类。</p>
<p>​    SpringBoot中九大事件：</p>
<ul>
<li>EventObject：事件顶级对象，所有事件对象的根对象</li>
<li>ApplicationEvent：应用事件</li>
<li>SpringApplicationEvent：Spring自己的事件，Spring框架自身的事件都会实现这个接口</li>
<li>ApplicationStartingEvent：启动事件，框架刚刚启动就会发出这个事件</li>
<li>ApplicationEnvironmentPreparedEvent：环境在变完成，系统属性和用户指定已经加载完成</li>
<li>ApplicationContextInitializedEvent：已经创建好了上下文，并且还没有加载任何bean之前发出这个事件</li>
<li>ApplicationPreparedEvent：在Bean定义开始加载之后，尚未完全加载之前，刷新上下文之前触发</li>
<li>ApplicationStartedEvent：bean已经创建完成，上下文已经刷新完成，但是ApplicationRunner和CommandLineRunne两个扩展接口并未执行</li>
<li>ApplicationReadyEvent：ApplicationRunner和CommandLineRunne两个扩展接口执行完成之后触发</li>
<li>ApplicationFailedEvent：在启动发生异常时触发</li>
</ul>
<p>​    启动 —》ApplicationStartingEvent —》ApplicationEnvironmentPreparedEvent —》ApplicationContextInitializedEvent —》 ApplicationPreparedEvent —》ApplicationStartedEvent —》 ApplicationReadyEvent —》启动完毕</p>
<h3 id="Spring-Boot-中的-starter"><a href="#Spring-Boot-中的-starter" class="headerlink" title="Spring Boot 中的 starter"></a>Spring Boot 中的 starter</h3><p>​    在spring中引入一个中间件或者JPA，需要先在pom文件中导入需要的依赖，再添加相应的配置。然后再调试完毕，直到项目正常启动。多个项目也是这样的配置，只不过多个项目可能配置直接复制即可，本质还是复杂的。</p>
<p>​    starter的主要目的就是为了解决上面的这些问题。</p>
<p>　　starter的理念：starter会把所有用到的依赖都给包含进来，避免了开发者自己去引入依赖所带来的麻烦。需要注意的是不同的starter是为了解决不同的依赖，所以它们内部的实现可能会有很大的差异，例如jpa的starter和Redis的starter可能实现就不一样，这是因为starter的本质在于synthesize，这是一层在逻辑层面的抽象，也许这种理念有点类似于Docker，因为它们都是在做一个“包装”的操作，如果你知道Docker是为了解决什么问题的，也许你可以用Docker和starter做一个类比。</p>
<p>　　starter的实现：虽然不同的starter实现起来各有差异，但是他们基本上都会使用到两个相同的内容：ConfigurationProperties和AutoConfiguration。因为Spring Boot坚信“约定大于配置”这一理念，所以我们使用ConfigurationProperties来保存我们的配置，并且这些配置都可以有一个默认值，即在我们没有主动覆写原始配置的情况下，默认值就会生效，这在很多情况下是非常有用的。除此之外，starter的ConfigurationProperties还使得所有的配置属性被聚集到一个文件中（一般在resources目录下的application.properties），这样我们就告别了Spring项目中XML地狱。</p>
<p>​    对于starter中的配置，用户仍然可以再application配置文件中进行覆盖掉，达到自己的定制化。没有覆盖的就使用starter中的默认值。</p>
<h3 id="Spring-Security-和-Shiro"><a href="#Spring-Security-和-Shiro" class="headerlink" title="Spring Security 和 Shiro"></a>Spring Security 和 Shiro</h3><p>​    Spring Security是一个能够为基于Spring的企业应用系统提供声明式的安全访问控制解决方案的安全框架。它提供了一组可以在Spring应用上下文中配置的Bean，充分利用了Spring IoC，DI（控制反转Inversion of Control ,DI:Dependency Injection 依赖注入）和AOP（面向切面编程）功能，为应用系统提供声明式的安全访问控制功能，减少了为企业系统安全控制编写大量重复代码的工作。</p>
<p>​    Apache Shiro 是一个开源安全框架，提供身份验证、授权、密码学和会话管理。Shiro 框架具有直观、易用等特性，同时也能提供健壮的安全性，虽然它的功能不如 Spring Security 那么强大，但是在常规的企业级应用中，其实也够用了。</p>
<p>​    两者都是权限框架，用来做安全验证的，考点估计也比较少。后续遇到再注意。</p>
<h3 id="WebSockets"><a href="#WebSockets" class="headerlink" title="WebSockets"></a>WebSockets</h3><p>​    WebSocket是一种网络传输协议，可在单个TCP连接上进行全双工通信，位于OSI模型的应用层。WebSocket使得客户端和服务器之间的数据交换变得更加简单，允许服务端主动向客户端推送数据。在WebSocket API中，浏览器和服务器只需要完成一次握手，两者之间就可以创建持久性的连接，并进行双向数据传输。</p>
<p>​    后续如果有人问的话，可以看看这篇文章：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/chyingp/p/websocket-deep-in.html">https://www.cnblogs.com/chyingp/p/websocket-deep-in.html</a></p>
<h3 id="日志框架"><a href="#日志框架" class="headerlink" title="日志框架"></a>日志框架</h3><p>​    在Java开发中，常用的日志记录框架有JDKLog、Log4J、LogBack、SLF4J、SLF4J。这些日志记录框架各有各的特点，各有各的应用场景。</p>
<p>​    日志框架使用的是门面模式，分为门面和实现。JCL、SLF4J是日志门面。JUL、LOG4J1、LOG4J2、LOGBACK是日志实现框架。</p>
<p>​    common-logging 与 slf4j 都是日志实现门面，它们本身都不具体实现写日记操作，只是提供统一的接口。</p>
<p>​    common-logging 是最早的日志门面实现，而 SLF4J 是较新的日志门面实现。因此 SLF4J 在性能以及兼容性处理会比 common-logging要好。</p>
<ul>
<li>JDKLog：jdk自带的日志，直接就可以使用。但 JDKLog 功能比较太过于简单，不支持占位符显示，拓展性比较差，所以现在用的人也很少。</li>
<li>Log4J： 是 Apache 的一个日志开源框架，有多个分级（DEBUG/INFO/WARN/ERROR）记录级别，可以很好地将不同日志级别的日志分开记录，极大地方便了日志的查看。</li>
<li>LogBack ：其实可以说是 Log4J 的进化版，因为它们两个都是同一个人（Ceki Gülcü）设计的开源日志组件。LogBack 除了具备 Log4j 的所有优点之外，还解决了 Log4J 不能使用占位符的问题。</li>
</ul>
<h3 id="spring-factories"><a href="#spring-factories" class="headerlink" title="spring.factories"></a>spring.factories</h3><h4 id="SPI机制"><a href="#SPI机制" class="headerlink" title="SPI机制"></a>SPI机制</h4><p>​    SPI的全名为Service Provider Interface.我们系统里抽象的各个模块，往往有很多不同的实现方案，比如日志模块的方案，xml解析模块、jdbc模块的方案等。面向的对象的设计里，我们一般推荐模块之间基于接口编程，模块之间不对实现类进行硬编码。一旦代码里涉及具体的实现类，就违反了可拔插的原则，如果需要替换一种实现，就需要修改代码。为了实现在模块装配的时候能不在程序里动态指明，这就需要一种服务发现机制。<br>​    java SPI就是提供这样的一个机制：为某个接口寻找服务实现的机制。有点类似IOC的思想，就是将装配的控制权移到程序之外，在模块化设计中这个机制尤其重要。</p>
<p>​    在Spring中也有一种类似与Java SPI的加载机制。它在META-INF/spring.factories文件中配置接口的实现类名称，然后在程序中读取这些配置文件并实例化。 这种自定义的SPI机制是Spring Boot Starter实现的基础。 </p>
<h3 id="SpringBoot中常用的注解"><a href="#SpringBoot中常用的注解" class="headerlink" title="SpringBoot中常用的注解"></a>SpringBoot中常用的注解</h3><ul>
<li>@ComponentScan主要就是定义扫描的路径从中找出标识了需要装配的类自动装配到spring的bean容器中。常和@Component搭配使用。</li>
<li>@Component：表示带注释的类是“组件”。 在使用基于注释的配置和类路径扫描时，此类类被视为自动检测的候选对象。</li>
<li>@Autowired:默认按类型匹配注入Bean.如果找到两个，就会报异常，因为没法判断到底使用哪个</li>
<li>@Resource:默认按名称匹配注入Bean，先是按照名称查询bean，如果没有找到按照类型，多个也会报错。</li>
<li>@Qualifier:指定注入bean的名称，需要搭配@Autowired一起使用。</li>
</ul>
<h3 id="SpringBoot面试问题"><a href="#SpringBoot面试问题" class="headerlink" title="SpringBoot面试问题"></a>SpringBoot面试问题</h3><ul>
<li>SpringBoot启动流程</li>
</ul>
<p>​    第一部分进行SpringApplication的初始化模块，配置一些基本的环境变量、资源、构造器、监听器，第二部分实现了应用具体的启动方案，包括启动流程的监听模块、加载配置环境模块、及核心的创建上下文环境模块，第三部分是自动化配置模块。背不住</p>
<p>​    </p>
<h3 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h3><p>//springboot自动配置原理</p>
<p>//javaconfig</p>
<p>//@ComponentScan扫描</p>
<p>//springboot配置加载顺序</p>
<p>//springboot监听器</p>
<p>//Spring Boot 中的 starter </p>
<p>//yaml文件</p>
<p>//Spring Security 和 Shiro的区别和作用</p>
<p>//websockets</p>
<p>//日志框架</p>
<p>//spring.factories</p>
<p>需要练习的有：</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%A1%86%E6%9E%B6/Spring%E7%9B%B8%E5%85%B3%E6%A1%86%E6%9E%B6/SpringBoot%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9/" data-id="ckupl1rsn002b6rupfu7dgw0e" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-qq1162210866.github.io/博客/框架/Spring相关框架/SpringBoot连接Mysql" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%A1%86%E6%9E%B6/Spring%E7%9B%B8%E5%85%B3%E6%A1%86%E6%9E%B6/SpringBoot%E8%BF%9E%E6%8E%A5Mysql/" class="article-date">
  <time datetime="2021-10-13T13:28:21.198Z" itemprop="datePublished">2021-10-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="SpringBoot连接Mysql"><a href="#SpringBoot连接Mysql" class="headerlink" title="SpringBoot连接Mysql"></a>SpringBoot连接Mysql</h2><p>​    第一个SpringBoot的练习就是连接数据库，使用的是就是基础的组件，没有使用web和mybatis。也是作为一个基础的demo。开始。</p>
<p>​    因为之前的java项目是通过导入jar包来实现，非常的繁琐并且jar包不容易管理。后来产生了maven，通过maven来管理jar包。本次项目也是通过pom文件来管理依赖，同时，因为SpringBoot设置了默认的依赖版本，这里也不再叙述导入依赖的版本。</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20200530152138145.png" alt="image-20200530152138145"></p>
<p>​    导入的依赖如下：下面的代码就是全部的依赖，有些最开始创建项目的时候已经导入了，这里仍然放在下面了。记得添加依赖后要更新一下，要不然很多东西IDE无法做配置。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- SpringBoot基础依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- JDBC依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- MySQL依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 测试依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    maven更新的图片如下，这样更新后就可以使用依赖中的类。</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20200531130454654.png" alt="image-20200531130454654">    </p>
<p>​    导入依赖后，需要在SpringBoot配置文件中进行数据库的基础配置。这里配置文件是application.properties。不是现在常见的yml格式，这里是spring默认的格式。其他格式的数据库配置需要查询一下，后面也会换成其他格式，这种格式不好区分各个中间件配置，但是现在暂时使用这个格式。配置如下：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://127.0.0.1:3306/test</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">12345678</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br></pre></td></tr></table></figure>

<p>​    创建测试类就可以了，下面就可以写代码了。代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psq.train.mysql;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.RowMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.PostConstruct;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ConnectMySQLTrain.java</span></span><br><span class="line"><span class="comment"> * Description: 使用基础的组件连接MySQL</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Peng Shiquan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/30345</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConnectMySQLTrain</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Description: 测试MySQL数据读取</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span>: Peng Shiquan</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span>: 2020/5/31</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMySQL</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String sql = <span class="string">&quot;SELECT id,name,password FROM `user`&quot;</span>;</span><br><span class="line">        List&lt;TestUser&gt; testUserList = jdbcTemplate.query(sql, <span class="keyword">new</span> RowMapper&lt;TestUser&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> TestUser <span class="title">mapRow</span><span class="params">(ResultSet resultSet, <span class="keyword">int</span> i)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">                TestUser testUser = <span class="keyword">new</span> TestUser();</span><br><span class="line">                testUser.setId(resultSet.getInt(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">                testUser.setName(resultSet.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">                testUser.setPassword(resultSet.getString(<span class="string">&quot;password&quot;</span>));</span><br><span class="line">                <span class="keyword">return</span> testUser;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        System.err.println(<span class="string">&quot;查询成功，查询结果如下：&quot;</span> + testUserList.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    需要注意的是：这里没有使用SPringBoot的web模块，只是简单的一个demo，所以就单独写了一个类，在项目启动的时候运行一下就可以了<code>@Component</code>注解是为了把普通pojo实例化到spring容器中，相当于配置文件中的<code>&lt;bean id=&quot;&quot; class=&quot;&quot;/&gt;</code>，<code>@PostConstruct</code>注解的意思是：被@PostConstruct修饰的方法会在服务器加载Servlet的时候运行，并且只会被服务器执行一次。实体类的代码因为没有什么可以讲的，这里就不再占面积了。</p>
<p>​    运行项目这里也没有什么可以讲的地方。就是SpringBoot内置了Tomcat，但是因为我这个项目没有web模块，所以没有内嵌tomcat，关于这些可以放到后面来说。本次就是打成了jar包，通过jvm运行。结果如下：</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20200531132745688.png" alt="image-20200531132745688"></p>
<p>​    上面说的可能有些地方不对，大家可以指导一下。就这样吧，结束。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%A1%86%E6%9E%B6/Spring%E7%9B%B8%E5%85%B3%E6%A1%86%E6%9E%B6/SpringBoot%E8%BF%9E%E6%8E%A5Mysql/" data-id="ckupl1rsn002c6rup9k3590m8" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-qq1162210866.github.io/博客/框架/Spring相关框架/SpringBoot连接Redis" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%A1%86%E6%9E%B6/Spring%E7%9B%B8%E5%85%B3%E6%A1%86%E6%9E%B6/SpringBoot%E8%BF%9E%E6%8E%A5Redis/" class="article-date">
  <time datetime="2021-10-13T13:28:21.198Z" itemprop="datePublished">2021-10-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="SpringBoot连接Redis"><a href="#SpringBoot连接Redis" class="headerlink" title="SpringBoot连接Redis"></a>SpringBoot连接Redis</h2><p>​    下面就开始练习连接Redis，这里也是没有集成web模块。web模块感觉这些东西也没有必要。连接池这里可以讲一下，上一篇MySQL的连接池放在Mybatis那里再讲，估计也快了，如果不出意外的话。。。</p>
<p>​    首先安装Redis和配置Redis的信息，这里不再累述，我之前的博客也有。刚才看了一下，我之前的博客讲的还挺详细的，我这次有可能重复了，尽量讲讲之前没有讲到的。</p>
<p>​    仍然是添加依赖，因为Redis官方开发了一个连接工具Jedis，这个工具挺好用的。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--  Redis依赖      --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--  不添加这个依赖会导致RedisTemplate无法注入      --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-pool2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    下面就是配置Redis连接和连接池信息。</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Redis依赖</span></span><br><span class="line"><span class="comment"># Redis服务器地址</span></span><br><span class="line"><span class="meta">spring.redis.host</span>=<span class="string">127.0.0.1</span></span><br><span class="line"><span class="comment"># Redis数据库索引（默认为0）</span></span><br><span class="line"><span class="meta">spring.redis.database</span>=<span class="string">0</span></span><br><span class="line"><span class="comment"># Redis服务器连接端口</span></span><br><span class="line"><span class="meta">spring.redis.port</span>=<span class="string">6379</span></span><br><span class="line"><span class="comment"># Redis服务器连接密码（默认为空）</span></span><br><span class="line"><span class="meta">spring.redis.password</span>=<span class="string">自己的密码</span></span><br><span class="line"><span class="comment"># 连接超时时间（毫秒）</span></span><br><span class="line"><span class="meta">spring.redis.timeout</span>=<span class="string">1000</span></span><br><span class="line"><span class="comment">## 连接池最大连接数（使用负值表示没有限制）</span></span><br><span class="line"><span class="meta">spring.redis.lettuce.pool.max-active</span>=<span class="string">200</span></span><br><span class="line"><span class="comment">## 连接池最大阻塞等待时间（使用负值表示没有限制）</span></span><br><span class="line"><span class="meta">spring.redis.lettuce.pool.max-wait</span>=<span class="string">-1</span></span><br><span class="line"><span class="comment">## 连接池中的最大空闲连接</span></span><br><span class="line"><span class="meta">spring.redis.lettuce.pool.max-idle</span>=<span class="string">10</span></span><br><span class="line"><span class="comment">## 连接池中的最小空闲连接</span></span><br><span class="line"><span class="meta">spring.redis.lettuce.pool.min-idle</span>=<span class="string">0</span></span><br></pre></td></tr></table></figure>

<p>​    下面就开始编写代码，需要注意的是代码中引用的类是StringRedisTemplate，有一些不同的地方。</p>
<ul>
<li><p>RedisTemplate，RedisTemplate是最基本的操作类，它默认的序列化方式是JdkSerializationRedisSerializer，在存值时，键值会被序列化为字节数组，可读性差，取值时也是一样，如果redis中存的值正常的字符串形式，取值时将返回null。</p>
</li>
<li><p>StringRedisTemplateStringRedisTemplate继承于 RedisTemplate&lt;String, String&gt;，默认的序列化方式是StringRedisSerializer，存值取值都是按照字符串的形式。</p>
<p>代码如下，但是中间遇到了一些问题，解决起来很蛋疼。下面说说，最开始使用的是上面的依赖，但是启动一直报错，一开始怀疑注入的方式不对，把<code>@Resource</code>换成<code>@Autowired</code>，结果还是不行，又怀疑方法不能正常调用（菜鸟的智障怀疑），后来又排除了。在网上找了一圈，怀疑redis版本的问题，换成了jedis，结果就可以了。然后就认为是依赖的版本问题，生菜（最新redis使用的）和目前的SpringBoot融合的不是很好。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psq.train.redis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.psq.train.mysql.TestUser;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.StringRedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.PostConstruct;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * RedisTrain.java</span></span><br><span class="line"><span class="comment"> * Description: Redis练习</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Peng Shiquan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/31</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisTrain</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 使用StringRedisTemplate，类似于RedisTemplate&lt;String,String&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> StringRedisTemplate stringRedisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Description: Redis练习的主方法</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span>: Peng Shiquan</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span>: 2020/5/31</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">redisTrainmain</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        TestUser testUser = <span class="keyword">new</span> TestUser();</span><br><span class="line">        testUser.setId(<span class="number">3</span>);</span><br><span class="line">        testUser.setName(<span class="string">&quot;张三&quot;</span>);</span><br><span class="line">        testUser.setPassword(<span class="string">&quot;1234567&quot;</span>);</span><br><span class="line">        System.err.println(<span class="string">&quot;下面开始Redis插入&quot;</span>);</span><br><span class="line">        redisTrainInsert(testUser);</span><br><span class="line">        System.err.println(<span class="string">&quot;下面开始查询&quot;</span>);</span><br><span class="line">        redisTrainSelect(testUser.getName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Description: redis插入方法</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> testUser</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span>: Peng Shiquan</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span>: 2020/6/1</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">redisTrainInsert</span><span class="params">(TestUser testUser)</span> </span>&#123;</span><br><span class="line">        String key = testUser.getName();</span><br><span class="line">        String value = testUser.toString();</span><br><span class="line">        stringRedisTemplate.opsForValue().set(key, value);</span><br><span class="line">        System.err.println(<span class="string">&quot;存储成功，存储对象为:key:&quot;</span> + key + <span class="string">&quot;,value:&quot;</span> + value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Description: redis查询方法</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span>: Peng Shiquan</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span>: 2020/6/1</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">redisTrainSelect</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        System.err.println(<span class="string">&quot;需要查询的name为:&quot;</span> + name);</span><br><span class="line">        System.err.println(name);</span><br><span class="line">        String value = stringRedisTemplate.opsForValue().get(name);</span><br><span class="line">        System.err.println(<span class="string">&quot;查询到到结果为:&quot;</span> + value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p><code>Lettuce</code>和<code>Jedis</code>的都是连接<code>Redis Server</code>的客户端程序。<code>Jedis</code>在<strong>实现上是直连<code>redis server</code>，多线程环境下非线程安全，除非使用连接池，为每个Jedis实例增加物理连接</strong>。<code>Lettuce</code>基于Netty的连接实例（StatefulRedisConnection），<strong>可以在多个线程间并发访问，且线程安全，满足多线程环境下的并发访问，同时它是可伸缩的设计，一个连接实例不够的情况也可以按需增加连接实例</strong>。</p>
<p>我也这样认为，直到我再次启动的时候，发现下面一个问题。  <img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20200601090901717.png" alt="image-20200601090901717"></p>
<p>如上图，最后显示的是一个密码的问题，是客户端配置了密码，但是服务端没有配置密码，我又查看了redis启动的时候，没有使用正确的配置文件。</p>
</li>
</ul>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20200601092939704.png" alt="image-20200601092939704"></p>
<p>​    配置了密码后，一切都解决了。真是一个SB问题，果然是老了。。。</p>
<p>​    剩下就遗留了一个问题，我看别人的demo都写了一个redis配置类，估计是为了定制自己的<code>RedisTemplate</code>，我这里没有什么定制的，就是简单的用了一下，所以没有写redis配置类。如果我说错了，大家也指点一下。</p>
<p>​    就这样吧，结束。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%A1%86%E6%9E%B6/Spring%E7%9B%B8%E5%85%B3%E6%A1%86%E6%9E%B6/SpringBoot%E8%BF%9E%E6%8E%A5Redis/" data-id="ckupl1rso002d6rup9bdqcfc9" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-qq1162210866.github.io/博客/框架/Spring相关框架/SpringBoot集合Mybatis连接PostgreSQL" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%A1%86%E6%9E%B6/Spring%E7%9B%B8%E5%85%B3%E6%A1%86%E6%9E%B6/SpringBoot%E9%9B%86%E5%90%88Mybatis%E8%BF%9E%E6%8E%A5PostgreSQL/" class="article-date">
  <time datetime="2021-10-13T13:28:21.198Z" itemprop="datePublished">2021-10-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="SpringBoot集合MyBatis连接PostgreSQL"><a href="#SpringBoot集合MyBatis连接PostgreSQL" class="headerlink" title="SpringBoot集合MyBatis连接PostgreSQL"></a>SpringBoot集合MyBatis连接PostgreSQL</h2><p>​    正好最近需要使用PostgreSQL，蹭着这个机会把MyBatis练习一下。下面就直接开始。    </p>
<p>​    本次也顺带把配置文件修改为yml文件，方便后面的修改和配置。改文件很简单，只需要修改配置文件后缀名为yml即可。Spring可以直接识别，不需要修改其他的配置文件内容。将<code>application.properties</code>修改为<code>application.yml</code>。同时需要注意两个文件的格式是不一样的。需要注意的就是<code>:</code>后面有一个空格。</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#################################### common config : ####################################</span></span><br><span class="line"><span class="attr">server</span>:<span class="string"></span></span><br><span class="line">  <span class="attr">port</span>: <span class="string">8080</span></span><br><span class="line"><span class="attr">spring</span>:<span class="string"></span></span><br><span class="line">  <span class="attr">application</span>:<span class="string"></span></span><br><span class="line">    <span class="attr">name</span>: <span class="string">train</span></span><br><span class="line"><span class="comment">  #Redis依赖</span></span><br><span class="line"><span class="comment">  # Redis服务器地址</span></span><br><span class="line">  <span class="attr">redis</span>:<span class="string"></span></span><br><span class="line">    <span class="attr">host</span>: <span class="string">127.0.0.1</span></span><br><span class="line"><span class="comment">    # Redis数据库索引（默认为0）</span></span><br><span class="line">    <span class="attr">database</span>: <span class="string">0</span></span><br><span class="line"><span class="comment">    # Redis服务器连接端口</span></span><br><span class="line">    <span class="attr">port</span>: <span class="string">6379</span></span><br><span class="line"><span class="comment">    # Redis服务器连接密码（默认为空）</span></span><br><span class="line">    <span class="attr">password</span>: <span class="string">mima</span></span><br><span class="line"><span class="comment">    # 连接超时时间（毫秒）</span></span><br><span class="line">    <span class="attr">timeout</span>: <span class="string">1000</span></span><br><span class="line">    <span class="attr">lettuce</span>:<span class="string"></span></span><br><span class="line">      <span class="attr">pool</span>:<span class="string"></span></span><br><span class="line"><span class="comment">        ## 连接池最大连接数（使用负值表示没有限制）</span></span><br><span class="line">        <span class="meta">max-active</span>: <span class="string">200</span></span><br><span class="line"><span class="comment">        ## 连接池最大阻塞等待时间（使用负值表示没有限制）</span></span><br><span class="line">        <span class="meta">max-wait</span>: <span class="string">-1</span></span><br><span class="line"><span class="comment">        ## 连接池中的最大空闲连接</span></span><br><span class="line">        <span class="meta">max-idle</span>: <span class="string">10</span></span><br><span class="line"><span class="comment">        ## 连接池中的最小空闲连接</span></span><br><span class="line">        <span class="meta">min-idle</span>: <span class="string">0</span></span><br><span class="line">  <span class="attr">datasource</span>:<span class="string"></span></span><br><span class="line"><span class="comment">    #PostgreSQL配置</span></span><br><span class="line">    <span class="attr">url</span>: <span class="string">jdbc:postgresql://127.0.0.1:5432/postgres</span></span><br><span class="line">    <span class="attr">username</span>: <span class="string">postgres</span></span><br><span class="line">    <span class="attr">password</span>: <span class="string">mima</span></span><br><span class="line">    <span class="meta">driver-class-name</span>: <span class="string">org.postgresql.Driver</span></span><br><span class="line"><span class="comment">    #druid连接池配置</span></span><br><span class="line">    <span class="attr">type</span>: <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line"><span class="comment">    # 初始化时建立物理连接的个数。初始化发生在显示调用init方法，或者第一次getConnection时</span></span><br><span class="line">    <span class="attr">initialSize</span>: <span class="string">5</span></span><br><span class="line">    <span class="attr">minIdle</span>: <span class="string">5</span></span><br><span class="line"><span class="comment">    # 最大连接池数量</span></span><br><span class="line">    <span class="attr">maxActive</span>: <span class="string">20</span></span><br><span class="line">    <span class="attr">maxWait</span>: <span class="string">60000</span></span><br><span class="line">    <span class="attr">timeBetweenEvictionRunsMillis</span>: <span class="string">60000</span></span><br><span class="line">    <span class="attr">minEvictableIdleTimeMillis</span>: <span class="string">300000</span></span><br><span class="line">    <span class="attr">validationQuery</span>: <span class="string">SELECT 1</span></span><br><span class="line">    <span class="attr">testWhileIdle</span>: <span class="string">true</span></span><br><span class="line">    <span class="attr">testOnBorrow</span>: <span class="string">false</span></span><br><span class="line">    <span class="attr">testOnReturn</span>: <span class="string">false</span></span><br><span class="line">    <span class="attr">poolPreparedStatements</span>: <span class="string">true</span></span><br><span class="line"><span class="comment">    #   配置监控统计拦截的filters，去掉后监控界面sql无法统计，&#x27;wall&#x27;用于防火墙</span></span><br><span class="line">    <span class="attr">filters</span>: <span class="string">stat,wall</span></span><br><span class="line">    <span class="attr">maxPoolPreparedStatementPerConnectionSize</span>: <span class="string">20</span></span><br><span class="line">    <span class="attr">useGlobalDataSourceStat</span>: <span class="string">true</span></span><br><span class="line">    <span class="attr">connectionProperties</span>: <span class="string">druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500</span></span><br><span class="line"></span><br><span class="line"><span class="attr">mybatis</span>:<span class="string"></span></span><br><span class="line"><span class="comment">	# 加载配置文件</span></span><br><span class="line">  <span class="meta">mapper-locations</span>: <span class="string">classpath:mapper/*.xml</span></span><br><span class="line"><span class="comment">  # 实体类所在路径，填写改路径mapper文件中可以不写全路径</span></span><br><span class="line">  <span class="meta">type-aliases-package</span>: <span class="string">com.psq.train.mysql</span></span><br></pre></td></tr></table></figure>

<p>​    另外，这次也使用了连接池Druid，这个是阿里开发的一个工具，挺好用（大家都这样说）。这次也顺带整合进去。下面就一步一步来吧。</p>
<p>​    首先整合PostgreSQL，添加PostgreSQL依赖即可。如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- postgresql依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.postgresql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>postgresql<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    顺带添加Mybatis和Druid的依赖。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- druid连接池依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.22<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- MyBatis依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    要记得删除之前使用的MySQL的依赖，因为我之前的项目使用了MySQL，所以删除了MySQL和JDBC的依赖。另外这里也遇到一个坑。不知道IDE抽什么风，项目启动的时候一直报错，显示Redis和Mybatis没有配置，但是我依赖都已经删除了。我找了三个小时，最后才发现项目的库不对，仍然存在已经删除的jar包。所以再删除依赖后更新pom文件后，需要查看下面两个地方是不是正常。如下图：</p>
<p>​    <img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20200612161516325.png" alt="image-20200612161516325"></p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20200612161543564.png" alt="image-20200612161543564"></p>
<p>​    更新完毕依赖后，下面就可以编写配置文件了。配置文件如上面所示，PostgreSQL需要注意<code>url</code>和<code>driver-class-name</code>。从<code>type</code>往下都是Druid的配置。Mybatis也是最下面的配置。</p>
<p>​    Druid的配置详细解读这个链接比较详细。<a target="_blank" rel="noopener" href="https://www.cnblogs.com/lzhya/p/12493974.html">https://www.cnblogs.com/lzhya/p/12493974.html</a></p>
<p>​    同时，因为spring中的Druid配置文件不能读取，所以要写一个配置类，让参数正常加载。代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psq.train.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.psq.train.mysql.TestUser;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * UserMapper.java</span></span><br><span class="line"><span class="comment"> * Description: user表的mapper映射</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Peng Shiquan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/6/12</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Description: 查询所有用户信息</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> java.util.List&lt;com.psq.train.mysql.TestUser&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span>: Peng Shiquan</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span>: 2020/6/12</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;TestUser&gt; <span class="title">getAllUser</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    Mybatis的配置这里不是很了解，不再解释，后面慢慢补上。</p>
<p>​    为了让dao层的mapper映射文件能够注入，启动类添加了下面的注解。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psq.train;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.annotation.MapperScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Description: SpringBoot启动类</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> null</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: Peng Shiquan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2020/5/28</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.psq.train.dao&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TrainApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(TrainApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    项目结构图如下：</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20200612163659925.png" alt="image-20200612163659714"></p>
<p>​    下面就是具体的业务代码实现，上面都是基础的配置。</p>
<ul>
<li><p>首先需要先创建表，这里不再叙述，后面需要补充，我就是简单的创建了一个user表，和MySQL的类似。</p>
</li>
<li><p>再就是创建mapper文件，相当于把数据库中的表和java代码联系起来。代码如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.psq.train.dao.UserMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getAllUser&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;TestUser&quot;</span>&gt;</span></span><br><span class="line">        SELECT id,name,password FROM test_user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>创建一个mapper类，方法名要和mapper文件中的id保持一致。代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psq.train.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.psq.train.mysql.TestUser;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * UserMapper.java</span></span><br><span class="line"><span class="comment"> * Description: user表的mapper映射</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Peng Shiquan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/6/12</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Description: 查询所有用户信息</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> java.util.List&lt;com.psq.train.mysql.TestUser&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span>: Peng Shiquan</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span>: 2020/6/12</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;TestUser&gt; <span class="title">getAllUser</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>创建测试类，调用一下mapper类查询一下数据，这里最简单就可以了，所以没有按照web开发的模版写。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psq.train.postgresql;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.psq.train.dao.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.psq.train.mysql.TestUser;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.PostConstruct;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * PostgreSQLTest.javaa</span></span><br><span class="line"><span class="comment"> * Description:  PostgreSQL的测试demo</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Peng Shiquan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/6/12</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PostgreSQLTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Description: PostgreSQL的测试方法</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span>: Peng Shiquan</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span>: 2020/6/12</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selectAllUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;TestUser&gt; testUserList = userMapper.getAllUser();</span><br><span class="line">        <span class="keyword">for</span> (TestUser testUser : testUserList) &#123;</span><br><span class="line">            System.err.println(testUser.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>​    这里有一个地方需要注意，编写Drudi配置类的时候，发现无法启动，报错信息是注入了相同name的bean，最后排查到是Druid配置类名字和其中一个方法名字相同，导致无法注入。后面查询到这俩注解的作用如下：</p>
<ul>
<li><p>@Configuration</p>
<ul>
<li><p>@Configuration注解底层是含有@Component ，所以@Configuration 具有和 @Component 的作用。</p>
</li>
<li><p>@Configuration注解相当于spring的xml配置文件中<beans>标签，里面可以配置bean。</p>
</li>
</ul>
</li>
<li><p>@Bean</p>
<ul>
<li><p>@Bean注解相当于spring的xml配置文件<bean>标签，告诉容器注入一个bean。</p>
</li>
<li><p>@Bean注解的方法上如果没通过bean指定实例名，默认实例名与方法名相同。</p>
</li>
<li><p>@Bean注解默认为单例模式，可以通过@Scope(“prototype”)设置为多例。</p>
</li>
</ul>
</li>
</ul>
<p>​    关于PostgreSQL数据库的其他信息，下面一篇博客再说吧，要不然博客就太多了。</p>
<p>​    就这样吧，结束。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%A1%86%E6%9E%B6/Spring%E7%9B%B8%E5%85%B3%E6%A1%86%E6%9E%B6/SpringBoot%E9%9B%86%E5%90%88Mybatis%E8%BF%9E%E6%8E%A5PostgreSQL/" data-id="ckupl1rso002e6rupgmcu37mv" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-qq1162210866.github.io/博客/框架/Spring相关框架/SpringBoot集成Log4j2日志框架" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%A1%86%E6%9E%B6/Spring%E7%9B%B8%E5%85%B3%E6%A1%86%E6%9E%B6/SpringBoot%E9%9B%86%E6%88%90Log4j2%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6/" class="article-date">
  <time datetime="2021-10-13T13:28:21.198Z" itemprop="datePublished">2021-10-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="SpringBoot集成Log4j2日志框架"><a href="#SpringBoot集成Log4j2日志框架" class="headerlink" title="SpringBoot集成Log4j2日志框架"></a>SpringBoot集成Log4j2日志框架</h2><p>​    今天写代码的时候遇到了日志的问题，于是顺带学习一下日志框架和如何使用。以SpringBoot集成作为练习。</p>
<p>​    说到日志框架不得不提SLF4J，SLF4J使用门面模式定义了日志操作的相关接口。就是说SLF4J只是定义了日志操作的相关接口，而不是具体的日志实现方案。SLF4J提供了操作日志的通用接口规范，只要你实现了这些规范接口，那么你就制作了一个符合SLF4J约定的日志框架。而比较出名的开源日志框架有：java.util.logging, logback and log4j。</p>
<p>​    本次整合的就是log4j日志框架。还是和以前一样，直接上官网地址，上面讲解的很详细。<a target="_blank" rel="noopener" href="https://logging.apache.org/log4j/2.x/index.html">https://logging.apache.org/log4j/2.x/index.html</a></p>
<p>​    因为是一个日志框架，和本身开发没有太多的关系，所以这里不再详细描述原理和基础概念。只是把练习demo列出来。</p>
<p>​    先试pom文件引入依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--  lof4j2日志框架      --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    因为引入的日志框架会和SpringBoot基础依赖冲突，这里将SpringBoot的基础依赖去除。去除代码后如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 基础依赖 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- SpringBoot基础依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span><span class="comment">&lt;!-- 去掉springboot默认配置 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--  添加web依赖，这样项目就可以一直启动      --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span><span class="comment">&lt;!-- 去掉springboot默认配置 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    下面就是在<code>resources</code>目录下创建一个文件，文件名为<code>log4j2.xml</code>。内容如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Configuration</span> <span class="attr">status</span>=<span class="string">&quot;WARN&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Appenders</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Console</span> <span class="attr">name</span>=<span class="string">&quot;Console&quot;</span> <span class="attr">target</span>=<span class="string">&quot;SYSTEM_OUT&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;%d&#123;HH:mm:ss.SSS&#125; [%t] %-5level %logger&#123;36&#125; - %msg%n&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Console</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Appenders</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Loggers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Root</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Console&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Root</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Loggers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    下面就完成了，启动项目出现如下截图：</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20200708170508353.png" alt="image-20200708170508353"></p>
<p>​    完成。</p>
<p>​    因为是初步的使用，所以配置文件中有些不是很明白，解释如下：顺带给自己一个记录。</p>
<p>​    下面给出一个xml的模版，大家可以按照这个配置。模版来自于:<a target="_blank" rel="noopener" href="https://www.cnblogs.com/keeya/p/10101547.html">https://www.cnblogs.com/keeya/p/10101547.html</a></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Configuration后面的status，这个用于设置log4j2自身内部的信息输出，可以不设置，当设置成trace时，你会看到log4j2内部各种详细输出--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--monitorInterval：Log4j能够自动检测修改配置 文件和重新配置本身，设置间隔秒数--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">monitorInterval</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--日志级别以及优先级排序: OFF &gt; FATAL &gt; ERROR &gt; WARN &gt; INFO &gt; DEBUG &gt; TRACE &gt; ALL --&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--变量配置--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Properties</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 格式化输出：%date表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度 %msg：日志消息，%n是换行符--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- %logger&#123;36&#125; 表示 Logger 名字最长36个字符 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;LOG_PATTERN&quot;</span> <span class="attr">value</span>=<span class="string">&quot;%date&#123;HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;36&#125; - %msg%n&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 定义日志存储的路径 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;FILE_PATH&quot;</span> <span class="attr">value</span>=<span class="string">&quot;更换为你的日志路径&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;FILE_NAME&quot;</span> <span class="attr">value</span>=<span class="string">&quot;更换为你的项目名&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">appenders</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">console</span> <span class="attr">name</span>=<span class="string">&quot;Console&quot;</span> <span class="attr">target</span>=<span class="string">&quot;SYSTEM_OUT&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--输出日志的格式--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;$&#123;LOG_PATTERN&#125;&quot;</span>/&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--控制台只输出level及其以上级别的信息（onMatch），其他的直接拒绝（onMismatch）--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">&quot;info&quot;</span> <span class="attr">onMatch</span>=<span class="string">&quot;ACCEPT&quot;</span> <span class="attr">onMismatch</span>=<span class="string">&quot;DENY&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">console</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--文件会打印出所有信息，这个log每次运行程序会自动清空，由append属性决定，适合临时测试用--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">File</span> <span class="attr">name</span>=<span class="string">&quot;Filelog&quot;</span> <span class="attr">fileName</span>=<span class="string">&quot;$&#123;FILE_PATH&#125;/test.log&quot;</span> <span class="attr">append</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;$&#123;LOG_PATTERN&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">File</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 这个会打印出所有的info及以下级别的信息，每次大小超过size，则这size大小的日志会自动存入按年份-月份建立的文件夹下面并进行压缩，作为存档--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">RollingFile</span> <span class="attr">name</span>=<span class="string">&quot;RollingFileInfo&quot;</span> <span class="attr">fileName</span>=<span class="string">&quot;$&#123;FILE_PATH&#125;/info.log&quot;</span> <span class="attr">filePattern</span>=<span class="string">&quot;$&#123;FILE_PATH&#125;/$&#123;FILE_NAME&#125;-INFO-%d&#123;yyyy-MM-dd&#125;_%i.log.gz&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--控制台只输出level及以上级别的信息（onMatch），其他的直接拒绝（onMismatch）--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">&quot;info&quot;</span> <span class="attr">onMatch</span>=<span class="string">&quot;ACCEPT&quot;</span> <span class="attr">onMismatch</span>=<span class="string">&quot;DENY&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;$&#123;LOG_PATTERN&#125;&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">Policies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--interval属性用来指定多久滚动一次，默认是1 hour--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TimeBasedTriggeringPolicy</span> <span class="attr">interval</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">SizeBasedTriggeringPolicy</span> <span class="attr">size</span>=<span class="string">&quot;10MB&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">Policies</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- DefaultRolloverStrategy属性如不设置，则默认为最多同一文件夹下7个文件开始覆盖--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">DefaultRolloverStrategy</span> <span class="attr">max</span>=<span class="string">&quot;15&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">RollingFile</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 这个会打印出所有的warn及以下级别的信息，每次大小超过size，则这size大小的日志会自动存入按年份-月份建立的文件夹下面并进行压缩，作为存档--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">RollingFile</span> <span class="attr">name</span>=<span class="string">&quot;RollingFileWarn&quot;</span> <span class="attr">fileName</span>=<span class="string">&quot;$&#123;FILE_PATH&#125;/warn.log&quot;</span> <span class="attr">filePattern</span>=<span class="string">&quot;$&#123;FILE_PATH&#125;/$&#123;FILE_NAME&#125;-WARN-%d&#123;yyyy-MM-dd&#125;_%i.log.gz&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--控制台只输出level及以上级别的信息（onMatch），其他的直接拒绝（onMismatch）--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">&quot;warn&quot;</span> <span class="attr">onMatch</span>=<span class="string">&quot;ACCEPT&quot;</span> <span class="attr">onMismatch</span>=<span class="string">&quot;DENY&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;$&#123;LOG_PATTERN&#125;&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">Policies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--interval属性用来指定多久滚动一次，默认是1 hour--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TimeBasedTriggeringPolicy</span> <span class="attr">interval</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">SizeBasedTriggeringPolicy</span> <span class="attr">size</span>=<span class="string">&quot;10MB&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">Policies</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- DefaultRolloverStrategy属性如不设置，则默认为最多同一文件夹下7个文件开始覆盖--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">DefaultRolloverStrategy</span> <span class="attr">max</span>=<span class="string">&quot;15&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">RollingFile</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 这个会打印出所有的error及以下级别的信息，每次大小超过size，则这size大小的日志会自动存入按年份-月份建立的文件夹下面并进行压缩，作为存档--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">RollingFile</span> <span class="attr">name</span>=<span class="string">&quot;RollingFileError&quot;</span> <span class="attr">fileName</span>=<span class="string">&quot;$&#123;FILE_PATH&#125;/error.log&quot;</span> <span class="attr">filePattern</span>=<span class="string">&quot;$&#123;FILE_PATH&#125;/$&#123;FILE_NAME&#125;-ERROR-%d&#123;yyyy-MM-dd&#125;_%i.log.gz&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--控制台只输出level及以上级别的信息（onMatch），其他的直接拒绝（onMismatch）--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">&quot;error&quot;</span> <span class="attr">onMatch</span>=<span class="string">&quot;ACCEPT&quot;</span> <span class="attr">onMismatch</span>=<span class="string">&quot;DENY&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;$&#123;LOG_PATTERN&#125;&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">Policies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--interval属性用来指定多久滚动一次，默认是1 hour--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TimeBasedTriggeringPolicy</span> <span class="attr">interval</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">SizeBasedTriggeringPolicy</span> <span class="attr">size</span>=<span class="string">&quot;10MB&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">Policies</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- DefaultRolloverStrategy属性如不设置，则默认为最多同一文件夹下7个文件开始覆盖--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">DefaultRolloverStrategy</span> <span class="attr">max</span>=<span class="string">&quot;15&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">RollingFile</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">appenders</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--Logger节点用来单独指定日志的形式，比如要为指定包下的class指定不同的日志级别等。--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--然后定义loggers，只有定义了logger并引入的appender，appender才会生效--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">loggers</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--过滤掉spring和mybatis的一些无用的DEBUG信息--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;org.mybatis&quot;</span> <span class="attr">level</span>=<span class="string">&quot;info&quot;</span> <span class="attr">additivity</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Console&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--监控系统信息--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--若是additivity设为false，则 子Logger 只会在自己的appender里输出，而不会在 父Logger 的appender里输出。--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.springframework&quot;</span> <span class="attr">level</span>=<span class="string">&quot;info&quot;</span> <span class="attr">additivity</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Console&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;info&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;Console&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;Filelog&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;RollingFileInfo&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;RollingFileWarn&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;RollingFileError&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">loggers</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    上面的网页讲的挺清楚，我再写一遍有点浪费。这样大家看看，记不住再到我这里看看就可以了。</p>
<p>​    就这样吧，结束。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%A1%86%E6%9E%B6/Spring%E7%9B%B8%E5%85%B3%E6%A1%86%E6%9E%B6/SpringBoot%E9%9B%86%E6%88%90Log4j2%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6/" data-id="ckupl1rsp002f6rup2smbfa2w" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-qq1162210866.github.io/博客/框架/Spring相关框架/Spring相关知识点" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%A1%86%E6%9E%B6/Spring%E7%9B%B8%E5%85%B3%E6%A1%86%E6%9E%B6/Spring%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9/" class="article-date">
  <time datetime="2021-10-13T13:28:21.198Z" itemprop="datePublished">2021-10-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Spring内部知识点"><a href="#Spring内部知识点" class="headerlink" title="Spring内部知识点"></a>Spring内部知识点</h2><h3 id="IOC相关知识点"><a href="#IOC相关知识点" class="headerlink" title="IOC相关知识点"></a>IOC相关知识点</h3><h4 id="IOC基础概念"><a href="#IOC基础概念" class="headerlink" title="IOC基础概念"></a>IOC基础概念</h4><p>​    所谓 IOC ，就是由 Spring IOC 容器来负责对象的生命周期和对象之间的关系。之前传统的是由对象内部直接生成，这样耦合度太高。通过控制反转，只需要告知IOC容器你需要什么样的实例，IOC容器就会自动将实例注入到你的实例里面。控制反转需要依赖注入的支持，即依赖注入是控制反转的实现。依赖注入就是由容器动态的将某个依赖关系注入到组件之中。依赖注入的目的并非为软件系统带来更多功能，而是为了提升组件重用的频率，并为系统搭建一个灵活、可扩展的平台。</p>
<p>​    <a target="_blank" rel="noopener" href="https://juejin.cn/post/6857406008877121550">详细的解释</a></p>
<h4 id="依赖注入的类型和方式"><a href="#依赖注入的类型和方式" class="headerlink" title="依赖注入的类型和方式"></a>依赖注入的类型和方式</h4><p>​    依赖注入的类型有：</p>
<ul>
<li>值类型注入 ：就是基础的数据类型，如字符串和Integer</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- applicationContext.xml --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 普通数据类型注入，通过构造器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;po.User&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">value</span>=<span class="string">&quot;zhangsan&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;18&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 普通数据类型注入，通过setter方法 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;po.User&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;lisi&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>引用类型注入：需要依赖的是一个实例，需要现在xml文件中创建这个实例的bean，再去引用</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- applicationContext.xml --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 引用数据类型注入，通过构造器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;dao.impl.UserDaoImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;service.impl.UserServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 引用数据类型注入，通过setter方法 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;dao.impl.UserDaoImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;service.impl.UserServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>复杂的集合形式：将多个实例放入到集合中，本质和引用类型相差不多，但是需要注意标签。（集合类型的注入只能通过XML来实现）</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- applicationContext.xml --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 集合数据类型注入 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;po.User&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;zhangsan&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;18&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;po.User&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;lisi&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;dao.impl.UserDaoImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>aaa<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>bbb<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>ccc<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 另一种方法，需要添加第三方约束 --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- xmlns:util=&quot;http://www.springframework.org/schema/util&quot; --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- http://www.springframework.org/schema/util --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- http://www.springframework.org/schema/util/spring-util.xsd --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;util:list list-class=&quot;java.util.ArrayList&quot;&gt;</span></span><br><span class="line"><span class="comment">                &lt;value&gt;aaa&lt;/value&gt;</span></span><br><span class="line"><span class="comment">                &lt;value&gt;bbb&lt;/value&gt;</span></span><br><span class="line"><span class="comment">                &lt;value&gt;ccc&lt;/value&gt;</span></span><br><span class="line"><span class="comment">            &lt;/util:list&gt;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;set&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>ddd<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>eee<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>fff<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userList&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;user1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ref</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;user2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ref</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userMap&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;k_user1&quot;</span> <span class="attr">value-ref</span>=<span class="string">&quot;user1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;k_user2&quot;</span> <span class="attr">value-ref</span>=<span class="string">&quot;user2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;properties&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;properties_name&quot;</span>&gt;</span>wangwu<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;properties_age&quot;</span>&gt;</span>25<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    依赖注入的方式有：</p>
<ul>
<li>第一种：使用构造函数提供。</li>
<li>第二种：使用set方法提供(常用)。</li>
<li>第三种：使用注解提供。首先按照类型去Spring容器中圈定出来匹配的对象，接下来使用变量名作为bean的id在圈定出来的内容里继续查找，如果有一样的也可以注入成功，如果都不一样报错。</li>
</ul>
<p>​    需要注意的点：</p>
<ul>
<li>一个bean代表一个实例，一个实例只能调用一个构造方法。</li>
<li>一个bean里面可以进行组合，可以使用构造方法注入，也可以使用set方法注入。</li>
<li>当bean里面有多个注入时，构造方法在前，set在后，会造成覆盖。构造器方法注入-&gt;字段注入-&gt;属性或普通方法注入.</li>
<li>如何想要使用set方法注入，必须实现默认无参构造方法。如果实现了其他的构造方法，则无参构造方法不会自动生成。（Spring需要先利用无参的构造方法反射创建一个对象，再使用set方法给属性赋值）</li>
</ul>
<h4 id="依赖注入常用的注解"><a href="#依赖注入常用的注解" class="headerlink" title="依赖注入常用的注解"></a>依赖注入常用的注解</h4><ul>
<li>@Qualifier：在按照类中注入的基础之上再按照名称注入。它在给类成员注入时不能单独使用。但是在给方法参数注入时可以。需要搭配@Autowired</li>
<li>@Autowired默认按类型装配。</li>
<li>@Resource（常用）：直接按照bean的id注入。它可以独立使用。</li>
<li>@Value：用于注入基本类型和String类型的数据。</li>
</ul>
<h4 id="IOC容器"><a href="#IOC容器" class="headerlink" title="IOC容器"></a>IOC容器</h4><p>​    IOC 容器具有依赖注入功能的容器，它可以创建对象，IOC 容器负责实例化、定位、配置应用程序中的对象及建立这些对象间的依赖。</p>
<p>​    常用的两个容器：</p>
<ul>
<li>BeanFactory 容器：最简单的容器，只提供基础的依赖注入的功能。</li>
<li>ApplicationContext 容器：Spring上下文，比较复杂的容器。提供了其他的功能。</li>
</ul>
<h5 id="Bean的作用域"><a href="#Bean的作用域" class="headerlink" title="Bean的作用域"></a>Bean的作用域</h5><table>
<thead>
<tr>
<th align="center">作用域</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">singleton</td>
<td align="center">在spring IoC容器仅存在一个Bean实例，Bean以单例方式存在，默认值。（不是线程安全的）</td>
</tr>
<tr>
<td align="center">prototype</td>
<td align="center">每次从容器中调用Bean时，都返回一个新的实例，即每次调用getBean()时，相当于执行newXxxBean()</td>
</tr>
<tr>
<td align="center">request</td>
<td align="center">每次HTTP请求都会创建一个新的Bean，该作用域仅适用于WebApplicationContext环境</td>
</tr>
<tr>
<td align="center">session</td>
<td align="center">同一个HTTP Session共享一个Bean，不同Session使用不同的Bean，仅适用于WebApplicationContext环境</td>
</tr>
<tr>
<td align="center">global-session</td>
<td align="center">一般用于Portlet应用环境，该作用域仅适用于WebApplicationContext环境</td>
</tr>
</tbody></table>
<h5 id="Bean的生命周期"><a href="#Bean的生命周期" class="headerlink" title="Bean的生命周期"></a>Bean的生命周期</h5><p>全套初始化方法及其标准顺序是：</p>
<ul>
<li>BeanNameAware 的setBeanName：在创建此 bean 的 bean 工厂中设置 bean 的名称。</li>
<li>BeanClassLoaderAware 的setBeanClassLoader：将 bean class loader提供给 bean 实例的回调。</li>
<li>BeanFactoryAware 的setBeanFactory：将拥有工厂提供给 bean 实例的回调。</li>
<li>EnvironmentAware 的setEnvironment：设置该组件运行的Environment 。</li>
<li>EmbeddedValueResolverAware 的setEmbeddedValueResolver：设置 StringValueResolver 以用于解析嵌入的定义值。<br>ResourceLoaderAware 的setResourceLoader （仅在应用程序上下文中运行时适用）：设置运行此对象的 ResourceLoader。</li>
<li>ApplicationEventPublisherAware 的setApplicationEventPublisher （仅在应用程序上下文中运行时适用）：设置运行此对象的 ApplicationEventPublisher。</li>
<li>MessageSourceAware 的setMessageSource （仅在应用程序上下文中运行时适用）：设置此对象运行所在的 MessageSource。</li>
<li>ApplicationContextAware 的setApplicationContext （仅在应用程序上下文中运行时适用）：设置此对象运行所在的 ApplicationContext。通常此调用将用于初始化对象。</li>
<li>ServletContextAware 的setServletContext （仅在 web 应用上下文中运行时适用）：设置该对象运行所在的ServletContext 。</li>
<li>BeanPostProcessors 的postProcessBeforeInitialization方法：在任何 bean 初始化回调（如 InitializingBean 的afterPropertiesSet或自定义初始化方法）之前，将此BeanPostProcessor应用于给定的新 bean 实例。bean 已经被填充了属性值。 返回的 bean 实例可能是原始实例的包装器。默认实现按原样返回给定的bean 。</li>
<li>InitializingBean 的afterPropertiesSet：在设置所有 bean 属性并满足BeanFactoryAware ， ApplicationContextAware等之后，由包含BeanFactory调用。</li>
<li>自定义初始化方法定义：</li>
<li>BeanPostProcessors 的postProcessAfterInitialization方法：在任何 bean 初始化回调（如 InitializingBean 的afterPropertiesSet或自定义初始化方法）之后，将此BeanPostProcessor应用于给定的新 bean 实例。bean 已经被填充了属性值。 返回的 bean 实例可能是原始实例的包装器。</li>
</ul>
<p>​    在关闭 bean 工厂时，以下生命周期方法适用：</p>
<ul>
<li>DestructionAwareBeanPostProcessors 的postProcessBeforeDestruction方法：在销毁之前将此 BeanPostProcessor 应用于给定的 bean 实例，例如调用自定义销毁回调。</li>
<li>DisposableBean 的destroy：在销毁 bean 时由包含BeanFactory调用。</li>
<li>自定义销毁方法定义：</li>
</ul>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210618220738157.png" alt="image-20210618220738157"></p>
<p>实例化 -&gt; 属性赋值 -&gt; 初始化 -&gt; 销毁</p>
<h5 id="自动装配"><a href="#自动装配" class="headerlink" title="自动装配"></a>自动装配</h5><p>​    上面的方式都是通过xml配置bean，非常的复杂和繁琐。自动装配就是解决这个问题，但是自动装配不能装配所谓的简单类型包括基本类型，字符串和类。</p>
<p>​    自动装配的模式：</p>
<table>
<thead>
<tr>
<th align="center">模式</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">no</td>
<td align="center">这是默认的设置，它意味着没有自动装配，你应该使用显式的bean引用来连线。你不用为了连线做特殊的事。在依赖注入章节你已经看到这个了。</td>
</tr>
<tr>
<td align="center">byName</td>
<td align="center">由属性名自动装配。Spring 容器看到在 XML 配置文件中 bean 的自动装配的属性设置为 byName。然后尝试匹配，并且将它的属性与在配置文件中被定义为相同名称的 beans 的属性进行连接。</td>
</tr>
<tr>
<td align="center">byType</td>
<td align="center">由属性数据类型自动装配。Spring 容器看到在 XML 配置文件中 bean 的自动装配的属性设置为 byType。然后如果它的<strong>类型</strong>匹配配置文件中的一个确切的 bean 名称，它将尝试匹配和连接属性的类型。如果存在不止一个这样的 bean，则一个致命的异常将会被抛出。</td>
</tr>
<tr>
<td align="center">constructor</td>
<td align="center">类似于 byType，但该类型适用于构造函数参数类型。如果在容器中没有一个构造函数参数类型的 bean，则一个致命错误将会发生。</td>
</tr>
<tr>
<td align="center">autodetect（3.0版本不支持）</td>
<td align="center">Spring首先尝试通过 constructor 使用自动装配来连接，如果它不执行，Spring 尝试通过 byType 来自动装配。</td>
</tr>
</tbody></table>
<h3 id="AOP相关知识点"><a href="#AOP相关知识点" class="headerlink" title="AOP相关知识点"></a>AOP相关知识点</h3><p>​    面向方面的编程需要把程序逻辑分解成不同的部分称为所谓的关注点。跨一个应用程序的多个点的功能被称为横切关注点，这些横切关注点在概念上独立于应用程序的业务逻辑。有各种各样的常见的很好的方面的例子，如日志记录、审计、声明式事务、安全性和缓存等。</p>
<p>​    当出现多个对象需要一个公共行为时，在每个对象里面编写也是不太现实的，所以引入了AOP。AOP有两种实现方式：基于JDK和CGLIB。</p>
<p>​    AOP中的几个概念：</p>
<table>
<thead>
<tr>
<th align="center">项</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Aspect</td>
<td align="center">一个模块具有一组提供横切需求的 APIs。例如，一个日志模块为了记录日志将被 AOP 方面调用。应用程序可以拥有任意数量的方面，这取决于需求。</td>
</tr>
<tr>
<td align="center">Join point</td>
<td align="center">在你的应用程序中它代表一个点，你可以在插件 AOP 方面。你也能说，它是在实际的应用程序中，其中一个操作将使用 Spring AOP 框架。</td>
</tr>
<tr>
<td align="center">Advice</td>
<td align="center">这是实际行动之前或之后执行的方法。这是在程序执行期间通过 Spring AOP 框架实际被调用的代码。</td>
</tr>
<tr>
<td align="center">Pointcut</td>
<td align="center">这是一组一个或多个连接点，通知应该被执行。你可以使用表达式或模式指定切入点正如我们将在 AOP 的例子中看到的。</td>
</tr>
<tr>
<td align="center">Introduction</td>
<td align="center">引用允许你添加新方法或属性到现有的类中。</td>
</tr>
<tr>
<td align="center">Target object</td>
<td align="center">被一个或者多个方面所通知的对象，这个对象永远是一个被代理对象。也称为被通知对象。</td>
</tr>
<tr>
<td align="center">Weaving</td>
<td align="center">Weaving 把方面连接到其它的应用程序类型或者对象上，并创建一个被通知的对象。这些可以在编译时，类加载时和运行时完成。</td>
</tr>
</tbody></table>
<p>​    关于通知的几个概念：</p>
<table>
<thead>
<tr>
<th align="center">通知</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">前置通知</td>
<td align="center">在一个方法执行之前，执行通知。</td>
</tr>
<tr>
<td align="center">后置通知</td>
<td align="center">在一个方法执行之后，不考虑其结果，执行通知。</td>
</tr>
<tr>
<td align="center">返回后通知</td>
<td align="center">在一个方法执行之后，只有在方法成功完成时，才能执行通知。</td>
</tr>
<tr>
<td align="center">抛出异常后通知</td>
<td align="center">在一个方法执行之后，只有在方法退出抛出异常时，才能执行通知。</td>
</tr>
<tr>
<td align="center">环绕通知</td>
<td align="center">在建议方法调用之前和之后，执行通知。</td>
</tr>
</tbody></table>
<h3 id="Spring事务管理"><a href="#Spring事务管理" class="headerlink" title="Spring事务管理"></a>Spring事务管理</h3><p>​    Spring 框架在不同的底层事务管理 APIs 的顶部提供了一个抽象层。Spring 的事务支持旨在通过添加事务能力到 POJOs 来提供给 EJB 事务一个选择方案。Spring 支持编程式和声明式事务管理。EJBs 需要一个应用程序服务器，但 Spring 事务管理可以在不需要应用程序服务器的情况下实现。同时，Spring直接抛出Exception就不会回滚，而抛出RuntimeException或其子类才会回滚</p>
<p>​    Spring事务管理的五大属性：隔离级别、传播行为、是否只读、事务超时、回滚规则。</p>
<p>​    隔离级别：</p>
<table>
<thead>
<tr>
<th align="center">隔离级别</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="center">ISOLATION_DEFAULT</td>
<td align="center">使用底层数据存储的默认隔离级别。 所有其他级别对应于 JDBC 隔离级别。</td>
</tr>
<tr>
<td align="center">ISOLATION_READ_UNCOMMITTED</td>
<td align="center">表示可能发生脏读、不可重复读和幻读。<br/>此级别允许由一个事务更改的行在提交该行中的任何更改之前被另一个事务读取（“脏读”）。 如果任何更改被回滚，则第二个事务将检索到无效行。</td>
</tr>
<tr>
<td align="center">ISOLATION_READ_COMMITTED</td>
<td align="center">表示防止脏读； 可能发生不可重复读和幻读。<br/>此级别仅禁止事务读取其中包含未提交更改的行。</td>
</tr>
<tr>
<td align="center">ISOLATION_REPEATABLE_READ</td>
<td align="center">表示防止脏读和不可重复读； 可能会发生幻读。<br/>此级别禁止事务读取未提交更改的行，也禁止一个事务读取一行，第二个事务更改该行，第一个事务重新读取该行，第二个获取不同值的情况时间（“不可重复读取”）。</td>
</tr>
<tr>
<td align="center">ISOLATION_SERIALIZABLE</td>
<td align="center">表示防止脏读、不可重复读和幻读。<br/>该级别包括ISOLATION_REPEATABLE_READ的禁止，并进一步禁止一个事务读取满足WHERE条件的所有行，第二个事务插入满足WHERE条件的行，第一个事务重新读取相同条件的情况，检索第二次阅读中的附加“幻影”行。</td>
</tr>
</tbody></table>
<p>传播行为：传播行为定义关于客户端和被调用方法的事务边界。Spring定义了7中传播行为。</p>
<table>
<thead>
<tr>
<th align="center">传播行为</th>
<th align="center">意义</th>
</tr>
</thead>
<tbody><tr>
<td align="center">PROPAGATION_REQUIRED</td>
<td align="center">支持当前事务； 如果不存在，则创建一个新的。 类似于同名的 EJB 事务属性。<br>如果当前没有事务，则自己新建一个事务，如果当前存在事务，则加入这个事务</td>
</tr>
<tr>
<td align="center">PROPAGATION_SUPPORTS</td>
<td align="center">支持当前事务； 如果不存在则以非事务方式执行。 类似于同名的 EJB 事务属性。<br/>当前存在事务，则加入当前事务，如果当前没有事务，就以非事务方法执行</td>
</tr>
<tr>
<td align="center">PROPAGATION_MANDATORY</td>
<td align="center">支持当前事务； 如果当前事务不存在，则抛出异常。 类似于同名的 EJB 事务属性。<br/>当前存在事务，则加入当前事务，如果当前事务不存在，则抛出异常。</td>
</tr>
<tr>
<td align="center">PROPAGATION_REQUIRES_NEW</td>
<td align="center">创建一个新事务，如果存在则暂停当前事务。 类似于同名的 EJB 事务属性。<br/>创建一个新事务，如果存在当前事务，则挂起该事务。</td>
</tr>
<tr>
<td align="center">PROPAGATION_NOT_SUPPORTED</td>
<td align="center">不支持当前事务； 而是始终以非事务方式执行。 类似于同名的 EJB 事务属性。<br/>始终以非事务方式执行,如果当前存在事务，则挂起当前事务</td>
</tr>
<tr>
<td align="center">PROPAGATION_NEVER</td>
<td align="center">不支持当前事务； 如果当前事务存在则抛出异常。 类似于同名的 EJB 事务属性。<br/>不使用事务，如果当前事务存在，则抛出异常</td>
</tr>
<tr>
<td align="center">PROPAGATION_NESTED</td>
<td align="center">如果当前事务存在，则在嵌套事务中执行，否则行为类似于PROPAGATION_REQUIRED 。 EJB 中没有类似的特性。<br/>如果当前事务存在，则在嵌套事务中执行，否则REQUIRED的操作一样（开启一个事务）</td>
</tr>
</tbody></table>
<h3 id="Spring面试中问到的问题"><a href="#Spring面试中问到的问题" class="headerlink" title="Spring面试中问到的问题"></a>Spring面试中问到的问题</h3><ul>
<li>Spring启动的流程</li>
</ul>
<p>​    </p>
<ul>
<li>Spring时如何解决循环依赖的</li>
</ul>
<p>​    这里以AB两个bean为例，创建一个bean分为实例化和属性赋值，实例化后的bean还不能使用，属性赋值后才能使用，类似于声明和赋值。实例化A时，发现容器中没有A实例，会创建一个A实例，但是发现A依赖B，再递归去查找B，发现B也没有，于是创建B实例，又发现B依赖A，但这时候A已经有了一个实例化，虽然只是半成品，把A赋值给B里面后，返回递归，最后A的实例化完成。</p>
<ul>
<li>Spring中bean的生命周期</li>
</ul>
<p>​    Spring中bean的生命周期主要包含四个阶段：实例化、属性赋值、初始化、销毁。实例化相当于声明，有三种实例化的方法，普通构造方法创建、静态工厂方法创建、实例化工厂方法创建。实例化和依赖注入的区别：实例化后的bean不是直接能使用的，还需要后续的初始化操作，依赖注入的bean是直接可以使用的。属性赋值阶段：主要是为bean的属性进行赋值，例如A依赖B，需要在这个时候将B注入到A中。然后就是初始化了：有 Aware 接口的依赖注入、BeanPostProcessor 在初始化前后的处理以及 InitializingBean 和 init-method 的初始化操作。然后初始化的bean就是可以使用的。最后就是销毁bean，通过DisposableBean 和 destory-method 。</p>
<ul>
<li>Spring中的三级缓存和解决循环依赖</li>
</ul>
<p>​    Spring中的三级缓存：singletonObjects：一级缓存，主要存放初始化完成之后的对象。singletonFactories：三级缓存：存放的工厂对象，能够生成的实例化后的对象。earlySingletonObjects：相当于半成品：实例化完成，但是初始化没有完成的对象。这里以AB两个实例举例。A实例化后，发现需要依赖B，在一二级缓存中查找，发现没有找到，在三级缓存中调用工厂方法实例化，实例化B的过程中发现需要注入A，在二级缓存中找到，将其注入。返回到A到初始化，A初始化完成，放入一级缓存。需要注意，Spring中多例的循环依赖无法解决，会报错。</p>
<ul>
<li>Spring容器的启动流程</li>
</ul>
<p>​    这一块的代码主要是在ApplicationContext里面，使用注解的话就是AnnotationConfigApplicationContext，使用xml的话就在ClassPathXmlApplicationContext。主要流程就是1）初始化Spring容器。2）将配置类的BeanDefinition注册到容器中。3）刷新容器。</p>
<h3 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h3><p>Spring内部的：</p>
<p>//IOC - 控制反转</p>
<p>//IOC容器</p>
<p>//Spring 负责创建和管理对象 (Bean)的生命周期和配置（比较复杂，可以后期详细看看）</p>
<p>//Spring中bean的声明周期和作用域</p>
<p>//自动装配的原理</p>
<p>//阅读Spring两个容器相关的源码</p>
<p>//AOP - 面向切面编程</p>
<p>//Spring核心容器</p>
<p>//事务管理 - 提供了用于事务管理的通用抽象层</p>
<p>Spring是如何加载xml文件的（可能比较复杂，后续再看源码）</p>
<p>Spring中注解的含义</p>
<p>//Spring的事务</p>
<p>Mybatis相关的</p>
<p>JDBC 异常</p>
<p>JDBC和ORM</p>
<p>Spring如何使用jdbc连接的</p>
<p>Mybatis的原理和使用的逻辑</p>
<p>web</p>
<p>WEB和websocket</p>
<p>Spring中Servlet</p>
<p>SpringBoot和Spring的区别</p>
<p>SpringBoot的启动流程和原理</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%A1%86%E6%9E%B6/Spring%E7%9B%B8%E5%85%B3%E6%A1%86%E6%9E%B6/Spring%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9/" data-id="ckupl1rsp002g6rup9yj14ld4" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-qq1162210866.github.io/博客/框架/Spring相关框架/spring项目建立" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%A1%86%E6%9E%B6/Spring%E7%9B%B8%E5%85%B3%E6%A1%86%E6%9E%B6/spring%E9%A1%B9%E7%9B%AE%E5%BB%BA%E7%AB%8B/" class="article-date">
  <time datetime="2021-10-13T13:28:21.198Z" itemprop="datePublished">2021-10-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="SpringBoot学习"><a href="#SpringBoot学习" class="headerlink" title="SpringBoot学习"></a>SpringBoot学习</h1><h2 id="建立一个SpringBoot项目"><a href="#建立一个SpringBoot项目" class="headerlink" title="建立一个SpringBoot项目"></a>建立一个SpringBoot项目</h2><h3 id="新建项目"><a href="#新建项目" class="headerlink" title="新建项目"></a>新建项目</h3><p>新建一个项目，在spring的官网上面，网址如下：<a target="_blank" rel="noopener" href="https://start.spring.io/">https://start.spring.io</a></p>
<p>该页面打开如下：选择自己合适的选项，点击下载即可下载一个zip包，解压就是你的项目。比较方便。</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/%E5%9B%BE%E5%83%8F2020-5-28%20%E4%B8%8B%E5%8D%887.08.JPG" alt="图像2020-5-28 下午7.08"></p>
<h3 id="导入IDE"><a href="#导入IDE" class="headerlink" title="导入IDE"></a>导入IDE</h3><p>​    这里使用自己的IDE导入刚才解压的目录，这里没有什么可以讲的点，就是IDE的使用方法，不在本次记录范围内。我使用的IDEA，导入后如下图。</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20200528191523635.png" alt="image-20200528191523635"></p>
<h3 id="启动项目"><a href="#启动项目" class="headerlink" title="启动项目"></a>启动项目</h3><p>​    找到启动类，右键启动即可，第一个SpringBoot项目就启动成功了。中间没有什么可讲的，都是IDE的使用方法，注意导入时的选项即可。</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20200528191813066.png" alt="image-20200528191813066"></p>
<h3 id="背后的事情"><a href="#背后的事情" class="headerlink" title="背后的事情"></a>背后的事情</h3><p>​    其实背后的事情非常复杂，Spring做了很多我们不了解的事情，因为这些东西比较琐碎，所以后面也是想起来就提提吧，能力有限，欢迎大家补充。今天就记录一下我知道的，大部分都是网上粘贴复制的。</p>
<p>​    SpringBoot是基于Spring开发的一个框架，随着Spring在Java中越来越不可或缺，SpringBoot也就越来越流行。按照我的理解就是简化开发人员的工作量，将一些繁琐的工作省略或者约定好，让资本更好的压榨我们。他的特点有下面的几点。（百度的）</p>
<ul>
<li><p>可以创建独立的Spring应用程序，并且基于其Maven或Gradle插件，可以创建可执行的JARs和WARs。</p>
</li>
<li><p>内嵌Tomcat或Jetty等Servlet容器。</p>
</li>
<li><p>提供自动配置的“starter”项目对象模型（POMS）以简化Maven配置。</p>
</li>
<li><p>尽可能自动配置Spring容器。</p>
</li>
<li><p>提供准备好的特性，如指标、健康检查和外部化配置。</p>
</li>
<li><p>绝对没有代码生成，不需要XML配置。      </p>
<p>不难看出这个框架就是为了使的开发人员的代码敲的越来越快（万恶的资本主义）。SpringBoot</p>
</li>
</ul>
<p>的两个策略：开箱即用和约定优于配置（百度）。目的也是让更多的东西成为约定或者减少不必要的配置。  </p>
<p>​        作为开发人员，使用工具固然重要，但是不能一直认为工具就是工具，作为编程人，要了解工具背后的设计思想和原理，这样才能开发出类似于SpringBoot这样的工具（可把我厉害坏了，插会腰）。我一直认为代码谁都可以写，但是思想这种东西抄不来，也模仿不了。但是正是思想这种东西才将程序员分为三六九等，说了半天，没有实质性的东西。。。诸君，努力吧。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%A1%86%E6%9E%B6/Spring%E7%9B%B8%E5%85%B3%E6%A1%86%E6%9E%B6/spring%E9%A1%B9%E7%9B%AE%E5%BB%BA%E7%AB%8B/" data-id="ckupl1rsq002h6rup5ggs7wji" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-qq1162210866.github.io/博客/心得/记最近一段时间的学习" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E5%BF%83%E5%BE%97/%E8%AE%B0%E6%9C%80%E8%BF%91%E4%B8%80%E6%AE%B5%E6%97%B6%E9%97%B4%E7%9A%84%E5%AD%A6%E4%B9%A0/" class="article-date">
  <time datetime="2021-10-13T13:28:21.197Z" itemprop="datePublished">2021-10-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="记最近一段时间的学习"><a href="#记最近一段时间的学习" class="headerlink" title="记最近一段时间的学习"></a>记最近一段时间的学习</h2><p>​    最近一段时间在学习红黑树，中间也停过一段时间，本以为是一个简单的事情，最后发现并没有想象中的简单。还是太年轻了啊。学习中间遇到了一些问题，这里也列举出来，分析一下原因，后面防止再犯。</p>
<h3 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h3><p>​    如果看到我之前的博客，可以看出这一段时间再梳理红黑树的相关知识点，中间还穿插了其他的东西。其实穿插不是我的本意，我以为一个星期就能啃完，但是中间的过程出乎我的意料，比我想象中的要麻烦和难缠。</p>
<p>​    两篇博客其实没有远没有达到我想象中的要求，感觉还是差点意思。原因也很简单，中间因为一些事情困惑了很久，最后写出来的文章自然差点意思。下面就具体说一说这两篇博客中间遇到的问题。</p>
<ul>
<li>在编写博客时，查阅了很多的资料。但是国内的环境大家都懂，水平层次不齐，找文章也是找了很久，最后不得己在外网找到一些文章，通过多篇文章联合补充了自己的认知。</li>
<li>写到一半就没有动力继续写了，只要打开编辑器就感觉知乎是这么好看，手头的工具是多么的不好用，指甲为什么没剪齐等等等。只要开始写，就没有了动力和激情。</li>
<li>编写这类博客或者学习这类知识点时，没有一个框架去套这些东西。就是说自己的逻辑思维里很少有学习这些知识的套路，不清楚如何学、怎样写。说白了，没有建立起自己的知识体系。</li>
<li>事情拖延太过于严重，总觉得写博客的紧张感没有工作时的紧张感大，也不强烈。可能也是导致没有动力的原因。</li>
<li>以算法为例：自己这一块的知识储备很少，  和上面的问题类似，遇到这类知识的学习没有头脑。</li>
</ul>
<h3 id="建议的方法"><a href="#建议的方法" class="headerlink" title="建议的方法"></a>建议的方法</h3><p>​    给出问题只是第一步，根据这些问题想出自己的答案才是最重要的。这里的方法只是针对于我自己，每个人的问题表现可能一样，但是原因可能有很大不同，万不可直接对号入座。</p>
<ul>
<li><strong>资料的重要性。</strong>学习时，资料时非常重要的，我是已经吃过苦头了，这里给出自己对于资料的先后排序。纸质书籍&gt;电子书籍&gt;维基百科&gt;谷歌资料&gt;国内资料。这里简单说明一下，首先一个作者能够出书显然已经证明了自己的实力，要不然一般人不会去花这个时间和精力的，所以书籍应该在前面。书籍的选择要看个人，并不是所有的书籍都合适，有些水书还是不要看了。外网的资料是比较全面，维基百科上面还是比较准确的（就技术方面资料而言），谷歌搜集的资料相对于国内的资料还是比较准确的，国内因为搜索引擎的限制，搜出来的文章都是粘贴复制，这个是大家都能看到的事实，并没有刻意贬低的意思。</li>
<li><strong>兴趣的重要性。</strong>兴趣是最好的老师，上学时，老师教导遇到困难要迎难而上，但是学习不是搞项目，兴趣才是最好的老师。所以尽量去专研哪些自己感兴趣的知识点，或者提升自己做事的兴趣，例如将自己的博客记录下来就是我编写这两篇博客最大的动力。想要将自己的知识展示出来或者说炫耀出来可能是我学习最大的动力。（。。。。汗颜）针对于每个人的情况，最好找到适合自己的兴趣，不要去做让自己痛苦并且毫无成就感的事，工作亦是如此。</li>
<li><strong>逻辑的重要性。</strong>学习一样东西，最好是有类似的经验，知道怎么个套路去学习。但是套路都是摸索出来的，多记录就会让自己的逻辑感慢慢增强。（个人对于逻辑感的理解，可能这里形容的不是很准确）如何形成自己的逻辑感？1.将学习过程中的迷惑记录下来。2.还有就是学习中对于知识点的感悟也记录下来，用于形成知识体系。还是多记录吧。</li>
<li><strong>一件事情最好三天内能够结束，要不然就可以放弃了。</strong>这个是我在《小狗钱钱》里面看到的一个理论（非常推荐这本书）。理论的正确性不去探讨，但是这个理论可以在一定程度上给予我们学习中的紧张感，所以在学习中间要制定一个里程碑，给出三天的时间，完不成就放弃，这样就可以让规则束缚自己去前进了。遇到大的问题，要进行细化，在将合理的小问题规划时间。（是不是和工作中的任务的制定类似，有没有那味了？）</li>
<li><strong>考虑问题要全面。</strong>这个是在学习红黑树删除时意识到的，网上将删除只是列举了几种情况，但是不说情况的来由或者没有详细说，导致自己看的很迷惑。所以在遇到类似的问题时，可以通过穷举法列举出所有的可能，再逐一去排除这些可能，或者将这些可能中的几种整合到一起。达到最后融会贯通的目的。</li>
</ul>
<p>​    感觉写了很多东西，但是回头看并没有多少字。千言万语仿佛吐不出来，还是自己写作的水平需要提高啊。记录一下，给后来的自己提个醒。</p>
<p>​    就这样吧，结束。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E5%BF%83%E5%BE%97/%E8%AE%B0%E6%9C%80%E8%BF%91%E4%B8%80%E6%AE%B5%E6%97%B6%E9%97%B4%E7%9A%84%E5%AD%A6%E4%B9%A0/" data-id="ckupl1rre001h6rupg4jd6y02" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-qq1162210866.github.io/博客/心得/记最近的一次工作中遇到的困惑" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E5%BF%83%E5%BE%97/%E8%AE%B0%E6%9C%80%E8%BF%91%E7%9A%84%E4%B8%80%E6%AC%A1%E5%B7%A5%E4%BD%9C%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E5%9B%B0%E6%83%91/" class="article-date">
  <time datetime="2021-10-13T13:28:21.197Z" itemprop="datePublished">2021-10-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="记最近的一次工作中遇到的困惑"><a href="#记最近的一次工作中遇到的困惑" class="headerlink" title="记最近的一次工作中遇到的困惑"></a>记最近的一次工作中遇到的困惑</h2><p>​    在接近年底的时候，一般都没有什么重要的活了，今年不太一样，到了年底活还是比较多。我最开始以为这次的任务其他的没有什么不一样，如果是这样的话，我也不会写这一篇博客了，这次的任务中遇到的问题和一些事情改变了我的一些想法，有一些困惑和想法，不记录有些难受，也希望后面遇到类似的问题可以不再走弯路。先说说任务吧。</p>
<p>​    任务还是比较简单的，就是开发两个简单的平台，一个边缘端，一个中心端。边缘端相当于一个协议转换器，对一些设备的协议做转换，接收的数据存储和解析，然后上传到中心端。中心端类似于展示平台，对边缘端的数据收集和展示，同时也有着边缘端的设备信息的维护。很简单的两个小平台。但是我也没有想到就是这两个平台在后面对我造成的困惑比之前做过的许多东西都多。慢慢说吧。</p>
<p>​    边缘端的开发比较简单，就是利用netty开发一个协议转换器，同时编写http接口，完成设备信息从中心端下发到边缘端。需要注意的就是设备可能存在多个，需要维护多种类型和多种协议的设备。</p>
<p>​    中心端目前相对于边缘端还要简单一些，就是几种设备的简单的增删改查，还有就是通过OpenFeign集成了接口的调用，还是简单的数据的展示。</p>
<p>​    整体功能也比较简单，甚至没有什么难点。但是中间边缘端我是一直在卡着，不知道怎么下手，曾经一度想要将项目重写，编写功能的时候也不知道如何开始，抓不到头。感觉陷入了一个非常奇怪的圈：想要抓住一个头进行开发，但是不知道从哪里进行开发，又陷入了无限的思考中，去想各个细节，但是随着花费时间过多，又想要赶紧有产出，就又开始想要抓住一个头进行开发，就是这样的一个圈。</p>
<p>​    下面说一下自己的感受。感觉还是自己编写代码太少，虽然毕业已经快两年了，但是除去耽误的时间，实际用来编写代码的时间太少了，还是自己的能力不足，没有能力去尝试搭建起一个项目，项目中需要考虑的很多东西都没有遇到过，也没有良好的解决方法。让我这样的人去解决一个困难和协议我可能做起来比较轻松，但是如果要让我去想一个系统的架构或者去想一种思路去解决一类问题就有些吃力。遇到的场景和编写的代码太少导致这个现象。</p>
<p>​    还有就是开发过程中的一些状态不太对劲。作为开发，需求的变更和前期收集资料不全这些情况应该是被考虑在内的，不应该因为这些客观原因导致后面系统的变更太过于频繁和不确定性。应该在初期或多或少考虑到这些问题，然后在开发中对这些情况进行预留处理或者找到改动较小的办法。中间我的状态很差，一度怀疑是自己的问题，怀疑自己并不是适合干这一行，然后也对自己的身体状态产生了怀疑，怀疑自己的注意力无法集中，无法再去思考问题。这种情况很危险，至少我事后回想是很危险的，工作上的任何事情都不应该归结到自己的身上，要始终记得，工作只是人生中的一段经历，不是自己不适合工作，而是没有找到适合自己的工作。所以也就有了编写这篇博客的欲望，记录一下这个特殊时期的自己。</p>
<p>​    然后就是工作中一些方法的总结，在开发过程中有一段时间一直在想如何去实现具体的功能，这些功能需要哪些基础，应该先写哪些地方。然后就是越想越多，越来越不知道如何编写。所以后面的感悟就是：当做一件不确定的事时，要让行动主导思维，不要让思维去主导行动，这样就会一直处在拖延中，无法找到目的和线头。只要确定了目的，就算一团乱麻，中间也会一个一个遇到你可能想到的任何问题。所以没必要让很多暂时没有遇到的问题成为你的第一块挡脚石。</p>
<p>​    下面就来总结一下自己的收获。</p>
<p>1.<strong>没有具体的能力时，做相应的事情是较困难的，但是过去后会发现自己的思维不一样了</strong></p>
<p>2.<strong>开发中的不确定性和调研不稳定性是正常的，不要抱怨，只有经历的多了才会考虑到这些</strong></p>
<p>3.<strong>永远不要将工作的不顺利归结到自己身上，没有不适合的人，只有不适合的工作</strong></p>
<p>4.<strong>当做的是一件不确定和无从下手的事时，要让行动主导思维，不要让思维主导行动，某些情况下考虑的越多越是无用</strong></p>
<p>5.<strong>对自己的困惑和迷茫要多总结，生活和工作不能迷迷糊糊就过去</strong></p>
<p>​    记录这些作为对自己的一个提示和警醒。</p>
<p>​    就这样吧，结束。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E5%BF%83%E5%BE%97/%E8%AE%B0%E6%9C%80%E8%BF%91%E7%9A%84%E4%B8%80%E6%AC%A1%E5%B7%A5%E4%BD%9C%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E5%9B%B0%E6%83%91/" data-id="ckupl1rrf001i6rupdn5se05e" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/3/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/test/" rel="tag">test</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/test/" style="font-size: 10px;">test</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%95%B0%E6%8D%AE%E4%BD%8D%E5%AD%A6%E4%B9%A0/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%9D%82%E9%A1%B9/%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E8%AE%B0%E5%BD%95/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/10/13/qq1162210866.github.io/%E5%8D%9A%E5%AE%A2/%E6%9D%82%E9%A1%B9/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>