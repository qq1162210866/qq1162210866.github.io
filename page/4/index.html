<!DOCTYPE html>


<html lang="en">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> Hexo</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css"
      />
      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      
<section class="cover">
    
      
      <a class="forkMe" href="https://github.com/Shen-Yu/hexo-theme-ayer"
        target="_blank"><img width="149" height="149" src="/images/forkme.png"
          class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover1.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">Hexo</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['面朝大海，春暖花开', '愿你一生努力，一生被爱', '想要的都拥有，得不到的都释怀'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  <ul class="ads">
    
        <li>
            <a target="_blank" rel="noopener" href="https://curl.qcloud.com/kvO7hb43">
                <img src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/ten_1.jpg" width="300" alt="云服务器限时秒杀">
            </a>
        </li>
    
        <li>
            <a target="_blank" rel="noopener" href="https://www.vultr.com/?ref=8630075">
                <img src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/vultr.png" width="300" alt="vultr优惠vps">
            </a>
        </li>
    
</ul>
  
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-杂项/代码整洁记录"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
     
    <div class="article-meta">
      <a href="/2021/10/14/%E6%9D%82%E9%A1%B9/%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E8%AE%B0%E5%BD%95/" class="article-date">
  <time datetime="2021-10-14T10:09:31.648Z" itemprop="datePublished">2021-10-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9D%82%E9%A1%B9/">杂项</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="代码整洁记录"><a href="#代码整洁记录" class="headerlink" title="代码整洁记录"></a>代码整洁记录</h2><h3 id="对于命名的规定"><a href="#对于命名的规定" class="headerlink" title="对于命名的规定"></a>对于命名的规定</h3><ul>
<li>对于变量和方法的名称，应该尽量降低这些名称的模糊度。<code>gameBoad</code>要比<code>theList</code>好的太多</li>
</ul>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20201126140253927.png" alt="image-20201126140253927"></p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20201126140333426.png" alt="image-20201126140333426"></p>
<ul>
<li>要使起的名称有意义，减少名称中的废话，例如<code>nameString</code>,<code>getActiveAccount()</code>,<code>getActiveAccountInof()</code>.</li>
<li>使用正确的单词或者名称，不要自己造一些只有自己能够理解的单词或者名称。例如:<code>genymdhms</code>.</li>
<li>是自己的名称能够文件中直接搜索到，不要搜索变量名时出来大量不符合的匹配项，长名称要比短名称好）（不废话的名称）<code>e</code>就是个错误示例。</li>
<li>不要在代码中做思维映射，即使阅读的人知道这段代码的意思。例如<code>for(int i = o;i&lt;sum;i++)</code>有些情况可以使用，但是会导致阅读代码的人做无谓的思维映射。</li>
<li>类的名称最好为名词或者名词短语，方法名最好为动词或者动词短语。</li>
<li>同一个概念最好用同一个词，例如获取就用<code>get</code>,不要多个词语表达同一个概念。</li>
</ul>
<h3 id="函数部分"><a href="#函数部分" class="headerlink" title="函数部分"></a>函数部分</h3><ul>
<li>函数应该尽可能的短小，越短越好。</li>
<li>if、else、while里面的代码块应该只有一行，就是函数的调用，这样不仅可以使代码更加清晰也可以使函数保持短小。</li>
<li>函数应该就只做一件事，做好这件事就可以了。该函数只做与该函数名同一层级下的抽象层的步骤，比较绕口，简单举个例子。</li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-杂项/正则表达式"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
     
    <div class="article-meta">
      <a href="/2021/10/14/%E6%9D%82%E9%A1%B9/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" class="article-date">
  <time datetime="2021-10-14T10:09:31.648Z" itemprop="datePublished">2021-10-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9D%82%E9%A1%B9/">杂项</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h2><h3 id="字符语法"><a href="#字符语法" class="headerlink" title="字符语法"></a>字符语法</h3><ul>
<li><code>[ABC]</code>：匹配括号内的字符。例如： <strong>[aeiou]</strong> 匹配字符串 “google runoob taobao” 中所有的 e o u a 字母。</li>
<li><code>[^ABC]</code>：匹配除括号内的字符。例如： <strong>[^aeiou]</strong> 匹配字符串 “google runoob taobao” 中除了 e o u a 字母的所有字母。</li>
<li><code>[A-Z]</code>：匹配A到Z的所有字符。例如：<code>[a-z]</code>匹配所有的小写字母。</li>
<li><code>.</code>:匹配除换行符（\n、\r）之外的任何单个字符。</li>
<li><code>[\s\S]</code>:匹配所有。\s 是匹配所有空白符，包括换行，\S 非空白符，不包括换行。</li>
<li><code>\w</code>:匹配字母、数字、下划线。等价于 [A-Za-z0-9_]。</li>
</ul>
<h3 id="非打印字符"><a href="#非打印字符" class="headerlink" title="非打印字符"></a>非打印字符</h3><p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210528211629833.png" alt="image-20210528211629833"></p>
<h3 id="特殊字符"><a href="#特殊字符" class="headerlink" title="特殊字符"></a>特殊字符</h3><p>匹配特殊字符时需要在前面添加转义字符\，即 <strong>runo*ob</strong> 匹配字符串 <strong>runo*ob</strong>。</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210528211942426.png" alt="image-20210528211942426"></p>
<h3 id="限定符"><a href="#限定符" class="headerlink" title="限定符"></a>限定符</h3><p>​    各种符号之间有重复，但是意思没有歧义。</p>
<p>​    限定符用来指定正则表达式的一个给定组件必须要出现多少次才能满足匹配。限定符出现在范围表达式之后，因此，它应用于整个范围表达式，就是应用于前面的范围表达式。</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210528212220698.png" alt="image-20210528212220698"></p>
<h3 id="定位符"><a href="#定位符" class="headerlink" title="定位符"></a>定位符</h3><p>​    定位符使您能够将正则表达式固定到行首或行尾。它们还使您能够创建这样的正则表达式，这些正则表达式出现在一个单词内、在一个单词的开头或者一个单词的结尾。</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210528214324071.png" alt="image-20210528214324071"></p>
<h3 id="选择（了解）"><a href="#选择（了解）" class="headerlink" title="选择（了解）"></a>选择（了解）</h3><p>​    用圆括号 <strong>()</strong> 将所有选择项括起来，相邻的选择项之间用 <strong>|</strong> 分隔。</p>
<p>​    <strong>()</strong> 表示捕获分组，**()** 会把每个分组里的匹配的值保存起来， 多个匹配值可以通过数字 n 来查看(<strong>n</strong> 是一个数字，表示第 n 个捕获组的内容)。</p>
<p>​    对一个正则表达式模式或部分模式两边添加圆括号将导致相关匹配存储到一个临时缓冲区中，所捕获的每个子匹配都按照在正则表达式模式中从左到右出现的顺序存储。缓冲区编号从 1 开始，最多可存储 99 个捕获的子表达式。每个缓冲区都可以使用 <strong>\n</strong> 访问，其中 n 为一个标识特定缓冲区的一位或两位十进制数。</p>
<h3 id="修饰符"><a href="#修饰符" class="headerlink" title="修饰符"></a>修饰符</h3><p>​    标记也称为修饰符，正则表达式的标记用于指定额外的匹配策略。一般是在正则表达式的两侧。</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210529151941439.png" alt="image-20210529151941439"></p>
<p><code>^[-]?[0-9]?[0-9]*(\.[0-9]+)?$</code>匹配浮点数（不是很完善，其实有一部分的漏洞）</p>
<p>匹配邮箱正则表达式的解析</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210529155625846.png" alt="image-20210529155625846"></p>
<h3 id="注意的点"><a href="#注意的点" class="headerlink" title="注意的点"></a>注意的点</h3><ul>
<li>[]里面的似乎不需要转义字符。</li>
<li></li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-框架/Mybatis相关知识点"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
     
    <div class="article-meta">
      <a href="/2021/10/14/%E6%A1%86%E6%9E%B6/Mybatis%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9/" class="article-date">
  <time datetime="2021-10-14T10:09:31.648Z" itemprop="datePublished">2021-10-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%A1%86%E6%9E%B6/">框架</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="MyBatis"><a href="#MyBatis" class="headerlink" title="MyBatis"></a>MyBatis</h2><h3 id="ORM框架"><a href="#ORM框架" class="headerlink" title="ORM框架"></a>ORM框架</h3><p>​    对象-关系映射（Object-Relational Mapping，简称ORM），面向对象的开发方法是当今企业级应用开发环境中的主流开发方法，关系数据库是企业级应用环境中永久存放数据的主流数据存储系统。对象和关系数据是业务实体的两种表现形式，业务实体在内存中表现为对象，在数据库中表现为关系数据。内存中的对象之间存在关联和继承关系，而在数据库中，关系数据无法直接表达多对多关联和继承关系。因此，对象-关系映射(ORM)系统一般以中间件的形式存在，主要实现程序对象到关系数据库数据的映射。</p>
<p>​    MySQL中存储的是关系型数据，但是项目中使用的是对象型数据。ORM框架就是这两种数据的中间层，将两种数据进行转换。这也是它要做的事。</p>
<h4 id="Hibernate"><a href="#Hibernate" class="headerlink" title="Hibernate"></a>Hibernate</h4><p>​    Hibernate 框架是一个全表映射的框架。通常开发者只要定义好持久化对象到数据库表的映射关系，就可以通过 Hibernate 框架提供的方法完成持久层操作。</p>
<p>​    相较于MyBatis，Hibernate是全自动的ORM框架，有它的优点：开发效率快，不需要开发人员懂SQL。但是也有着缺点：对于多表联合复杂查询支持较差，很难对SQL进行优化，更新的时候需要传全部的字段。</p>
<h4 id="MyBatis-1"><a href="#MyBatis-1" class="headerlink" title="MyBatis"></a>MyBatis</h4><p>​    MyBatis 框架是一个半自动映射的框架。这里所谓的“半自动”是相对于 Hibernate 框架全表映射而言的，MyBatis 框架需要手动匹配提供 POJO、SQL 和映射关系，而 Hibernate 框架只需提供 POJO 和映射关系即可。</p>
<p>​    缺点：需要写SQL，开发效率相对于Hibernate较慢。对于互联网来说，SQL的执行效率需要优化，同时查询的复杂度也比较高。MyBatis就成了互联网行业比较好的选择。</p>
<h3 id="Spring连接JDBC的基本步骤"><a href="#Spring连接JDBC的基本步骤" class="headerlink" title="Spring连接JDBC的基本步骤"></a>Spring连接JDBC的基本步骤</h3><p>​    因为JDBC是面向接口编程，所以很多的驱动厂商已经写好了。只需要加载对应的驱动，就可以获取对应的数据库连接。Sping中是通过DataSource来获取数据库连接的。但是spring没有局限于此，又提供了JdbcTemplate这么一个类给我们使用！它封装了DataSource，也就是说我们可以在Dao中使用JdbcTemplate就行了。JdbcTemplate返回的是map，它并不知道我们需要的是什么类型的数据。</p>
<h3 id="MyBatis流程"><a href="#MyBatis流程" class="headerlink" title="MyBatis流程"></a>MyBatis流程</h3><p>​    工作原理图：</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210622110302194.png" alt="image-20210622110302194"></p>
<p>​    读取mybatisxml配置文件，读取数据库信息和mybatis设置信息。然后再读取映射xml文件。再通过Configuration对象构建SqlSessionFactory，再通过SqlSessionFactory创建SqlSession 对象，该对象中包含了执行 SQL 语句的所有方法。需要查询时，通过Executor 执行器，它将根据 SqlSession 传递的参数动态地生成需要执行的 SQL 语句，同时负责查询缓存的维护。从数据库中查询出数据后，再通过MappedStatement对象将数据进行封装，该对象是对映射信息的封装，用于存储要映射的 SQL 语句的 id、参数等信息。    </p>
<ul>
<li>建造者模式是日常开发中比较常见的设计模式，它的主要作用就是将复杂事物创建的过程抽象出来，该抽象的不同实现方式不同，创建出的对象也不同。通俗的讲，创建一个对象一般都会有一个固定的步骤，这个固定的步骤我们把它抽象出来，每个抽象步骤都会有不同的实现方式，不同的实现方式创建出的对象也将不同。</li>
</ul>
<h3 id="Mybatis中的执行器（Executor）"><a href="#Mybatis中的执行器（Executor）" class="headerlink" title="Mybatis中的执行器（Executor）"></a>Mybatis中的执行器（Executor）</h3><p>​    Mybatis有三种基本的Executor执行器，SimpleExecutor、ReuseExecutor、BatchExecutor。</p>
<ul>
<li>SimpleExecutor：每执行一次update或select，就开启一个Statement对象，用完立刻关闭Statement对象。</li>
<li>ReuseExecutor：执行update或select，以sql作为key查找Statement对象，存在就使用，不存在就创建，用完后，不关闭Statement对象，而是放置于Map&lt;String, Statement&gt;内，供下一次使用。简言之，就是重复使用Statement对象。</li>
<li>BatchExecutor：执行update（没有select，JDBC批处理不支持select），将所有sql都添加到批处理中（addBatch()），等待统一执行（executeBatch()），它缓存了多个Statement对象，每个Statement对象都是addBatch()完毕后，等待逐一执行executeBatch()批处理。与JDBC批处理相同。</li>
</ul>
<h3 id="延迟加载"><a href="#延迟加载" class="headerlink" title="延迟加载"></a>延迟加载</h3><p>​    延迟加载就是在查询一对多关系时，延迟加载一所对应的表中的信息，只有在需要一的信息时，才回去执行SQL查询一的信息。</p>
<p>​    它的原理是，使用CGLIB创建目标对象的代理对象，当调用目标方法时，进入拦截器方法，比如调用a.getB().getName()，拦截器invoke()方法发现a.getB()是null值，那么就会单独发送事先保存好的查询关联B对象的sql，把B查询上来，然后调用a.setB(b)，于是a的对象b属性就有值了，接着完成a.getB().getName()方法的调用。这就是延迟加载的基本原理。</p>
<h3 id="Mybatis如何将xml文件映射为对象"><a href="#Mybatis如何将xml文件映射为对象" class="headerlink" title="Mybatis如何将xml文件映射为对象"></a>Mybatis如何将xml文件映射为对象</h3><p>​    通过mybatis的配置信息生成一个Configuration实例，然后Configuration实例读取mapper文件，来源分为xml文件和java注解。将SQL信息解析为MappedStatement对象，这个对象包含了传入参数映射配置、执行的SQL语句、结果映射配置。用户如果想要调用一条请求时，Mybatis会根据SQL的ID找到对应的MappedStatement对象，然后将请求的参数传入，得到解析后的SQL，拿着这条SQL在数据库中执行，得到结果后，将结果按照配置的映射关系转换，转换成java对象，完成一次请求。</p>
<p>​    Dao接口，就是人们常说的Mapper接口，接口的全限名，就是映射文件中的namespace的值，接口的方法名，就是映射文件中MappedStatement的id值，接口方法内的参数，就是传递给sql的参数。Mapper接口是没有实现类的，当调用接口方法时，接口全限名+方法名拼接字符串作为key值，可唯一定位一个MappedStatement，举例：com.mybatis3.mappers.StudentDao.findStudentById，可以唯一找到namespace为com.mybatis3.mappers.StudentDao下面id = findStudentById的MappedStatement。在Mybatis中，每一个<select>、<insert>、<update>、<delete>标签，都会被解析为一个MappedStatement对象。</p>
<p>Dao接口里的方法，是不能重载的，因为是全限名+方法名的保存和寻找策略。</p>
<p>Dao接口的工作原理是JDK动态代理，Mybatis运行时会使用JDK动态代理为Dao接口生成代理proxy对象，代理对象proxy会拦截接口方法，转而执行MappedStatement所代表的sql，然后将sql执行结果返回。</p>
<h3 id="和-的区别，和原理"><a href="#和-的区别，和原理" class="headerlink" title="#和$的区别，和原理"></a>#和$的区别，和原理</h3><p>#{}是占位符，预编译处理；${}是拼接符，字符串替换，没有预编译处理。#{} 可以有效的防止SQL注入，提高系统安全性；${} 不能防止SQL 注入</p>
<p>Mybatis在处理#{}时，#{}传入参数是以字符串传入，会将SQL中的#{}替换为?号，调用PreparedStatement的set方法来赋值。</p>
<p>Mybatis在处理${}时，是原值传入，就是把${}替换成变量的值，相当于JDBC中的Statement编译。</p>
<p>变量替换后，#{} 对应的变量自动加上单引号 ‘’；变量替换后，${} 对应的变量不会加上单引号 ‘’</p>
<h3 id="Mybatis中的一级缓存和二级缓存"><a href="#Mybatis中的一级缓存和二级缓存" class="headerlink" title="Mybatis中的一级缓存和二级缓存"></a>Mybatis中的一级缓存和二级缓存</h3><p>​    每个SqlSession中持有了Executor，每个Executor中有一个LocalCache。当用户发起查询时，MyBatis根据当前执行的语句生成MappedStatement，在Local Cache进行查询，如果缓存命中的话，直接返回结果给用户，如果缓存没有命中的话，查询数据库，结果写入Local Cache，最后返回结果给用户。</p>
<p>默认的是一级缓存，通过设置Mybatis的配置文件即可。共有两个选项，<code>SESSION</code>或者<code>STATEMENT</code>，默认是<code>SESSION</code>级别，即在一个MyBatis会话中执行的所有语句，都会共享这一个缓存。一种是<code>STATEMENT</code>级别，可以理解为缓存只对当前执行的这一个<code>Statement</code>有效。建议配置成STATEMENT级别。</p>
<p>​    在同一个方法里面，两个不同的SqlSession分别执行查询和修改，可能会造成脏读的情况。</p>
<p>注意：</p>
<ul>
<li>MyBatis一级缓存的生命周期和SqlSession一致。</li>
<li>MyBatis一级缓存内部设计简单，只是一个没有容量限定的HashMap，在缓存的功能性上有所欠缺。</li>
<li>MyBatis的一级缓存最大范围是SqlSession内部，有多个SqlSession或者分布式的环境下，数据库写操作会引起脏数据，建议设定缓存级别为Statement。</li>
</ul>
<p>​    如果多个SqlSession之间需要共享缓存，则需要使用到二级缓存。开启二级缓存后，会使用CachingExecutor装饰Executor，进入一级缓存的查询流程前，先在CachingExecutor进行二级缓存的查询二级缓存开启后，同一个namespace下的所有操作语句，都影响着同一个Cache，即二级缓存被多个SqlSession共享，是一个全局的变量。</p>
<p>当开启缓存后，数据的查询执行的流程就是 二级缓存 -&gt; 一级缓存 -&gt; 数据库。</p>
<p>注意：</p>
<ul>
<li>MyBatis的二级缓存相对于一级缓存来说，实现了<code>SqlSession</code>之间缓存数据的共享，同时粒度更加的细，能够到<code>namespace</code>级别，通过Cache接口实现类不同的组合，对Cache的可控性也更强。</li>
<li>MyBatis在多表查询时，极大可能会出现脏数据，有设计上的缺陷，安全使用二级缓存的条件比较苛刻。</li>
<li>在分布式环境下，由于默认的MyBatis Cache实现都是基于本地的，分布式环境下必然会出现读取到脏数据，需要使用集中式缓存将MyBatis的Cache接口实现，有一定的开发成本，直接使用Redis、Memcached等分布式缓存可能成本更低，安全性也更高。</li>
</ul>
<h3 id="Mybatis的核心组件"><a href="#Mybatis的核心组件" class="headerlink" title="Mybatis的核心组件"></a>Mybatis的核心组件</h3><h4 id="SqlSessionFactory"><a href="#SqlSessionFactory" class="headerlink" title="SqlSessionFactory"></a>SqlSessionFactory</h4><p>​    SqlSessionFactory是一个接口，主要的作用就是初始化Mybatis框架和提供SqlSession对象。实现类主要有两个：一个是 SqlSessionManager 类，一个是 DefaultSqlSessionFactory 类。</p>
<ul>
<li>DefaultSqlSessionFactory : SqlSessionFactory 的默认实现类，是真正生产会话的工厂类，这个类的实例的生命周期是全局的，它只会在首次调用时生成一个实例（单例模式），就一直存在直到服务器关闭。</li>
<li>SqlSessionManager ： 已被废弃，原因大概是: SqlSessionManager 中需要维护一个自己的线程池，而使用MyBatis 更多的是要与 Spring 进行集成，并不会单独使用，所以维护自己的 ThreadLocal 并没有什么意义，所以 SqlSessionManager 已经不再使用。</li>
</ul>
<p>​    流程就是：SqlSessionFactoryBuilder根据Mybatis配置的xml文件通过建造者模式的设计思想构建一个SqlSessionFactory对象。解析完成后返回一个 <code>DefaultSqlSessionFactory</code>对象，它是 SqlSessionFactory 的默认实现类。</p>
<h4 id="SqlSession"><a href="#SqlSession" class="headerlink" title="SqlSession"></a>SqlSession</h4><p>​    SqlSessionFactory.openSession 过程中我们可以看到，会调用到 DefaultSqlSessionFactory 中的 openSessionFromDataSource 方法，这个方法主要创建了两个与我们分析执行流程重要的对象，一个是 Executor 执行器对象，一个是 SqlSession 对象。</p>
<p>​    SqlSession 对象是 MyBatis 中最重要的一个对象，这个接口能够让你执行命令，获取映射，管理事务。SqlSession 中定义了一系列模版方法，让你能够执行简单的 CRUD 操作，也可以通过 getMapper 获取 Mapper 层，执行自定义 SQL 语句，因为 SqlSession 在执行 SQL 语句之前是需要先开启一个会话，涉及到事务操作，所以还会有 commit、 rollback、close 等方法。这也是模版设计模式的一种应用。</p>
<h4 id="Executor"><a href="#Executor" class="headerlink" title="Executor"></a>Executor</h4><p>​    每一个 SqlSession 都会拥有一个 Executor 对象，这个对象负责增删改查的具体操作，我们可以简单的将它理解为 JDBC 中 Statement 的封装版。 也可以理解为 SQL 的执行引擎，要干活总得有一个发起人吧，可以把 Executor 理解为发起人的角色。</p>
<p>​    Executor 执行器，它有两个实现类，分别是BaseExecutor和 CachingExecutor。</p>
<h4 id="StatementHandler"><a href="#StatementHandler" class="headerlink" title="StatementHandler"></a>StatementHandler</h4><p>​    <code>StatementHandler</code> 是四大组件中最重要的一个对象，负责操作 Statement 对象与数据库进行交互，在工作时还会使用 <code>ParameterHandler</code> 和 <code>ResultSetHandler</code>对参数进行映射，对结果进行实体类的绑定。</p>
<h3 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h3><p>//ORM框架</p>
<p>//Spring连接JDBC的过程和步骤</p>
<p>//MyBatis如何将xml映射为对象</p>
<p>//statement是什么</p>
<p>​    Statement对象表示一个原始语句，其中将单个方法应用于目标和一组参数</p>
<p>//#和$的区别，和原理</p>
<p>//延迟加载</p>
<p>//一级缓存和二级缓存</p>
<p>//Mybatis的四个核心组件</p>
<p>//Mybatis中的执行器（Executor）</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-计算机基础/计算机基础"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
     
    <div class="article-meta">
      <a href="/2021/10/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" class="article-date">
  <time datetime="2021-10-14T10:09:31.648Z" itemprop="datePublished">2021-10-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/">计算机基础</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="计算机基础"><a href="#计算机基础" class="headerlink" title="计算机基础"></a>计算机基础</h2><h3 id="计算机原理"><a href="#计算机原理" class="headerlink" title="计算机原理"></a>计算机原理</h3><h4 id="进程和线程的区别"><a href="#进程和线程的区别" class="headerlink" title="进程和线程的区别"></a>进程和线程的区别</h4><p>进程和线程的主要差别在于它们是不同的操作系统资源管理方式。进程有独立的地址空间，一个进程崩溃后，在保护模式下不会对其它进程产生影响，而线程只是一个进程中的不同执行路径。线程有自己的堆栈和局部变量，但线程之间没有单独的地址空间，一个线程死掉就等于整个进程死掉，所以多进程的程序要比多线程的程序健壮，但在进程切换时，耗费资源较大，效率要差一些。但对于一些要求同时进行并且又要共享某些变量的并发操作，只能用线程，不能用进程。</p>
<h3 id="计算机网络"><a href="#计算机网络" class="headerlink" title="计算机网络"></a>计算机网络</h3><h4 id="计算机网络层次"><a href="#计算机网络层次" class="headerlink" title="计算机网络层次"></a>计算机网络层次</h4><p>​    现在市面上大概有三种网络体系结构。</p>
<ul>
<li>OSI的七层协议体系结构，包含：应用层、表示层、会话层、运输层、网络层、数据链路层、物理层。但是因为太过于理论，所以没有得到广泛应用。</li>
<li>TCP/IP体系结构，包含:应用层、运输层、网际层、网络接口层。该理论得到了广泛的应用。</li>
<li>五层协议体系结构，包含：应用层、运输层、网络层、数据链路层、物理层。是将上面两种体系结合起来的一种结构，学习起来比较适合。</li>
</ul>
<p>应用层：应用层是直接为用户的进程提供服务。该层的协议也比较多：HTTP、FTP、SMTP等</p>
<p>运输层：运输层的任务就是负责向两个主机中的进程提供通信服务。分为分用（分别交付信息）和复用（多个进程同时使用服务）。协议有：TCP、UDP</p>
<p>网络层：网络层负责为交换网上的主机提供通信服务。协议为IP协议。</p>
<p>数据链路层：数据链路层将网络层交下来的数据报组装成帧，在两个相邻的节点间的链路上透明的传输帧，帧中包含数据和必要的控制信息。（两个相邻的节点例如两个路由器）</p>
<p>物理层：物理层的任务就是透明的传输比特（就是0和1）。</p>
<h4 id="TCP三次握手和四次挥手"><a href="#TCP三次握手和四次挥手" class="headerlink" title="TCP三次握手和四次挥手"></a>TCP三次握手和四次挥手</h4><h5 id="三次握手"><a href="#三次握手" class="headerlink" title="三次握手"></a>三次握手</h5><ul>
<li>TCP服务器进程先创建传输控制块TCB，时刻准备接受客户进程的连接请求，此时服务器就进入了LISTEN（监听）状态；</li>
<li>TCP客户进程也是先创建传输控制块TCB，然后向服务器发出连接请求报文，这是报文首部中的同部位SYN=1，同时选择一个初始序列号 seq=x ，此时，TCP客户端进程进入了 SYN-SENT（同步已发送状态）状态。TCP规定，SYN报文段（SYN=1的报文段）不能携带数据，但需要消耗掉一个序号。</li>
<li>TCP服务器收到请求报文后，如果同意连接，则发出确认报文。确认报文中应该 ACK=1，SYN=1，确认号是ack=x+1，同时也要为自己初始化一个序列号 seq=y，此时，TCP服务器进程进入了SYN-RCVD（同步收到）状态。这个报文也不能携带数据，但是同样要消耗一个序号。</li>
<li>TCP客户进程收到确认后，还要向服务器给出确认。确认报文的ACK=1，ack=y+1，自己的序列号seq=x+1，此时，TCP连接建立，客户端进入ESTABLISHED（已建立连接）状态。TCP规定，ACK报文段可以携带数据，但是如果不携带数据则不消耗序号。</li>
<li>当服务器收到客户端的确认后也进入ESTABLISHED状态，此后双方就可以开始通信了。</li>
</ul>
<p>为什么要再发送最后一次报文？一句话，主要防止已经失效的连接请求报文突然又传送到了服务器，从而产生错误。</p>
<h5 id="四次挥手"><a href="#四次挥手" class="headerlink" title="四次挥手"></a>四次挥手</h5><ul>
<li>客户端进程发出连接释放报文，并且停止发送数据。释放数据报文首部，FIN=1，其序列号为seq=u（等于前面已经传送过来的数据的最后一个字节的序号加1），此时，客户端进入FIN-WAIT-1（终止等待1）状态。 TCP规定，FIN报文段即使不携带数据，也要消耗一个序号。</li>
<li>服务器收到连接释放报文，发出确认报文，ACK=1，ack=u+1，并且带上自己的序列号seq=v，此时，服务端就进入了CLOSE-WAIT（关闭等待）状态。TCP服务器通知高层的应用进程，客户端向服务器的方向就释放了，这时候处于半关闭状态，即客户端已经没有数据要发送了，但是服务器若发送数据，客户端依然要接受。这个状态还要持续一段时间，也就是整个CLOSE-WAIT状态持续的时间。</li>
<li>客户端收到服务器的确认请求后，此时，客户端就进入FIN-WAIT-2（终止等待2）状态，等待服务器发送连接释放报文（在这之前还需要接受服务器发送的最后的数据）。</li>
<li>服务器将最后的数据发送完毕后，就向客户端发送连接释放报文，FIN=1，ack=u+1，由于在半关闭状态，服务器很可能又发送了一些数据，假定此时的序列号为seq=w，此时，服务器就进入了LAST-ACK（最后确认）状态，等待客户端的确认。</li>
<li>客户端收到服务器的连接释放报文后，必须发出确认，ACK=1，ack=w+1，而自己的序列号是seq=u+1，此时，客户端就进入了TIME-WAIT（时间等待）状态。注意此时TCP连接还没有释放，必须经过2 ∗ * ∗MSL（最长报文段寿命）的时间后，当客户端撤销相应的TCB后，才进入CLOSED状态。</li>
<li>服务器只要收到了客户端发出的确认，立即进入CLOSED状态。同样，撤销TCB后，就结束了这次的TCP连接。可以看到，服务器结束TCP连接的时间要比客户端早一些。</li>
</ul>
<p>为什么客户端最后还要等待2MSL？</p>
<p>​    第一，保证客户端发送的最后一个ACK报文能够到达服务器，因为这个ACK报文可能丢失。第二，防止类似与“三次握手”中提到了的“已经失效的连接请求报文段”出现在本连接中。</p>
<p>为什么建立连接是三次握手，关闭连接确是四次挥手呢？</p>
<p>​    三次握手是客户端主动连接，服务端可以将syn和ack放在一起发送出去。但是断开链接时，服务端这时可能还会有数据继续发送，所以会将ack和syn分别发送，所以就多了一次。</p>
<h4 id="Cookie和Session的区别"><a href="#Cookie和Session的区别" class="headerlink" title="Cookie和Session的区别"></a>Cookie和Session的区别</h4><p>HTTP Cookie（也叫 Web Cookie或浏览器 Cookie）是服务器发送到用户浏览器并保存在本地的一小块数据，它会在浏览器下次向同一服务器再发起请求时被携带并发送到服务器上。通常，它用于告知服务端两个请求是否来自同一浏览器，如保持用户的登录状态。Cookie 使基于无状态的 HTTP 协议记录稳定的状态信息成为了可能。</p>
<p>Session 代表着服务器和客户端一次会话的过程。Session 对象存储特定用户会话所需的属性及配置信息。这样，当用户在应用程序的 Web 页之间跳转时，存储在 Session 对象中的变量将不会丢失，而是在整个用户会话中一直存在下去。当客户端关闭会话，或者 Session 超时失效时会话结束。</p>
<p>不同点：</p>
<p>作用范围不同，Cookie 保存在客户端（浏览器），Session 保存在服务器端。<br>存取方式的不同，Cookie 只能保存 ASCII，Session 可以存任意数据类型，一般情况下我们可以在 Session 中保持一些常用变量信息，比如说 UserId 等。<br>有效期不同，Cookie 可设置为长时间保持，比如我们经常使用的默认登录功能，Session 一般失效时间较短，客户端关闭或者 Session 超时都会失效。<br>隐私策略不同，Cookie 存储在客户端，比较容易遭到不法获取，早期有人将用户的登录名和密码存储在 Cookie 中导致信息被窃取；Session 存储在服务端，安全性相对 Cookie 要好一些。<br>存储大小不同， 单个 Cookie 保存的数据不能超过 4K，Session 可存储数据远高于 Cookie。</p>
<h4 id="HTTP相关知识点"><a href="#HTTP相关知识点" class="headerlink" title="HTTP相关知识点"></a>HTTP相关知识点</h4><h5 id="HTTP中的方法"><a href="#HTTP中的方法" class="headerlink" title="HTTP中的方法"></a>HTTP中的方法</h5><ul>
<li>GET ：获取资源” “GET 方法用来请求访问已被 URI 识别的资源。指定的资源经服务器端解析后返回响应内容。也就是说，如果请求的资源是文本，那就保持原样返回；如果是像 CGI（Common Gateway Interface，通用网关接口）那样的程序，则返回经过执行后的输出结果。”</li>
<li>“POST：传输实体主体” “POST 方法用来传输实体的主体。”</li>
<li>PUT：传输文件 “PUT 方法用来传输文件。就像 FTP 协议的文件上传一样，要求在请求报文的主体中包含文件内容，然后保存到请求 URI 指定的位置。”</li>
<li>“HEAD：获得报文首部” “HEAD 方法和 GET 方法一样，只是不返回报文主体部分。用于确认 URI 的有效性及资源更新的日期时间等。”</li>
<li>DELETE：删除文件 “DELETE 方法用来删除文件，是与 PUT 相反的方法。DELETE 方法按请求 URI 删除指定的资源。”</li>
<li>“OPTIONS：询问支持的方法” “OPTIONS 方法用来查询针对请求 URI 指定的资源支持的方法。”</li>
<li>TRACE：追踪路径 “TRACE 方法是让 Web 服务器端将之前的请求通信环回给客户端的方法。”</li>
<li>“CONNECT：要求用隧道协议连接代理” “CONNECT 方法要求在与代理服务器通信时建立隧道，实现用隧道协议进行 TCP 通信。主要使用 SSL（Secure Sockets Layer，安全套接层）和 TLS（Transport Layer Security，传输层安全）协议把通信内容加 密后经网络隧道传输。”</li>
</ul>
<h5 id="报文首部结构"><a href="#报文首部结构" class="headerlink" title="报文首部结构"></a>报文首部结构</h5><ul>
<li>“请求行 包含用于请求的方法，请求 URI 和 HTTP 版本。</li>
<li>状态行 包含表明响应结果的状态码，原因短语和 HTTP 版本。</li>
<li>首部字段 包含表示请求和响应的各种条件和属性的各类首部。一般有 4 种首部，分别是：通用首部、请求首部、响应首部和实体首部。</li>
<li>其他 可能包含 HTTP 的 RFC 里未定义的首部（Cookie 等）。”</li>
</ul>
<h3 id="Linux面试相关点"><a href="#Linux面试相关点" class="headerlink" title="Linux面试相关点"></a>Linux面试相关点</h3><h4 id="ls命令"><a href="#ls命令" class="headerlink" title="ls命令"></a>ls命令</h4><p>示例：列出所有文件：ls -a</p>
<p>列出当前目录中所有以”t”开头的目录的详细内容: ls -l t*</p>
<h4 id="cd-命令"><a href="#cd-命令" class="headerlink" title="cd 命令"></a>cd 命令</h4><p>示例：进入上一次工作路径：cd -</p>
<h4 id="pwd-命令"><a href="#pwd-命令" class="headerlink" title="pwd 命令"></a>pwd 命令</h4><p>示例：查看当前路径： pwd</p>
<h4 id="mkdir-命令"><a href="#mkdir-命令" class="headerlink" title="mkdir 命令"></a>mkdir 命令</h4><p>示例：在 tmp 目录下创建路径为 test/t1/t 的目录，若不存在，则创建：mkdir -p /tmp/test/t1/t</p>
<h4 id="cat-命令"><a href="#cat-命令" class="headerlink" title="cat 命令"></a>cat 命令</h4><p>cat 主要有三大功能：1.一次显示整个文件:2.从键盘创建一个文件:3.将几个文件合并为一个文件:</p>
<p>示例：把 log2012.log 的文件内容加上行号后输入 log2013.log 这个文件里</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat -n log2012.log log2013.log</span><br></pre></td></tr></table></figure>

<h4 id="more-命令"><a href="#more-命令" class="headerlink" title="more 命令"></a>more 命令</h4><p>功能类似于 cat, more 会以一页一页的显示方便使用者逐页阅读，而最基本的指令就是按空白键（space）就往下一页显示，按 b 键就会往回（back）一页显示。</p>
<h4 id="less-命令"><a href="#less-命令" class="headerlink" title="less 命令"></a>less 命令</h4><p>less 与 more 类似，但使用 less 可以随意浏览文件，而 more 仅能向前移动，却不能向后移动，而且 less 在查看之前不会加载整个文件。</p>
<h4 id="head-命令"><a href="#head-命令" class="headerlink" title="head 命令"></a>head 命令</h4><p>head 用来显示档案的开头至标准输出中，默认 head 命令打印其相应文件的开头 10 行。</p>
<p>示例：显示 1.log 文件前 20 字节：head -c 20 log2014.log</p>
<h4 id="tail-命令"><a href="#tail-命令" class="headerlink" title="tail 命令"></a>tail 命令</h4><p>用于显示指定文件末尾内容，不指定文件时，作为输入信息进行处理。常用查看日志文件。</p>
<p>示例：循环读取逐渐增加的文件内容：tail -f ping.log</p>
<h4 id="which-命令"><a href="#which-命令" class="headerlink" title="which 命令"></a>which 命令</h4><p>which 是在 PATH 就是指定的路径中，搜索某个系统命令的位置，并返回第一个搜索结果。使用 which 命令，就可以看到某个系统命令是否存在，以及执行的到底是哪一个位置的命令。</p>
<p>示例：查看 ls 命令是否存在，执行哪个：which ls</p>
<h4 id="whereis-命令"><a href="#whereis-命令" class="headerlink" title="whereis 命令"></a>whereis 命令</h4><p>whereis 命令只能用于程序名的搜索，而且只搜索二进制文件（参数-b）、man说明文件（参数-m）和源代码文件（参数-s）。如果省略参数，则返回所有信息。whereis 及 locate 都是基于系统内建的数据库进行搜索，因此效率很高，而find则是遍历硬盘查找文件。</p>
<h4 id="locate-命令"><a href="#locate-命令" class="headerlink" title="locate 命令"></a>locate 命令</h4><p>locate 通过搜寻系统内建文档数据库达到快速找到档案，数据库由 updatedb 程序来更新，updatedb 是由 cron daemon 周期性调用的。默认情况下 locate 命令在搜寻数据库时比由整个由硬盘资料来搜寻资料来得快，但较差劲的是 locate 所找到的档案若是最近才建立或 刚更名的，可能会找不到，在内定值中，updatedb 每天会跑一次，可以由修改 crontab 来更新设定值 (etc/crontab)。</p>
<p>示例：查找和 pwd 相关的所有文件(文件名中包含 pwd）：locate pwd</p>
<h4 id="find-命令"><a href="#find-命令" class="headerlink" title="find 命令"></a>find 命令</h4><p>用于在文件树中查找文件，并作出相应的处理。</p>
<p>示例：在当前目录查找 以 .log 结尾的文件。 <strong>.</strong> 代表当前目录：find ./ -name ‘*.log’</p>
<h4 id="chmod-命令"><a href="#chmod-命令" class="headerlink" title="chmod 命令"></a>chmod 命令</h4><p>用于改变 linux 系统文件或目录的访问权限。用它控制文件或目录的访问权限。该命令有两种用法。一种是包含字母和操作符表达式的文字设定法；另一种是包含数字的数字设定法。</p>
<p>每一文件或目录的访问权限都有三组，每组用三位表示，分别为文件属主的读、写和执行权限；与属主同组的用户的读、写和执行权限；系统中其他用户的读、写和执行权限。</p>
<p>示例：增加文件 t.log 所有用户可执行权限：chmod a+x t.log</p>
<h4 id="df-命令"><a href="#df-命令" class="headerlink" title="df 命令"></a>df 命令</h4><p>显示磁盘空间使用情况。获取硬盘被占用了多少空间，目前还剩下多少空间等信息，如果没有文件名被指定，则所有当前被挂载的文件系统的可用空间将被显示。</p>
<p>示例：显示磁盘使用情况:df -l</p>
<h4 id="du-命令"><a href="#du-命令" class="headerlink" title="du 命令"></a>du 命令</h4><p>du 命令也是查看使用空间的，但是与 df 命令不同的是 Linux du 命令是对文件和目录磁盘使用的空间的查看：</p>
<p>示例：以易读方式显示文件夹内及子文件夹大小：du -h scf/</p>
<h4 id="grep-命令"><a href="#grep-命令" class="headerlink" title="grep 命令"></a>grep 命令</h4><p>强大的文本搜索命令，grep(Global Regular Expression Print) 全局正则表达式搜索。</p>
<p>grep 的工作方式是这样的，它在一个或多个文件中搜索字符串模板。如果模板包括空格，则必须被引用，模板后的所有字符串被看作文件名。搜索的结果被送到标准输出，不影响原文件内容。</p>
<p>示例：查找指定进程：ps -ef | grep svn</p>
<h4 id="ps-命令"><a href="#ps-命令" class="headerlink" title="ps 命令"></a>ps 命令</h4><p>ps(process status)，用来查看当前运行的进程状态，一次性查看，如果需要动态连续结果使用 top</p>
<p>示例：显示当前所有进程环境变量及进程间关系：ps -ef</p>
<h4 id="top-命令"><a href="#top-命令" class="headerlink" title="top 命令"></a>top 命令</h4><p>显示当前系统正在执行的进程的相关信息，包括进程 ID、内存占用率、CPU 占用率等</p>
<h4 id="Kill命令"><a href="#Kill命令" class="headerlink" title="Kill命令"></a>Kill命令</h4><p>发送指定的信号到相应进程。不指定型号将发送SIGTERM（15）终止指定进程。如果任无法终止该程序可用”-KILL” 参数，其发送的信号为SIGKILL(9) ，将强制结束进程，使用ps命令或者jobs 命令可以查看进程号。root用户将影响用户的进程，非root用户只能影响自己的进程。</p>
<p>示例：先使用ps查找进程pro1，然后用kill杀掉：kill -9 $(ps -ef | grep pro1)</p>
<h4 id="free-命令"><a href="#free-命令" class="headerlink" title="free 命令"></a>free 命令</h4><p>显示系统内存使用情况，包括物理内存、交互区内存(swap)和内核缓冲区内存。</p>
<p>示例：显示内存使用情况：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">free</span><br><span class="line">free -k</span><br><span class="line">free -m</span><br></pre></td></tr></table></figure>

<h4 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h4><p>如何查看端口号被哪个进程占用</p>
<p>lsof -i:端口号</p>
<p>netstat -tunpl | grep 端口号</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-计算机基础/计算机数据位学习"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
     
    <div class="article-meta">
      <a href="/2021/10/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%95%B0%E6%8D%AE%E4%BD%8D%E5%AD%A6%E4%B9%A0/" class="article-date">
  <time datetime="2021-10-14T10:09:31.648Z" itemprop="datePublished">2021-10-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/">计算机基础</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="计算机数据位学习"><a href="#计算机数据位学习" class="headerlink" title="计算机数据位学习"></a>计算机数据位学习</h2><ul>
<li><p>位：计算机存储和处理的信以二进制信号表示，这些二进制称为<code>位</code></p>
</li>
<li><p>三种数字表示。</p>
<ul>
<li>无符号：基于传统的二进制表示法，表示大于或者等于零的数字。</li>
<li>补码：补码编码是最常见的表示有符号的方式，表示为正或者为负的数字。</li>
<li>浮点数：浮点数编码是表示实数的科学记数法以二为基数的版本。</li>
</ul>
</li>
<li><p>大多数计算机使用8位的块，或者字节（byte）作为最小的可寻址的存储器单位，而不是存储器中的访问单独的位。</p>
</li>
<li><p>0x或者0X开头的数字一般表示十六进制的数字。</p>
</li>
<li><p>一个汉字=2字节（2byte）一个字节(1byte)=8位（8bit）1KB=1024Byte</p>
</li>
<li><p>byte是java的<strong>基本数据类型</strong>，存储整型数据，占据1个字节(8 bits)，能够存储的数据范围是-128～+127。</p>
<p>Byte是java.lang中的一个类，目的是为基本数据类型byte进行封装。</p>
</li>
</ul>
<p><em>在工作中遇到的数据的问题，也是就这个问题记录了一下，后面感觉计算机网络和计算机基础还是非常重要的，后面也会对这些知识慢慢补充。</em></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-计算机网络/计算机网络基础"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
     
    <div class="article-meta">
      <a href="/2021/10/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/" class="article-date">
  <time datetime="2021-10-14T10:09:31.648Z" itemprop="datePublished">2021-10-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="计算机网络基础"><a href="#计算机网络基础" class="headerlink" title="计算机网络基础"></a>计算机网络基础</h2><ul>
<li><p>目前流行的计算机网络的各层及其协议的集合（网络的体系结构）</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/IMG_0E4AB3775BF4-1.jpeg" alt="IMG_0E4AB3775BF4-1"></p>
<p>应用层：体系结构中最高层。</p>
<p>运输层：负责向两个主机中进程之间的通信提供服务。主要使用了TCP和UDP协议。</p>
<p>网络层：使用分组交换负责为网上不同的主机提供通信服务。</p>
<p>数据链路层：将网络层的数据组装成帧，在两个相邻节点之间传送数据。</p>
<p>物理层：负责透明的传送比特流。</p>
</li>
<li><p>当数据是由可打印的ASCII码组成的文本文件时，帧定界可以使用特殊的帧定界符。<code>SOH</code>开始帧、<code>EOT</code>结束帧。如果传输的数据存在帧定界符，通过转义字符<code>ESC</code>来区分数据和帧定界符。</p>
</li>
<li><p>循环冗余检验原理。<br><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/IMG_058CB781B01A-1.jpeg" alt="IMG_058CB781B01A-1"></p>
</li>
<li></li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-中间件/MySQL/MySQL相关知识点"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
     
    <div class="article-meta">
      <a href="/2021/10/14/%E4%B8%AD%E9%97%B4%E4%BB%B6/MySQL/MySQL%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9/" class="article-date">
  <time datetime="2021-10-14T10:09:31.648Z" itemprop="datePublished">2021-10-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a> / <a class="article-category-link" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/MySQL/">MySQL</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="MySQL知识点"><a href="#MySQL知识点" class="headerlink" title="MySQL知识点"></a>MySQL知识点</h1><h2 id="MySQL基础知识"><a href="#MySQL基础知识" class="headerlink" title="MySQL基础知识"></a>MySQL基础知识</h2><h3 id="MySQL查询流程"><a href="#MySQL查询流程" class="headerlink" title="MySQL查询流程"></a>MySQL查询流程</h3><p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210719230933044.png" alt="image-20210719230933044"></p>
<p>​    分为server层和存储层，innodb就是位于存储层，主要负责对于磁盘的读写。server层主要就是mysql的一些基础服务，以查询sql为例，先是连接器管理连接，然后分析器分析语法是否有错误，没有错误查询缓存，缓存不存在将sql优化，最后调用执行器查询结果。</p>
<h3 id="MySQL中锁的相关知识点"><a href="#MySQL中锁的相关知识点" class="headerlink" title="MySQL中锁的相关知识点"></a>MySQL中锁的相关知识点</h3><p>​    数据库中分为三种情况</p>
<p>​    读-读：没有对数据进行影响，不需要操作。</p>
<p>​    写-写：需要对操作加锁。</p>
<p>​    读-写：会出现脏读、幻读。所以要对写操作加锁。</p>
<ul>
<li>表级锁：开销小，加锁快。不会出现死锁，锁颗粒度大，也就导致发生冲突概率最高，并发度最低。</li>
<li>行级锁：开销大，加锁慢。会出现死锁，锁颗粒度小，锁的冲突比较低，并发度最高。</li>
<li>页面锁（BDB引擎）：开销介于表级锁和行级锁之间，会出现死锁，锁颗粒度一般，并发度一般。</li>
<li>共享锁(Shared Locks)：简称S锁，在事务要读取一条记录时，需要先获取该记录的S锁。S锁可以在同一时刻被多个事务同时持有。</li>
<li>排他锁(Exclusive Locks)：简称X锁，在事务要改动一条记录时，需要先获取该记录的X锁。X锁在同一时刻最多只能被一个事务持有。</li>
</ul>
<h4 id="表级锁"><a href="#表级锁" class="headerlink" title="表级锁"></a>表级锁</h4><ul>
<li><p>意向共享锁(IS锁)：当我们给一行数据加上共享锁之前，数据库会自动在这张表上面加一个意向共享锁(IS锁)，主要是快速查询表中记录有没有被上锁，提升效率。</p>
</li>
<li><p>意向排他锁(IX锁)：和上面的类似，只不过是排他锁。</p>
</li>
<li><p>自增锁(AUTO-INC锁)：在执行插入语句的时先加上表级别的AUTO-INC锁，插入执行完成后立即释放锁。无法确定插入多少记录时使用。</p>
</li>
<li><p>轻量级锁：在插入语句生成AUTO_INCREMENT值时先才获取这个轻量级锁，然后在AUTO_INCREMENT值生成之后就释放轻量级锁。确定插入多少列时使用。</p>
</li>
</ul>
<h4 id="行级锁"><a href="#行级锁" class="headerlink" title="行级锁"></a>行级锁</h4><p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210614213241155.png" alt="image-20210614213241155"></p>
<ul>
<li>记录锁(Record Locks) 所谓记录，就是指聚簇索引中真实存放的数据，比如上面的1、4、7、10都是记录。</li>
<li>间隙锁(Gap Locks) 间隙指的是两个记录之间逻辑上尚未填入数据的部分，比如上述的(1,4)、(4,7)等。</li>
<li>临键锁(Next-Key Locks) 临键指的是间隙加上它右边的记录组成的左开右闭区间。比如上述的(1,4]、(4,7]等。</li>
</ul>
<h3 id="数据库引擎"><a href="#数据库引擎" class="headerlink" title="数据库引擎"></a>数据库引擎</h3><p>​    数据引擎常用的四种</p>
<ul>
<li>InnoDB：InnoDB是事务型数据库的首选引擎，支持事务安全表（ACID），支持行锁定和外键。<ul>
<li>InnoDB给MySQL提供了具有提交、回滚和崩溃恢复能力的事物安全（ACID兼容）存储引擎。</li>
<li>InnoDB是为处理巨大数据量的最大性能设计。</li>
<li>InnoDB存储引擎完全与MySQL服务器整合，InnoDB存储引擎为在主内存中缓存数据和索引而维持它自己的缓冲池。</li>
<li>InnoDB支持外键完整性约束，存储表中的数据时，每张表的存储都按主键顺序存放，如果没有显示在表定义时指定主键，InnoDB会为每一行生成一个6字节的ROWID，并以此作为主键。</li>
<li>InnoDB被用在众多需要高性能的大型数据库站点上。</li>
</ul>
</li>
<li>MyISAM：MyISAM基于ISAM存储引擎，并对其进行扩展。MyISAM拥有较高的插入、查询速度，但不支持事物。<ul>
<li>大文件（达到63位文件长度）在支持大文件的文件系统和操作系统上被支持。</li>
<li>当把删除和更新及插入操作混合使用的时候，动态尺寸的行产生更少碎片。</li>
<li>每个MyISAM表最大索引数是64，这可以通过重新编译来改变。每个索引最大的列数是16</li>
<li>使用MyISAM引擎创建数据库，将产生3个文件。文件的名字以表名字开始，扩展名之处文件类型：frm文件存储表定义、数据文件的扩展名为.MYD（MYData）、索引文件的扩展名时.MYI（MYIndex）</li>
</ul>
</li>
</ul>
<h3 id="MySQL中的事务"><a href="#MySQL中的事务" class="headerlink" title="MySQL中的事务"></a>MySQL中的事务</h3><p>​    事务包含四大特性，即<strong>原子性（Atomicity）</strong>、<strong>一致性（Consistency）</strong>、<strong>隔离性（Isolation）</strong>和<strong>持久性（Durability）</strong>(ACID)。</p>
<ul>
<li>原子性（Atomicity） 原子性是指对数据库的一系列操作，要么全部成功，要么全部失败，不可能出现部分成功的情况。以转账场景为例，一个账户的余额减少，另一个账户的余额增加，这两个操作一定是同时成功或者同时失败的。 </li>
<li>一致性（Consistency） 一致性是指数据库的完整性约束没有被破坏，在事务执行前后都是合法的数据状态。这里的一致可以表示数据库自身的约束没有被破坏，比如某些字段的唯一性约束、字段长度约束等等；还可以表示各种实际场景下的业务约束，比如上面转账操作，一个账户减少的金额和另一个账户增加的金额一定是一样的。应用系统从一个正确的状态到另一个正确的状态。</li>
<li> 隔离性（Isolation） 隔离性指的是多个事务彼此之间是完全隔离、互不干扰的。隔离性的最终目的也是为了保证一致性。</li>
<li> 持久性（Durability） 持久性是指只要事务提交成功，那么对数据库做的修改就被永久保存下来了，不可能因为任何原因再回到原来的状态。</li>
</ul>
<h4 id="关于事务的其他知识点"><a href="#关于事务的其他知识点" class="headerlink" title="关于事务的其他知识点"></a>关于事务的其他知识点</h4><ul>
<li>在 MySQL 中只有使用了 Innodb 数据库引擎的数据库或表才支持事务。</li>
<li>事务处理可以用来维护数据库的完整性，保证成批的 SQL 语句要么全部执行，要么全部不执行。</li>
<li>事务用来管理 insert,update,delete 语句</li>
<li>在 MySQL 命令行的默认设置下，事务都是自动提交的，即执行 SQL 语句后就会马上执行 COMMIT 操作。因此要显式地开启一个事务务须使用命令 BEGIN 或 START TRANSACTION，或者执行命令 SET AUTOCOMMIT=0，用来禁止使用当前会话的自动提交。</li>
</ul>
<h3 id="MySQL中的隔离级别"><a href="#MySQL中的隔离级别" class="headerlink" title="MySQL中的隔离级别"></a>MySQL中的隔离级别</h3><h4 id="出现数据错乱的情况"><a href="#出现数据错乱的情况" class="headerlink" title="出现数据错乱的情况"></a>出现数据错乱的情况</h4><ul>
<li>脏写：脏写是指一个事务修改了其它事务未提交的数据。</li>
</ul>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210614201951702.png" alt="image-20210614201951702"></p>
<ul>
<li>脏读：脏读是指一个事务读到了其它事务未提交的数据。</li>
</ul>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210614202018063.png" alt="image-20210614202018063"></p>
<ul>
<li>不可重复读：不可重复读指的是在一个事务执行过程中，读取到其它事务已提交的数据，导致两次读取的结果不一致。</li>
</ul>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210614202120848.png" alt="image-20210614202120848"></p>
<ul>
<li>幻读：幻读是指的是在一个事务执行过程中，读取到了其他事务新插入数据，导致两次读取的结果不一致。</li>
</ul>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210614202228292.png" alt="image-20210614202228292"></p>
<h4 id="MySQL中的隔离级别-1"><a href="#MySQL中的隔离级别-1" class="headerlink" title="MySQL中的隔离级别"></a>MySQL中的隔离级别</h4><p>​    SQL中隔离级别有四种：</p>
<ul>
<li>READ UNCOMMITTED：未提交读。 就是一个事务可以读取另一个未提交事务的数据。</li>
<li>READ COMMITTED：已提交读。 就是事务要等另一个事物提交后才能读取数据</li>
<li>REPEATABLE READ：可重复读。 就是在开始读取数据（事务开启）时，不再允许修改操作</li>
<li>SERIALIZABLE：串行化。事务串行化顺序执行，可以避免脏读，不可重复读与幻读。（但是效率低）</li>
</ul>
<table>
<thead>
<tr>
<th align="center">隔离级别</th>
<th align="center">脏读</th>
<th align="center">不可重复读</th>
<th align="center">幻读</th>
</tr>
</thead>
<tbody><tr>
<td align="center">未提交读（READ UNCOMMITTED）</td>
<td align="center">false</td>
<td align="center">false</td>
<td align="center">false</td>
</tr>
<tr>
<td align="center">已提交读（READ COMMITTED）</td>
<td align="center">true</td>
<td align="center">false</td>
<td align="center">false</td>
</tr>
<tr>
<td align="center">可重复读（REPEATABLE READ）</td>
<td align="center">true</td>
<td align="center">true</td>
<td align="center">false（InnoDB为true）</td>
</tr>
<tr>
<td align="center">串行化（SERIALIZABLE）</td>
<td align="center">true</td>
<td align="center">true</td>
<td align="center">true</td>
</tr>
</tbody></table>
<h4 id="MySQL的处理办法（MVCC）"><a href="#MySQL的处理办法（MVCC）" class="headerlink" title="MySQL的处理办法（MVCC）"></a>MySQL的处理办法（MVCC）</h4><p>​    MVCC(Multi Version Concurrency Control)，中文名是多版本并发控制，简单来说就是通过维护数据历史版本，从而解决并发访问情况下的读一致性问题。主要实现有两个手段：版本链和ReadView。</p>
<h5 id="版本链"><a href="#版本链" class="headerlink" title="版本链"></a>版本链</h5><p>​    对每条记录每次更新后，都会将旧值放到一条undo日志中，就算是该记录的一个旧版本，随着更新次数的增多，所有的版本都会被roll_pointer属性连接成一个链表，我们把这个链表称之为版本链，版本链的头节点就是当前记录最新的值。修改一行记录时，都会将本次的事务ID和undo日志记录下来。undo日志里面则是存放的旧值。</p>
<h5 id="ReadView"><a href="#ReadView" class="headerlink" title="ReadView"></a>ReadView</h5><p>​    ReadView包含四个内容：</p>
<ul>
<li>m_ids：表示在生成ReadView时当前系统中活跃的读写事务的事务id列表。</li>
<li>min_trx_id：表示在生成ReadView时当前系统中活跃的读写事务中最小的事务id，也就是m_ids中的最小值。</li>
<li>max_trx_id：表示生成ReadView时系统中应该分配给下一个事务的id值。</li>
<li>creator_trx_id：表示生成该ReadView的事务的事务id。</li>
</ul>
<p>流程：</p>
<ul>
<li>如果被访问版本的trx_id属性值与ReadView中的creator_trx_id值相同，意味着当前事务在访问它自己修改过的记录，所以该版本可以被当前事务访问。</li>
<li>如果被访问版本的trx_id属性值小于ReadView中的min_trx_id值，表明生成该版本的事务在当前事务生成ReadView前已经提交，所以该版本可以被当前事务访问。</li>
<li>如果被访问版本的trx_id属性值大于或等于ReadView中的max_trx_id值，表明生成该版本的事务在当前事务生成ReadView后才开启，所以该版本不可以被当前事务访问。</li>
<li>如果被访问版本的trx_id属性值在ReadView的min_trx_id和max_trx_id之间，那就需要判断一下trx_id属性值是不是在m_ids列表中，如果在，说明创建ReadView时生成该版本的事务还是活跃的，该版本不可以被访问；如果不在，说明创建ReadView时生成该版本的事务已经被提交，该版本可以被访问。</li>
</ul>
<p>​    READ COMMITTED（读提交）在每次读取数据前都会生成一个ReadView，这样就能保证每次都能读到其它事务已提交的数据。</p>
<p>​    REPEATABLE READ （可重复读）只在第一次读取数据时生成一个ReadView，这样就能保证后续读取的结果完全一致。</p>
<h3 id="事务日志"><a href="#事务日志" class="headerlink" title="事务日志"></a>事务日志</h3><p>​    MySQL中日志有二进制日志（binlog）、错误日志、查询日志、慢查询日志等，此外InnoDB存储引擎还提供了两种日志：redo log（重做日志）和undo log（回滚日志）。</p>
<h4 id="redo-log（重做日志）"><a href="#redo-log（重做日志）" class="headerlink" title="redo log（重做日志）"></a>redo log（重做日志）</h4><p>​    重做日志（redo log）是InnoDB引擎层的日志，用来记录事务操作引起数据的变化，记录的是数据页的物理修改。</p>
<p>​    InnoDB引擎对数据的更新，是先将更新记录写入redo log日志，然后会在系统空闲的时候或者是按照设定的更新策略再将日志中的内容更新到磁盘之中。这就是所谓的预写式技术（Write Ahead logging）。</p>
<p>​    redo log日志的大小是固定的，为了能够持续不断的对更新记录进行写入，在redo log日志中设置了两个标志位置，checkpoint和write_pos，分别表示记录擦除的位置和记录写入的位置。</p>
<p>​    当write_pos标志到了日志结尾时，会从结尾跳至日志头部进行重新循环写入。所以redo log的逻辑结构并不是线性的，而是可看作一个圆周运动。write_pos与checkpoint中间的空间可用于写入新数据，写入和擦除都是往后推移，循环往复的。</p>
<p>​    缓冲池<code>buffer pool</code>是在内存中分配的一个区域，包含了磁盘中部分数据页的映射，作为访问数据库的缓冲。当数据修改时，除了修改buffer pool中的数据，还会在redo log中记录这次操作；当事务提交时，会根据redo log的记录对数据进行刷盘。如果MySQL宕机，重启时可以读取redo log中的数据，对数据库进行恢复，从而保证了事务的持久性，使得数据库获得crash-safe能力。</p>
<p>​    redo log日志可分为两个部分，一是存在易失性内存中的缓存日志redo log buff，二是保存在磁盘上的redo log日志文件redo log file。</p>
<p>​    为了确保每次记录都能够写入到磁盘中的日志中，每次将redo log buffer中的日志写入redo log file的过程中都会调用一次操作系统的fsync操作。（和redis中AOF备份类似）</p>
<h4 id="binlog（二进制日志）"><a href="#binlog（二进制日志）" class="headerlink" title="binlog（二进制日志）"></a>binlog（二进制日志）</h4><p>​    二进制日志binlog是服务层的日志，还被称为归档日志。binlog主要记录数据库的变化情况，内容包括数据库所有的更新操作。所有涉及数据变动的操作，都要记录进二进制日志中。因此有了binlog可以很方便的对数据进行复制和备份，因而也常用作主从库的同步。二进制日志的文件大小不固定，写完会切换下一个文件。</p>
<p>​    和redo log的区别：redo log是一种物理日志，记录的是实际上对某个数据进行了怎么样的修改；而binlog是逻辑日志，记录的是SQL语句的原始逻辑。redo log是基于crash recovery，保证MySQL宕机后的数据恢复；而binlog是基于point-in-time recovery，保证服务器可以基于时间点对数据进行恢复，或者对数据进行备份。binlog是服务层的日志，因此所有引擎都能够使用。redo log是引擎层的日志，是InnoDB引擎持有。</p>
<p>​    MySQL在执行更新语句的时候，在服务层进行语句的解析和执行，在引擎层进行数据的提取和存储；同时在服务层对binlog进行写入，在InnoDB内进行redo log的写入。不仅如此，在对redo log写入时有两个阶段的提交，一是binlog写入之前<code>prepare</code>状态的写入，二是binlog写入之后<code>commit</code>状态的写入。</p>
<h4 id="undo-log（回滚日志）"><a href="#undo-log（回滚日志）" class="headerlink" title="undo log（回滚日志）"></a>undo log（回滚日志）</h4><p>​    回滚日志同样也是InnoDB引擎提供的日志，顾名思义，回滚日志的作用就是对数据进行回滚。当事务对数据库进行修改，InnoDB引擎不仅会记录redo log，还会生成对应的undo log日志；如果事务执行失败或调用了rollback，导致事务需要回滚，就可以利用undo log中的信息将数据回滚到修改之前的样子。但是undo log不redo log不一样，它属于逻辑日志。它对SQL语句执行相关的信息进行记录。</p>
<h4 id="什么是双阶段提交"><a href="#什么是双阶段提交" class="headerlink" title="什么是双阶段提交"></a>什么是双阶段提交</h4><p>​    修改一条数据时，以innodb为例，innodb在内存中修改完毕后，将其写入redolog，状态标记为准备，然后返回结果，服务层将这次的修改写入binlog，标记事务完成，然后redolog将状态标记为提交，等待将其写入磁盘中。双阶段提交是为了保证两个日志中逻辑上的一致，同一条数据不会因为宕机出现混乱。</p>
<h3 id="MySQL中数据类型"><a href="#MySQL中数据类型" class="headerlink" title="MySQL中数据类型"></a>MySQL中数据类型</h3><p>​    MySQL中数据类型分为三大块，数值类型、日期和时间类型、字符串类型。</p>
<p>​    数值类型：</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210617180123419.png" alt="image-20210617180123419"></p>
<p>​    日期和时间类型</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210617180149314.png" alt="image-20210617180149314"></p>
<p>​    字符串类型</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210617180214099.png" alt="image-20210617180214099"></p>
<h3 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h3><h4 id="B-树概念"><a href="#B-树概念" class="headerlink" title="B+树概念"></a>B+树概念</h4><h5 id="选择B-实现的原因"><a href="#选择B-实现的原因" class="headerlink" title="选择B+实现的原因"></a>选择B+实现的原因</h5><p>​    因为Mysql查询的形式是有以下几种：1）查询特定数据。2）查询范围数据。</p>
<ul>
<li>hash表并不支持范围查询，其他平衡树也是对于范围查询很低效。</li>
<li>B树和B+树的区别就是：B+树的数据存储只在叶子节点。因为系统IO并不是需要什么就读取什么，而是会读取这块空间的周围存储。B树因为非叶子结点也存储数据，所以会造成多次的IO读取。B+树因为叶子结点是链表的形式，所以可以较少次的IO读取。</li>
<li>跳表比较适合内存空间存储，对于磁盘空间查询不友好。（也是没有利用磁盘缓存的特点）跳表的查询相对于B+树稍微差些。</li>
</ul>
<h5 id="B-树概念-1"><a href="#B-树概念-1" class="headerlink" title="B+树概念"></a>B+树概念</h5><p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210615113558216.png" alt="image-20210615113558216"></p>
<ul>
<li>B+树非叶子节点上是不存储数据的，仅存储键值。键就是排序的因素，值就是直线下一个节点的地址。</li>
<li>B+树的阶数是等于键值的数量的，如果我们的B+树一个节点可以存储1000个键值。</li>
<li>B+树中各个页之间是通过双向链表连接的，叶子节点中的数据是通过单向链表连接的。</li>
<li>根节点至少拥有两个子树</li>
<li>每个树节点最多拥有M个子树</li>
<li>每个树节点(除了根节点)拥有至少M/2个子树</li>
</ul>
<h5 id="B-树的性质"><a href="#B-树的性质" class="headerlink" title="B+树的性质"></a>B+树的性质</h5><ul>
<li>索引字段要尽量的小。因为索引字段过大，就会导致数据项变小，即B+树的阶数变小。导致B+树的高度变高，读取IO的次数也变多。</li>
<li>索引的最左匹配特性。因为B+树建立复合索引时是根据从左到右的方向来建立搜索树的，查询也是根据第一个字段来决定查询的方向，如果没有带第一个字段，就无法匹配。查到第一个字段后，这段数据的附近则是根据其他索引进行排序的。</li>
</ul>
<h4 id="MySQL中索引的分类"><a href="#MySQL中索引的分类" class="headerlink" title="MySQL中索引的分类"></a>MySQL中索引的分类</h4><ul>
<li><p>按照数据结构可以分为B+tree索引、Hash索引、Full-text索引。</p>
</li>
<li><p>B+tree索引：上面讲的差不多，有点就是查询快，读取IO磁盘的次数较低</p>
</li>
<li><p>Hash索引：单个查询可以快速，但是范围查询就很慢了</p>
</li>
<li><p>Full-text索引：full-text在mysql里仅有myisam支持它，而且支持full-text的字段只有char、varchar、text数据类型。full-text主要是用来代替like “%***%”效率低下的问题。</p>
<p>  按照物理存储可以分为：聚簇索引、二级索引（辅助索引或者非聚簇索引）</p>
</li>
<li><p>聚簇索引：聚簇索引的每个叶子节点存储了一行完整的表数据，叶子节点间按id列递增连接，可以方便地进行顺序检索。</p>
</li>
<li><p>非聚簇索引：二级索引的叶子节点并不存储一行完整的表数据，而是存储了聚簇索引所在列的值。</p>
<p>  按照字段特性可以分类为：主键索引、普通索引、前缀索引。</p>
</li>
<li><p>主键索引：建立在主键上的索引被称为主键索引，一张数据表只能有一个主键索引，索引列值不允许有空值，通常在创建表时一起创建。</p>
</li>
<li><p>普通索引：建立在普通字段上的索引被称为普通索引。</p>
</li>
<li><p>前缀索引：前缀索引是指对字符类型字段的前几个字符或对二进制类型字段的前几个bytes建立的索引，而不是在整个字段上建索引。前缀索引可以建立在类型为char、varchar、binary、varbinary的列上，可以大大减少索引占用的存储空间，也能提升索引的查询效率。</p>
</li>
<li><p>唯一索引：建立在UNIQUE字段上的索引被称为唯一索引，一张表可以有多个唯一索引，索引列值允许为空，列值中出现多个空值不会发生重复冲突。</p>
<p>  按照字段个数可以分类为：单列索引、联合索引（复合索引、组合索引）。</p>
</li>
<li><p>单列索引：建立在单个列上的索引被称为单列索引。</p>
</li>
<li><p>联合索引：建立在多个列上的索引被称为联合索引，又叫复合索引、组合索引。</p>
</li>
</ul>
<h4 id="建立索引的几个原则"><a href="#建立索引的几个原则" class="headerlink" title="建立索引的几个原则"></a>建立索引的几个原则</h4><ul>
<li>最左前缀匹配原则，非常重要的原则，mysql会一直向右匹配直到遇到范围查询(&gt;、&lt;、between、like)就停止匹配，比如a = 1 and b = 2 and c &gt; 3 and d = 4 如果建立(a,b,c,d)顺序的索引，d是用不到索引的，如果建立(a,b,d,c)的索引则都可以用到，a,b,d的顺序可以任意调整。</li>
<li>=和in可以乱序，比如a = 1 and b = 2 and c = 3 建立(a,b,c)索引可以任意顺序，mysql的查询优化器会帮你优化成索引可以识别的形式。</li>
<li>尽量选择区分度高的列作为索引，区分度的公式是count(distinct col)/count(*)，表示字段不重复的比例，比例越大我们扫描的记录数越少，唯一键的区分度是1，而一些状态、性别字段可能在大数据面前区分度就是0，那可能有人会问，这个比例有什么经验值吗？使用场景不同，这个值也很难确定，一般需要join的字段我们都要求是0.1以上，即平均1条扫描10条记录。</li>
<li>索引列不能参与计算，保持列“干净”，比如from_unixtime(create_time) = ’2014-05-29’就不能使用到索引，原因很简单，b+树中存的都是数据表中的字段值，但进行检索时，需要把所有元素都应用函数才能比较，显然成本太大。所以语句应该写成create_time = unix_timestamp(’2014-05-29’)。</li>
<li>尽量的扩展索引，不要新建索引。比如表中已经有a的索引，现在要加(a,b)的索引，那么只需要修改原来的索引即可。</li>
<li>在建立联合索引的时候，安排索引内的字段顺序的原则：1.如果通过调整顺序，可以少维护一个索引，那么这个顺序往往就是需要优先考虑采用的。2.在必须维护两个重复索引时，这个时候需要考虑字段大小问题。</li>
<li></li>
</ul>
<h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><ul>
<li>索引分单列索引和组合索引。单列索引，即一个索引只包含单个列，一个表可以有多个单列索引，但这不是组合索引。组合索引，即一个索引包含多个列。</li>
<li>虽然索引大大提高了查询速度，同时却会降低更新表的速度，如对表进行INSERT、UPDATE和DELETE。因为更新表时，MySQL不仅要保存数据，还要保存一下索引文件。建立索引会占用磁盘空间的索引文件。</li>
</ul>
<h3 id="MySQL中的存储过程"><a href="#MySQL中的存储过程" class="headerlink" title="MySQL中的存储过程"></a>MySQL中的存储过程</h3><p>储存过程是一个可编程的函数，它在数据库中创建并保存。它可以有SQL语句和一些特殊的控制结构组成。当希望在不同的应用程序或平台上执行相同的函数，或者封装特定功能时，存储过程是非常有用的。数据库中的存储过程可以看做是对编程中面向对象方法的模拟。它允许控制数据的访问方式。特点有以下几点：</p>
<ul>
<li>存储过程能实现较快的执行速度。</li>
<li>存储过程允许标准组件是编程。</li>
<li>存储过程可被作为一种安全机制来充分利用。</li>
<li>存储过程能过减少网络流量。</li>
</ul>
<h3 id="SQL中的范式理解"><a href="#SQL中的范式理解" class="headerlink" title="SQL中的范式理解"></a>SQL中的范式理解</h3><h4 id="第一范式（1NF）"><a href="#第一范式（1NF）" class="headerlink" title="第一范式（1NF）"></a>第一范式（1NF）</h4><p>​    在任何一个关系数据库中，第一范式（1NF）是对关系模式的基本要求，不满足第一范式（1NF）的数据库就不是关系数据库。 </p>
<p>​    所谓第一范式（1NF）是指数据库表的每一列都是不可分割的基本数据项，同一列中不能有多个值，即实体中的某个属性不能有多个值或者不能有重复的属性。如果出现重复的属性，就可能需要定义一个新的实体，新的实体由重复的属性构成，新实体与原实体之间为一对多关系。在第一范式（1NF）中表的每一行只包含一个实例的信息。</p>
<p>​    如：学生表中，有3个字段 学号 姓名 家庭地址(XXX省XXX市）,由于地址字段是可以再拆分的所以不满足第一范式。</p>
<p>​    改造为：学号 姓名 出生省份 出生城市既满足第一范式</p>
<h4 id="第二范式（2NF）"><a href="#第二范式（2NF）" class="headerlink" title="第二范式（2NF）"></a>第二范式（2NF）</h4><p>​    第二范式（2NF）是在第一范式（1NF）的基础上建立起来的，即满足第二范式（2NF）必须先满足第一范式（1NF）。第二范式（2NF）要求数据库表中的每个实例或行必须可以被惟一地区分。为实现区分通常需要为表加上一个列，以存储各个实例的惟一标识。<br>​    第二范式（2NF）要求实体的属性完全依赖于主关键字。所谓完全依赖是指不能存在仅依赖主关键字一部分的属性，如果存在，那么这个属性和主关键字的这一部分应该分离出来形成一个新的实体，新实体与原实体之间是一对多的关系。为实现区分通常需要为表加上一个列，以存储各个实例的惟一标识。简而言之，第二范式就是非主属性非部分依赖于主关键字。</p>
<p>​    如：学生表中 有 学号 姓名 选课号 出生日期 成绩 五个字段， 其中学号为主键，成绩并不依赖与学号，所以不满足第二范式。应该删除选课号，然后构建一张选课表。</p>
<h4 id="第三范式（3NF）"><a href="#第三范式（3NF）" class="headerlink" title="第三范式（3NF）"></a>第三范式（3NF）</h4><p>​    满足第三范式（3NF）必须先满足第二范式（2NF）。简而言之，第三范式（3NF）要求一个数据库表中不包含已在其它表中已包含的非主关键字信息。例如，存在一个部门信息表，其中每个部门有部门编号（dept_id）、部门名称、部门简介等信息。那么员工信息表中列出部门编号后就不能再将部门名称、部门简介等与部门有关的信息再加入员工信息表中。如果不存在部门信息表，则根据第三范式（3NF）也应该构建它，否则就会有大量的数据冗余。简而言之，第三范式就是属性不依赖于其它非主属性。 </p>
<h2 id="SQL语法"><a href="#SQL语法" class="headerlink" title="SQL语法"></a>SQL语法</h2><h3 id="WHERE"><a href="#WHERE" class="headerlink" title="WHERE"></a>WHERE</h3><ul>
<li>查询语句中你可以使用一个或者多个表，表之间使用逗号**,** 分割，并使用WHERE语句来设定查询条件。(from后面跟多个表，通过where的形式做限定是内连接，只寻找两个表中都存在的数据)</li>
<li>你可以在 WHERE 子句中指定任何条件。</li>
<li>你可以使用 AND 或者 OR 指定一个或多个条件。</li>
<li>WHERE 子句也可以运用于 SQL 的 DELETE 或者 UPDATE 命令。</li>
<li>WHERE 子句类似于程序语言中的 if 条件，根据 MySQL 表中的字段值来读取指定的数据。</li>
<li>MySQL 的 WHERE 子句的字符串比较是不区分大小写的。 你可以使用 BINARY 关键字来设定 WHERE 子句的字符串比较是区分大小写的。</li>
</ul>
<h3 id="UPDATE"><a href="#UPDATE" class="headerlink" title="UPDATE"></a>UPDATE</h3><p>​    update 表名称 set 列名称=新值 where 更新条件;</p>
<ul>
<li>你可以同时更新一个或多个字段。</li>
<li>你可以在 WHERE 子句中指定任何条件。</li>
<li>你可以在一个单独表中同时更新数据。</li>
</ul>
<h3 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h3><ul>
<li>如果没有指定 WHERE 子句，MySQL 表中的所有记录将被删除。</li>
<li>你可以在 WHERE 子句中指定任何条件</li>
<li>您可以在单个表中一次性删除记录。</li>
</ul>
<h3 id="LIKE"><a href="#LIKE" class="headerlink" title="LIKE"></a>LIKE</h3><ul>
<li>你可以在 WHERE 子句中指定任何条件。</li>
<li>你可以在 WHERE 子句中使用LIKE子句。</li>
<li>你可以使用LIKE子句代替等号 **=**。</li>
<li>LIKE 通常与 <strong>%</strong> 一同使用，类似于一个元字符的搜索。</li>
<li>你可以使用 AND 或者 OR 指定一个或多个条件。</li>
<li>你可以在 DELETE 或 UPDATE 命令中使用 WHERE…LIKE 子句来指定条件。</li>
<li>**%**：表示任意 0 个或多个字符。可匹配任意类型和长度的字符，有些情况下若是中文，请使用两个百分号（%%）表示。</li>
<li>**_**：表示任意单个字符。匹配单个任意字符，它常用来限制表达式的字符长度语句。</li>
<li>**[]**：表示括号内所列字符中的一个（类似正则表达式）。指定一个字符、字符串或范围，要求所匹配对象为它们中的任一个。</li>
<li><strong>[^]</strong> ：表示不在括号所列之内的单个字符。其取值和 [] 相同，但它要求所匹配对象为指定字符以外的任一个字符。</li>
<li>查询内容包含通配符时,由于通配符的缘故，导致我们查询特殊字符 “%”、“_”、“[” 的语句无法正常实现，而把特殊字符用 “[ ]” 括起便可正常查询。</li>
</ul>
<h3 id="UNION"><a href="#UNION" class="headerlink" title="UNION"></a>UNION</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> expression1, expression2, ... expression_n</span><br><span class="line"><span class="keyword">FROM</span> tables</span><br><span class="line">[<span class="keyword">WHERE</span> conditions]</span><br><span class="line"><span class="keyword">UNION</span> [<span class="keyword">ALL</span> <span class="operator">|</span> <span class="keyword">DISTINCT</span>]</span><br><span class="line"><span class="keyword">SELECT</span> expression1, expression2, ... expression_n</span><br><span class="line"><span class="keyword">FROM</span> tables</span><br><span class="line">[<span class="keyword">WHERE</span> conditions];</span><br></pre></td></tr></table></figure>

<p>MySQL UNION 操作符用于连接两个以上的 SELECT 语句的结果组合到一个结果集合中。多个 SELECT 语句会删除重复的数据。</p>
<ul>
<li><strong>DISTINCT:</strong> 可选，删除结果集中重复的数据。默认情况下 UNION 操作符已经删除了重复数据，所以 DISTINCT 修饰符对结果没啥影响。</li>
<li><strong>ALL:</strong> 可选，返回所有结果集，包含重复数据。</li>
<li>要注意UNION的两个查询条件返回结果要一致。</li>
<li>UNION 不能用于列出两个表中所有的country。如果一些网站和APP来自同一个国家，每个国家只会列出一次。UNION 只会选取不同的值。请使用 UNION ALL 来选取重复的值！</li>
<li>官网要求两个子查询列的名称和数据类型、和数目必须一致。但是数据类型和名称可以不一致也可以执行，只是后续又可能会出错。</li>
<li>UNION结果集的列名取自第一个SELECT语句的列名。</li>
<li>如果相应的SELECT列的数据类型不匹配，则UNION结果中的列的类型和长度将考虑所有SELECT语句检索的值。</li>
</ul>
<h3 id="ORDER-BY"><a href="#ORDER-BY" class="headerlink" title="ORDER BY"></a><strong>ORDER BY</strong></h3><ul>
<li>你可以使用任何字段来作为排序的条件，从而返回排序后的查询结果。</li>
<li>你可以设定多个字段来排序。</li>
<li>你可以使用 ASC 或 DESC 关键字来设置查询结果是按升序或降序排列。 默认情况下，它是按升序排列。</li>
<li>你可以添加 WHERE…LIKE 子句来设置条件。</li>
<li>如果字符集采用的是 utf8(万国码)，需要先对字段进行转码然后排序：<code>ORDER BY CONVERT(runoob_title using gbk);</code></li>
</ul>
<h3 id="GROUP-BY"><a href="#GROUP-BY" class="headerlink" title="GROUP BY"></a>GROUP BY</h3><p>GROUP BY 语句根据一个或多个列对结果集进行分组。在分组的列上我们可以使用 COUNT, SUM, AVG,等函数。(count是统计，sum是求和)</p>
<h3 id="null值比较"><a href="#null值比较" class="headerlink" title="null值比较"></a>null值比较</h3><p>MySQL提供了三大运算符:用来对bull值比较</p>
<ul>
<li><strong>IS NULL:</strong> 当列的值是 NULL,此运算符返回 true。</li>
<li><strong>IS NOT NULL:</strong> 当列的值不为 NULL, 运算符返回 true。</li>
<li><strong>&lt;=&gt;:</strong> 比较操作符（不同于 = 运算符），当比较的的两个值相等或者都为 NULL 时返回 true。</li>
<li>可以使用 coalesce 来设置一个可以取代 NUll 的名称，coalesce 语法：</li>
</ul>
<h3 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h3><h4 id="事务的控制语句"><a href="#事务的控制语句" class="headerlink" title="事务的控制语句"></a>事务的控制语句</h4><ul>
<li>BEGIN 或 START TRANSACTION 显式地开启一个事务；</li>
<li>COMMIT 也可以使用 COMMIT WORK，不过二者是等价的。COMMIT 会提交事务，并使已对数据库进行的所有修改成为永久性的；</li>
<li>ROLLBACK 也可以使用 ROLLBACK WORK，不过二者是等价的。回滚会结束用户的事务，并撤销正在进行的所有未提交的修改；</li>
<li>SAVEPOINT identifier，SAVEPOINT 允许在事务中创建一个保存点，一个事务中可以有多个 SAVEPOINT；</li>
<li>RELEASE SAVEPOINT identifier 删除一个事务的保存点，当没有指定的保存点时，执行该语句会抛出一个异常；</li>
<li>ROLLBACK TO identifier 把事务回滚到标记点；</li>
<li>SET TRANSACTION 用来设置事务的隔离级别。InnoDB 存储引擎提供事务的隔离级别有READ UNCOMMITTED、READ COMMITTED、REPEATABLE READ 和 SERIALIZABLE。</li>
</ul>
<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>常用的函数，这个链接：<a target="_blank" rel="noopener" href="https://www.runoob.com/mysql/mysql-functions.html">菜鸟网络</a> </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">DENSE_RANK</span>() <span class="keyword">OVER</span> (</span><br><span class="line">    <span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>expression<span class="operator">&gt;</span>[&#123;,<span class="operator">&lt;</span>expression<span class="operator">&gt;</span>...&#125;]</span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="operator">&lt;</span>expression<span class="operator">&gt;</span> [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>], [&#123;,<span class="operator">&lt;</span>expression<span class="operator">&gt;</span>...&#125;]</span><br><span class="line">) </span><br></pre></td></tr></table></figure>

<ul>
<li>首先，<code>PARTITION BY</code>子句将<code>FROM</code>子句生成的结果集划分为分区。<code>DENSE_RANK()</code>函数应用于每个分区。</li>
<li>其次，<code>ORDER BY</code> 子句指定<code>DENSE_RANK()</code>函数操作的每个分区中的行顺序。</li>
<li>与<code>RANK()</code>函数不同，<code>DENSE_RANK()</code>函数始终返回连续的排名值。</li>
</ul>
<ul>
<li><p>LIMIT 接受一个或两个数字参数。参数必须是一个整数常量。如果给定两个参数，第一个参数指定第一个返回记录行的偏移量，第二个参数指定返回记录行的最大数目。也可以使用OFFSET设定偏移量，你可以通过OFFSET指定SELECT语句开始查询的数据偏移量。默认情况下偏移量为0。</p>
</li>
<li><p>GROUP BY 语句用于结合聚合函数，根据一个或多个列对结果集进行分组。显示为一行，所以要对其他列进行聚合显示，求和或者求最大。</p>
</li>
<li><p>where后面的条件需要带上引号，单引号和双引号都可以。除了int和数字不需要带引号。</p>
</li>
<li><p>mysql没有full join，可以通过将左连接和右连接组合一起打到full join</p>
</li>
<li><p>各个SQL关键字执行的顺序</p>
<ol>
<li>FROM, including JOINs</li>
<li>WHERE</li>
<li>GROUP BY</li>
<li>HAVING</li>
<li>WINDOW functions</li>
<li>SELECT</li>
<li>DISTINCT</li>
<li>UNION</li>
<li>ORDER BY</li>
<li>LIMIT and OFFSET</li>
</ol>
</li>
<li><p><code>count(1)和count（*）count（cloum）统计列值的数量时，会忽略空值，当括号内的值不可能为空时，就直接统计行数。count（1）和count（*）都是一样的，都是统计行数，都是根据索引来统计行数。</code></p>
</li>
<li><p>group by后面的having中的字段必须要查询到，如果相对表做个筛选，可以在group by前面添加where语句，having语句是对group by语句到补充。</p>
</li>
<li><p>in后面可以跟多个字段，和concat函数类似。</p>
</li>
<li><p>join当两个表中不匹配时，不返回任何行。</p>
</li>
<li><p>慢查询日志就是查询超过阈值的语句会被记录下来，一般的默认值就是10秒。这个可以设置。</p>
</li>
<li><p>CASE value WHEN [compare_value] THEN result [WHEN [compare_value] THEN result …] [ELSE result] END case的用法，一般用来做判断。</p>
</li>
<li><p>mod函数用来求余的，mod（3,2）返回1</p>
</li>
<li><p>COALESCE取值的，COALESCE（1，2）如果1为null，就取2。</p>
</li>
<li><p><code>LEFT(Str,length)</code>函数是一个字符串函数，它返回具有指定长度的字符串的左边部分。str是字符串，length是要截取的长度。</p>
</li>
<li><p>ROW_NUMBER()是一个窗口函数或分析函数，它为从1开始应用的每一行分配一个序号。用例：id - row_number() over(order by id) as rk</p>
</li>
<li><p>with tmp as (select * from table） 可以将查询结果作为临时表，子查询互相之间是不能访问的。</p>
</li>
<li><p><code>CROSS JOIN</code>子句从连接的表返回行的笛卡儿乘积。</p>
</li>
</ul>
<h2 id="MySQL语句优化"><a href="#MySQL语句优化" class="headerlink" title="MySQL语句优化"></a>MySQL语句优化</h2><p>​    大概30点个点。</p>
<ul>
<li>对查询进行优化，应尽量避免全表扫描，首先应考虑在 where 及 order by 涉及的列上建立索引。</li>
<li>应尽量避免在 where 子句中使用!=或&lt;&gt;操作符，否则将引擎放弃使用索引而进行全表扫描。</li>
<li>应尽量避免在 where 子句中对字段进行 null 值判断，否则将导致引擎放弃使用索引而进行全表扫描。</li>
<li>应尽量避免在 where 子句中使用 or 来连接条件，否则将导致引擎放弃使用索引而进行全表扫描。</li>
<li>尽量不要使用like进行匹配，要不然也会导致全表扫描。</li>
<li>in 和 not in 也要慎用，否则会导致全表扫描。</li>
<li>如果在 where 子句中使用参数，也会导致全表扫描。</li>
<li>应尽量避免在 where 子句中对字段进行表达式操作，这将导致引擎放弃使用索引而进行全表扫描。</li>
<li>应尽量避免在where子句中对字段进行函数操作，这将导致引擎放弃使用索引而进行全表扫描。</li>
<li>不要在 where 子句中的“=”左边进行函数、算术运算或其他表达式运算，否则系统将可能无法正确使用索引。</li>
<li>在使用索引字段作为条件时，如果该索引是复合索引，那么必须使用到该索引中的第一个字段作为条件时才能保证系统使用该索引，否则该索引将不会被使用，并且应尽可能的让字段顺序与索引顺序相一致。</li>
<li>不要写一些没有意义的查询，如需要生成一个空表结构。</li>
<li>很多时候用 exists 代替 in 是一个好的选择。</li>
<li>并不是所有索引对查询都有效，SQL是根据表中数据来进行查询优化的，当索引列有大量数据重复时，SQL查询可能不会去利用索引，如一表中有字段sex，male、female几乎各一半，那么即使在sex上建了索引也对查询效率起不了作用。</li>
<li>索引并不是越多越好，索引固然可以提高相应的 select 的效率，但同时也降低了 insert 及 update 的效率，因为 insert 或 update 时有可能会重建索引，所以怎样建索引需要慎重考虑，视具体情况而定。一个表的索引数最好不要超过6个，若太多则应考虑一些不常使用到的列上建的索引是否有必要。</li>
<li>应尽可能的避免更新 clustered 索引数据列，因为 clustered 索引数据列的顺序就是表记录的物理存储顺序，一旦该列值改变将导致整个表记录的顺序的调整，会耗费相当大的资源。</li>
<li>尽量使用数字型字段，若只含数值信息的字段尽量不要设计为字符型，这会降低查询和连接的性能，并会增加存储开销。</li>
<li>尽可能的使用 varchar/nvarchar 代替 char/nchar ，因为首先变长字段存储空间小，可以节省存储空间，其次对于查询来说，在一个相对较小的字段内搜索效率显然要高些。</li>
<li>任何地方都不要使用 select * from t ，用具体的字段列表代替“*”，不要返回用不到的任何字段。</li>
<li>尽量使用表变量来代替临时表。如果表变量包含大量数据，请注意索引非常有限（只有主键索引）。</li>
<li>避免频繁创建和删除临时表，以减少系统表资源的消耗。</li>
<li>临时表并不是不可使用，适当地使用它们可以使某些例程更有效。</li>
<li>在新建临时表时，如果一次性插入数据量很大，那么可以使用 select into 代替 create table，避免造成大量 log ，以提高速度；如果数据量不大，为了缓和系统表的资源，应先create table，然后insert。</li>
<li>如果使用到了临时表，在存储过程的最后务必将所有的临时表显式删除，先 truncate table ，然后 drop table ，这样可以避免系统表的较长时间锁定。</li>
<li>尽量避免使用游标，因为游标的效率较差，如果游标操作的数据超过1万行，那么就应该考虑改写。</li>
<li>使用基于游标的方法或临时表方法之前，应先寻找基于集的解决方案来解决问题，基于集的方法通常更有效。</li>
<li>与临时表一样，游标并不是不可使用。对小型数据集使用 FAST_FORWARD 游标通常要优于其他逐行处理方法，尤其是在必须引用几个表才能获得所需的数据时。在结果集中包括“合计”的例程通常要比使用游标执行的速度快。如果开发时间允许，基于游标的方法和基于集的方法都可以尝试一下，看哪一种方法的效果更好。</li>
<li>在所有的存储过程和触发器的开始处设置 SET NOCOUNT ON ，在结束时设置 SET NOCOUNT OFF 。无需在执行存储过程和触发器的每个语句后向客户端发送 DONE_IN_PROC 消息。</li>
<li>尽量避免向客户端返回大数据量，若数据量过大，应该考虑相应需求是否合理。</li>
<li>尽量避免大事务操作，提高系统并发能力。</li>
<li>MySQL 临时表在我们需要保存一些临时数据时是非常有用的。临时表只在当前连接可见，当关闭连接时，Mysql会自动删除表并释放所有空间。</li>
<li>MySQL 序列是一组整数：1, 2, 3, …，由于一张数据表只能有一个字段自增主键， 如果你想实现其他字段也实现自动增加，就可以使用MySQL序列来实现。</li>
<li>你可以在 MySQL 数据表中设置指定的字段为 PRIMARY KEY（主键） 或者 UNIQUE（唯一） 索引来保证数据的唯一性。</li>
</ul>
<h4 id="优化工具"><a href="#优化工具" class="headerlink" title="优化工具"></a>优化工具</h4><p>首先是通过慢查询日志来记录数据库中查询比较慢的SQL</p>
<p>然后是用explain来判断语句使用了哪些索引，以及一些基础的信息。看看和自己的预期是否一致</p>
<p>最后做对应的修改，例如增加索引或者修正索引的顺序。</p>
<h3 id="MySQL中问到的问题"><a href="#MySQL中问到的问题" class="headerlink" title="MySQL中问到的问题"></a>MySQL中问到的问题</h3><ul>
<li>MySQL中优化的场景和具体的做法。</li>
</ul>
<p>​    举个例子：我们有一个表，里面存储了点位的一些信息，建立了一个联合索引，点位id和设备id。有一次需要执行一条语句，查询某个设备的所有模拟信号点位信息。where后面的语句就是point_id=1 and mn&gt;0 and equipment_id=2.但是后来发现执行的效率不太对，通过explain查询发现只了一个索引，就是point_id，按理说应该走equipment_id。因为最左匹配原则，遇到范围查询时停止使用索引，所以最后造成这样的结果，可以调整sql的顺序，将范围查询放到后面。这样的例子其实在网上挺多的，这个需要你平时写sql多注意和多总结，遇到不正常的SQL去解析查询的流程。</p>
<h2 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h2><p>//MySQL中锁的分类，行级锁、排查锁、共享锁</p>
<p>// MySQL中的隔离级别</p>
<p>//事务</p>
<p>//索引</p>
<p>//数据类型</p>
<p>//B+树和B-树</p>
<p>//范式（了解即可）</p>
<p>//优化MySQL</p>
<p>//存储过程</p>
<p>//慢查询日志</p>
<p>慢SQL优化</p>
<p>//MySQL的事务文件就是redolog和undolog</p>
<p>//Mysql binlog和Relog</p>
<p>其他</p>
<p>分布式事务</p>
<p>需要学习窗口函数</p>
<p>ranking&gt;=countNum/2 and ranking&lt;=countNum/2+1</p>
<p>select Id,Company,Salary<br>from<br>(<br>select Id,Company,Salary,<br>row_number()over(partition by Company order by Salary)as ranking,<br>count(Id) over(partition by Company)as cnt<br>from Employee<br>)a<br>where ranking&gt;=cnt/2 and ranking&lt;=cnt/2+1</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-协议/HTTP/HTTP图解"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
     
    <div class="article-meta">
      <a href="/2021/10/14/%E5%8D%8F%E8%AE%AE/HTTP/HTTP%E5%9B%BE%E8%A7%A3/" class="article-date">
  <time datetime="2021-10-14T10:09:31.648Z" itemprop="datePublished">2021-10-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%8D%8F%E8%AE%AE/">协议</a> / <a class="article-category-link" href="/categories/%E5%8D%8F%E8%AE%AE/HTTP/">HTTP</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>最近工作中用到了HTTP，想了解一下，所以看了《图解HTTP》，下面的内容相当于读书笔记。作为记录，省的后面又忘记，先后顺序按照阅读顺序。</p>
<ul>
<li><p>1.三项构建WWW的技术。</p>
<ul>
<li>“把SGML（Standard Generalized Markup Language，标准通用标记语言）作为页面的文本标记语言的 HTML（HyperText Markup Language，超文本标记语言）；</li>
<li>作为文档传递协议的 HTTP ；</li>
<li>指定文档所在地址的 URL（Uniform Resource Locator，统一资源定位符）”</li>
</ul>
</li>
<li><p>2.“TCP/IP 协议族按层次分别分为以下 4 层：应用层、传输层、网络层和数据链路层。” </p>
<ul>
<li>“应用层决定了向用户提供应用服务时通信的活动。”  </li>
<li>“传输层对上层应用层，提供处于网络连接中的两台计算机之间的数据传输。”  </li>
<li>“网络层用来处理在网络上流动的数据包。数据包是网络传输的最小数据单位。该层规定了通过怎样的路径（所谓的传输路线）到达对方计算机，并把数据包传送给对方。”    </li>
<li>“链路层用来处理连接网络的硬件部分。包括控制操作系统、硬件的设备驱动、NIC（Network Interface Card，网络适配器，即网卡），及光纤等物理可见部分（还包括连接器等一切传输媒介）。硬件上的范畴均在链路层的作用范围之内。”</li>
</ul>
</li>
<li><p>3.三次握手<br>  “发送端首先发送一个带 SYN 标志的数据包给对方。接收端收到后，回传一个带有 SYN/ACK 标志的数据包以示传达确认信息。最后，发送端再回传一个带 ACK 标志的数据包，代表“握手”结束。”</p>
</li>
<li><p>4.DNS服务<br>“DNS 协议提供通过域名查找 IP 地址，或逆向从 IP 地址反查域名的服务。”</p>
</li>
<li><p>5.URI和URL的区别<br>  “URI 用字符串标识某一互联网资源，而 URL 表示资源的地点（互联网上所处的位置）。可见 URL 是 URI 的子集。”</p>
</li>
<li><p>6.HTTP/1.1中的方法</p>
<ul>
<li>“GET ：获取资源” “GET 方法用来请求访问已被 URI 识别的资源。指定的资源经服务器端解析后返回响应内容。也就是说，如果请求的资源是文本，那就保持原样返回；如果是像 CGI（Common Gateway Interface，通用网关接口）那样的程序，则返回经过执行后的输出结果。”</li>
<li>“POST：传输实体主体” “POST 方法用来传输实体的主体。”</li>
<li>PUT：传输文件 “PUT 方法用来传输文件。就像 FTP 协议的文件上传一样，要求在请求报文的主体中包含文件内容，然后保存到请求 URI 指定的位置。”</li>
<li>“HEAD：获得报文首部” “HEAD 方法和 GET 方法一样，只是不返回报文主体部分。用于确认 URI 的有效性及资源更新的日期时间等。”</li>
<li>DELETE：删除文件 “DELETE 方法用来删除文件，是与 PUT 相反的方法。DELETE 方法按请求 URI 删除指定的资源。”</li>
<li>“OPTIONS：询问支持的方法”  “OPTIONS 方法用来查询针对请求 URI 指定的资源支持的方法。”</li>
<li>TRACE：追踪路径 “TRACE 方法是让 Web 服务器端将之前的请求通信环回给客户端的方法。”</li>
<li> “CONNECT：要求用隧道协议连接代理” “CONNECT 方法要求在与代理服务器通信时建立隧道，实现用隧道协议进行 TCP 通信。主要使用 SSL（Secure Sockets Layer，安全套接层）和 TLS（Transport Layer Security，传输层安全）协议把通信内容加 密后经网络隧道传输。”</li>
</ul>
</li>
<li><p>7.“持久连接节省通信量”</p>
<ul>
<li>持久连接 “为解决上述 TCP 连接的问题，HTTP/1.1 和一部分的 HTTP/1.0 想出了持久连接（HTTP Persistent Connections，也称为 HTTP keep-alive 或 HTTP connection reuse）的方法。持久连接的特点是，只要任意一端没有明确提出断开连接，则保持 TCP 连接状态。”</li>
<li>管线化 “持久连接使得多数请求以管线化（pipelining）方式发送成为可能。从前发送请求后需等待并收到响应，才能发送下一个请求。管线化技术出现后，不用等待响应亦可直接发送下一个请求。”</li>
</ul>
</li>
<li><p>8.cookie<br>  “HTTP 是无状态协议，它不对之前发生过的请求和响应的状态进行管理。”<br>  “Cookie 会根据从服务器端发送的响应报文内的一个叫做 Set-Cookie 的首部字段信息，通知客户端保存 Cookie。当下次客户端再往该服务器发送请求时，客户端会自动在请求报文中加入 Cookie 值后发送出去。”</p>
</li>
<li><p>9.报文首部结构</p>
<ul>
<li>“请求行 包含用于请求的方法，请求 URI 和 HTTP 版本。</li>
<li>状态行 包含表明响应结果的状态码，原因短语和 HTTP 版本。    </li>
<li>首部字段 包含表示请求和响应的各种条件和属性的各类首部。一般有 4 种首部，分别是：通用首部、请求首部、响应首部和实体首部。</li>
<li>其他 可能包含 HTTP 的 RFC 里未定义的首部（Cookie 等）。”</li>
</ul>
</li>
<li><p>10.报文主体和实体主体的区别</p>
<ul>
<li>“报文（message）是 HTTP 通信中的基本单位，由 8 位组字节流（octet sequence，其中 octet 为 8 个比特）组成，通过 HTTP 通信传输。</li>
<li>实体（entity）作为请求或响应的有效载荷数据（补充项）被传输，其内容由实体首部和实体主体组成。”</li>
<li>“HTTP 报文的主体用于传输请求或响应的实体主体。通常，报文主体等于实体主体。只有当传输中进行编码操作时，实体主体的内容发生变化，才导致它和报文主体产生差异。”</li>
<li>报文主体相当于实际内容，实体主体相当于01数据，实体主体因为传输问题有可能被压缩，所以当编码操作后，实体主体可能会和报文主体不一致。</li>
</ul>
</li>
<li><p>11.“多部分对象集合包含的对象”</p>
<ul>
<li>multipart/form-data 在 Web 表单文件上传时使用。</li>
<li>multipart/byteranges 状态码 206（Partial Content，部分内容）响应报文包含了多个范围的内容时使用。</li>
</ul>
</li>
<li><p>12.常用的14种状态码</p>
<ul>
<li>200 OK “表示从客户端发来的请求在服务器端被正常处理了。”</li>
<li>204 No Content “该状态码代表服务器接收的请求已成功处理，但在返回的响应报文中不含实体的主体部分。”</li>
<li>206 Partial Content “该状态码表示客户端进行了范围请求，而服务器成功执行了这部分的 GET 请求。”</li>
<li>301 Moved Permanently “永久性重定向。该状态码表示请求的资源已被分配了新的 URI，以后应使用资源现在所指的 URI。”</li>
<li>302 Found “临时性重定向。该状态码表示请求的资源已被分配了新的 URI，希望用户（本次）能使用新的 URI 访问。”</li>
<li>303 See Other “该状态码表示由于请求对应的资源存在着另一个 URI，应使用 GET 方法定向获取请求的资源。”</li>
<li>304 Not Modified “该状态码表示客户端发送附带条件的请求时，服务器端允许请求访问资源，但未满足条件的情况。”</li>
<li>307 Temporary Redirect “临时重定向。该状态码与 302 Found 有着相同的含义。尽管 302 标准禁止 POST 变换成 GET，但实际使用时大家并不遵守。”</li>
<li>400 Bad Request “该状态码表示请求报文中存在语法错误。当错误发生时，需修改请求的内容后再次发送请求。”</li>
<li>401 Unauthorized “该状态码表示发送的请求需要有通过 HTTP 认证（BASIC 认证、DIGEST 认证）的认证信息。”</li>
<li>403 Forbidden “该状态码表明对请求资源的访问被服务器拒绝了。服务器端没有必要给出拒绝的详细理由，但如果想作说明的话，可以在实体的主体部分对原因进行描述，这样就能让用户看到了。”</li>
<li>404 Not Found “该状态码表明服务器上无法找到请求的资源。除此之外，也可以在服务器端拒绝请求且不想说明理由时使用。” </li>
<li>500 Internal Server Error “该状态码表明服务器端在执行请求时发生了错误。也有可能是 Web 应用存在的 bug 或某些临时的故障。”</li>
<li>503 Service Unavailable “该状态码表明服务器暂时处于超负载或正在进行停机维护，现在无法处理请求。”</li>
</ul>
</li>
<li><p>13.通信数据转发程序</p>
<ul>
<li>“代理。代理是一种有转发功能的应用程序，它扮演了位于服务器和客户端“中间人”的角色，接收由客户端发送的请求并转发给服务器，同时也接收服务器返回的响应并转发给客户端。”</li>
<li>“网关。网关是转发其他服务器通信数据的服务器，接收从客户端发送来的请求时，它就像自己拥有资源的源服务器一样对请求进行处理。有时客户端可能都不会察觉，自己的通信目标是一个网关。”</li>
<li>“隧道。隧道是在相隔甚远的客户端和服务器两者之间进行中转，并保持双方通信连接的应用程序。”</li>
</ul>
</li>
<li><p>14.“4 种 HTTP 首部字段类型”</p>
<ul>
<li>“通用首部字段（General Header Fields）请求报文和响应报文两方都会使用的首部。”</li>
<li>“请求首部字段（Request Header Fields）从客户端向服务器端发送请求报文时使用的首部。补充了请求的附加内容、客户端信息、响应内容相关优先级等信息。”</li>
<li>“响应首部字段（Response Header Fields）从服务器端向客户端返回响应报文时使用的首部。补充了响应的附加内容，也会要求客户端附加额外的内容信息。”</li>
<li>“实体首部字段（Entity Header Fields）针对请求报文和响应报文的实体部分使用的首部。补充了资源内容更新时间等与实体有关的信息。”</li>
</ul>
</li>
<li><p>15.HTTP/1.1 首部字段</p>
<ul>
<li>通用首部字段<ul>
<li>“Cache-Control通过指定首部字段 Cache-Control 的指令，就能操作缓存的工作机制。”<ul>
<li> “public 指令。当指定使用 public 指令时，则明确表明其他用户也可利用缓存。”</li>
<li> “private指令。当指定 private 指令后，响应只以特定的用户作为对象，这与 public 指令的行为相反。”</li>
<li> “no-cache指令。使用 no-cache 指令的目的是为了防止从缓存中返回过期的资源。”</li>
<li> “no-store 指令。当使用 no-store 指令时，暗示请求（和对应的响应）或响应中包含机密信息。”</li>
<li> “s-maxage 指令。s-maxage 指令的功能和 max-age 指令的相同，它们的不同点是 s-maxage 指令只适用于供多位用户使用的公共缓存服务器。也就是说，对于向同一用户重复返回响应的服务器来说，这个指令没有任何作用。”</li>
<li> “max-age指令。当客户端发送的请求中包含 max-age 指令时，如果判定缓存资源的缓存时间数值比指定时间的数值更小，那么客户端就接收缓存的资源。另外，当指定 max-age 值为 0，那么缓存服务器通常需要将请求转发给源服务器。”</li>
<li> “min-fresh指令。min-fresh指令要求缓存服务器返回至少还未过指定时间的缓存资源。”</li>
<li> “max-stale 指令。使用 max-stale 可指示缓存资源，即使过期也照常接收。”</li>
<li> “only-if-cached 指令。使用 only-if-cached 指令表示客户端仅在缓存服务器本地缓存目标资源的情况下才会要求其返回。”</li>
<li> “must-revalidate 指令。使用 must-revalidate 指令，代理会向源服务器再次验证即将返回的响应缓存目前是否仍然有效。”</li>
<li> “proxy-revalidate 指令。proxy-revalidate 指令要求所有的缓存服务器在接收到客户端带有该指令的请求返回响应之前，必须再次验证缓存的有效性。”</li>
<li> no-transform 指令。“使用 no-transform 指令规定无论是在请求还是响应中，缓存都不能改变实体主体的媒体类型。”</li>
</ul>
</li>
<li>Connection 首部字段具备如下两个作用。<ul>
<li>控制不再转发给代理的首部字段。“在客户端发送请求和服务器返回响应内，使用 Connection 首部字段，可控制不再转发给代理的首部字段（即 Hop-by-hop 首部）。”</li>
<li>管理持久连接。“HTTP/1.1 版本的默认连接都是持久连接。为此，客户端会在持久连接上连续发送请求。当服务器端想明确断开连接时，则指定 Connection 首部字段的值为 Close。”</li>
</ul>
</li>
<li>“Datte首部字段,Date表明创建HTTP报文的日期和时间。”</li>
<li>“Pragma首部字段。Pragma 是 HTTP/1.1 之前版本的历史遗留字段，仅作为与 HTTP/1.0 的向后兼容而定义。”</li>
<li>“Trailer首部字段。Trailer 会事先说明在报文主体后记录了哪些首部字段。该首部字段可应用在 HTTP/1.1 版本分块传输编码时。”</li>
<li>“Transfer-Encoding首部字段 。Transfer-Encoding 规定了传输报文主体时采用的编码方式。”</li>
<li>“Upgrade首部字段。Upgrade 用于检测 HTTP 协议及其他协议是否可使用更高的版本进行通信，其参数值可以用来指定一个完全不同的通信协议。”</li>
<li>“Via首部字段。Via 是为了追踪客户端与服务器之间的请求和响应报文的传输路径。”</li>
<li>“Warning首部字段。HTTP/1.1 的 Warning 首部是从 HTTP/1.0 的响应首部（Retry-After）演变过来的。该首部通常会告知用户一些与缓存相关的问题的警告。”<ul>
<li>“110    Response is stale（响应已过期）代理返回已过期的资源</li>
<li>111    Revalidation failed（再验证失败）代理再验证资源有效性时失败（服务器无法到达等原因）</li>
<li>112    Disconnection operation（断开连接操作）代理与互联网连接被故意切断</li>
<li>113    Heuristic expiration（试探性过期）响应的使用期超过24小时（有效缓存的设定时间大于24小时的情况下）</li>
<li>199    Miscellaneous warning（杂项警告）任意的警告内容</li>
<li>214    Transformation applied（使用了转换）代理对内容编码或媒体类型等执行了某些处理时</li>
<li>299    Miscellaneous persistent warning（持久杂项警告）任意的警告内容”</li>
</ul>
</li>
</ul>
</li>
<li><pre><code>请求首部字段      * Accept首部字段。“Accept 首部字段可通知服务器，用户代理能够处理的媒体类型及媒体类型的相对优先级。可使用 type/subtype 这种形式，一次指定多种媒体类型。”      * Accept-Charset首部字段。“Accept-Charset 首部字段可用来通知服务器用户代理支持的字符集及字符集的相对优先顺序。另外，可一次性指定多种字符集。与首部字段 Accept 相同的是可用权重 q 值来表示相对优先级。”      * Accept-Encoding首部字段。“Accept-Encoding 首部字段用来告知服务器用户代理支持的内容编码及内容编码的优先级顺序。可一次性指定多种内容编码。”      * Accept-Language首部字段。“首部字段 Accept-Language 用来告知服务器用户代理能够处理的自然语言集（指中文或英文等），以及自然语言集的相对优先级。可一次指定多种自然语言集。”      * Authorization首部字段。“首部字段 Authorization 是用来告知服务器，用户代理的认证信息（证书值）。”      * Expect首部字段。“客户端使用首部字段 Expect 来告知服务器，期望出现的某种特定行为。”      * From首部字段。“首部字段 From 用来告知服务器使用用户代理的用户的电子邮件地址。”      * Host首部字段。“首部字段 Host 会告知服务器，请求的资源所处的互联网主机名和端口号。Host 首部字段在 HTTP/1.1 规范内是唯一一个必须被包含在请求内的首部字段。”      * If-Match首部字段。“形如 If-xxx 这种样式的请求首部字段，都可称为条件请求。服务器接收到附带条件的请求后，只有判断指定条件为真时，才会执行请求。”      * If-Modified-Since首部字段。“首部字段 If-Modified-Since，属附带条件之一，它会告知服务器若 If-Modified-Since 字段值早于资源的更新时间，则希望能处理该请求。而在指定 If-Modified-Since 字段值的日期时间之后，如果请求的资源都没有过更新，则返回状态码 304 Not Modified 的响应。”      * If-None-Match首部字段。“首部字段 If-None-Match 属于附带条件之一。它和首部字段 If-Match 作用相反。用于指定 If-None-Match 字段值的实体标记（ETag）值与请求资源的 ETag 不一致时，它就告知服务器处理该请求。”      * If-Range首部字段。“首部字段 If-Range 属于附带条件之一。它告知服务器若指定的 If-Range 字段值（ETag 值或者时间）和请求资源的 ETag 值或时间相一致时，则作为范围请求处理。反之，则返回全体资源。”      * If-Unmodified-Since首部字段。“首部字段 If-Unmodified-Since 和首部字段 If-Modified-Since 的作用相反。它的作用的是告知服务器，指定的请求资源只有在字段值内指定的日期时间之后，未发生更新的情况下，才能处理请求。如果在指定日期时间后发生了更新，则以状态码 412 Precondition Failed 作为响应返回。”      * Max-Forwards首部字段。“通过 TRACE 方法或 OPTIONS 方法，发送包含首部字段 Max-Forwards 的请求时，该字段以十进制整数形式指定可经过的服务器最大数目。服务器在往下一个服务器转发请求之前，Max-Forwards 的值减 1 后重新赋值。当服务器接收到 Max-Forwards 值为 0 的请求时，则不再进行转发，而是直接返回响应。”      * Proxy-Authorization首部字段。“接收到从代理服务器发来的认证质询时，客户端会发送包含首部字段 Proxy-Authorization 的请求，以告知服务器认证所需要的信息。”      * “Range首部字段。对于只需获取部分资源的范围请求，包含首部字段 Range 即可告知服务器资源的指定范围。上面的示例表示请求获取从第 5001 字节至第 10000 字节的资源。”      * Referer首部字段。“首部字段 Referer 会告知服务器请求的原始资源的 URI。”      * “TE首部字段。首部字段 TE 会告知服务器客户端能够处理响应的传输编码方式及相对优先级。它和首部字段 Accept-Encoding 的功能很相像，但是用于传输编码。”      * User-Agent首部字段。“首部字段 User-Agent 会将创建请求的浏览器和用户代理名称等信息传达给服务器。”
</code></pre>
</li>
<li>响应首部字段<ul>
<li>Accept-Ranges首部字段。“首部字段 Accept-Ranges 是用来告知客户端服务器是否能处理范围请求，以指定获取服务器端某个部分的资源。”</li>
<li>Age首部字段。“首部字段 Age 能告知客户端，源服务器在多久前创建了响应。字段值的单位为秒。”</li>
<li>ETag首部字段。“首部字段 ETag 能告知客户端实体标识。它是一种可将资源以字符串形式做唯一性标识的方式。服务器会为每份资源分配对应的 ETag 值。”</li>
<li>Location首部字段。“使用首部字段 Location 可以将响应接收方引导至某个与请求 URI 位置不同的资源。”</li>
<li>“Proxy-Authenticate首部字段。首部字段 Proxy-Authenticate 会把由代理服务器所要求的认证信息发送给客户端。”</li>
<li>Retry-After首部字段。“首部字段 Retry-After 告知客户端应该在多久之后再次发送请求。主要配合状态码 503 Service Unavailable 响应，或 3xx Redirect 响应一起使用。”</li>
<li>Server首部字段。“首部字段 Server 告知客户端当前服务器上安装的 HTTP 服务器应用程序的信息。”</li>
<li>Vary首部字段。“首部字段 Vary 可对缓存进行控制。源服务器会向代理服务器传达关于本地缓存使用方法的命令。”</li>
<li>WWW-Authenticate首部字段。“首部字段 WWW-Authenticate 用于 HTTP 访问认证。它会告知客户端适用于访问请求 URI 所指定资源的认证方案（Basic 或是 Digest）和带参数提示的质询（challenge）。状态码 401 Unauthorized 响应中，肯定带有首部字段 WWW-Authenticate。”</li>
</ul>
</li>
<li>实体首部字段<ul>
<li>Allow首部字段。“首部字段 Allow 用于通知客户端能够支持 Request-URI 指定资源的所有 HTTP 方法。”</li>
<li>Content-Encoding首部字段。“首部字段 Content-Encoding 会告知客户端服务器对实体的主体部分选用的内容编码方式。”</li>
<li>Content-Language首部字段。“首部字段 Content-Language 会告知客户端，实体主体使用的自然语言（指中文或英文等语言）。”</li>
<li>Content-Length首部字段。“首部字段 Content-Length 表明了实体主体部分的大小（单位是字节）。”</li>
<li>Content-Location首部字段。“首部字段 Content-Location 给出与报文主体部分相对应的 URI。和首部字段 Location 不同，Content-Location 表示的是报文主体返回资源对应的 URI。”</li>
<li>Content-MD5首部字段。“首部字段 Content-MD5 是一串由 MD5 算法生成的值，其目的在于检查报文主体在传输过程中是否保持完整，以及确认传输到达。”</li>
<li>Content-Range首部字段。“针对范围请求，返回响应时使用的首部字段 Content-Range，能告知客户端作为响应返回的实体的哪个部分符合范围请求。”</li>
<li>Content-Type首部字段。“首部字段 Content-Type 说明了实体主体内对象的媒体类型。”</li>
<li>Expires首部字段。“首部字段 Expires 会将资源失效的日期告知客户端。”</li>
<li>Last-Modified首部字段。“首部字段 Last-Modified 指明资源最终修改的时间。”</li>
</ul>
</li>
<li>为 Cookie 服务的首部字段<ul>
<li>Set-Cookie首部字段。“开始状态管理所使用的Cookie信息”，属于响应首部字段。<ul>
<li>“expires 属性。Cookie 的 expires 属性指定浏览器可发送 Cookie 的有效期。”</li>
<li>“path 属性。Cookie 的 path 属性可用于限制指定 Cookie 的发送范围的文件目录。”</li>
<li>“domain 属性。通过 Cookie 的 domain 属性指定的域名可做到与结尾匹配一致。”</li>
<li>“secure 属性。Cookie 的 secure 属性用于限制 Web 页面仅在 HTTPS 安全连接时，才可以发送 Cookie。”</li>
<li>“HttpOnly 属性。Cookie 的 HttpOnly 属性是 Cookie 的扩展功能，它使 JavaScript 脚本无法获得 Cookie。”</li>
</ul>
</li>
<li>Cookie首部字段。“服务器接收到的Cookie信息”，属于请求首部字段。<ul>
<li>Cookie首部字段。“首部字段 Cookie 会告知服务器，当客户端想获得 HTTP 状态管理支持时，就会在请求中包含从服务器接收到的 Cookie。接收到多个 Cookie 时，同样可以以多个 Cookie 形式发送。”</li>
</ul>
</li>
</ul>
</li>
<li>其他首部字段<ul>
<li>X-Frame-Options首部字段。“首部字段 X-Frame-Options 属于 HTTP 响应首部，用于控制网站内容在其他 Web 网站的 Frame 标签内的显示问题。其主要目的是为了防止点击劫持（clickjacking）攻击。”<ul>
<li>“DENY ：拒绝</li>
<li>SAMEORIGIN ：仅同源域名下的页面（Top-level-browsing-context）匹配时许可。”</li>
</ul>
</li>
<li>“X-XSS-Protection首部字段。首部字段 X-XSS-Protection 属于 HTTP 响应首部，它是针对跨站脚本攻击（XSS）的一种对策，用于控制浏览器 XSS 防护机制的开关。”<ul>
<li>0 ：将 XSS 过滤设置成无效状态</li>
<li>1 ：将 XSS 过滤设置成有效状态</li>
</ul>
</li>
<li>“DNT首部字段。首部字段 DNT 属于 HTTP 请求首部，其中 DNT 是 Do Not Track 的简称，意为拒绝个人信息被收集，是表示拒绝被精准广告追踪的一种方法。”<ul>
<li>0 ：同意被追踪</li>
<li>1 ：拒绝被追踪</li>
</ul>
</li>
<li>“P3P首部字段。首部字段 P3P 属于 HTTP 相应首部，通过利用 P3P（The Platform for Privacy Preferences，在线隐私偏好平台）技术，可以让 Web 网站上的个人隐私变成一种仅供程序可理解的形式，以达到保护用户隐私的目的。”</li>
</ul>
</li>
</ul>
</li>
<li><p>16.HTTPS</p>
<ul>
<li>“HTTP+ 加密 + 认证 + 完整性保护 =HTTPS”</li>
<li>“HTTPS 并非是应用层的一种新协议。只是 HTTP 通信接口部分用 SSL（Secure Socket Layer）和 TLS（Transport Layer Security）协议代替而已。”</li>
<li>“使用公开密钥加密方式，发送密文的一方使用对方的公开密钥进行加密处理，对方收到被加密的信息后，再使用自己的私有密钥进行解密。”（公钥进行加密，收到数据的一方使用自己的私钥将加密的数据解密。客户端使用公钥加密数据，服务器使用私钥解密。）</li>
<li>“HTTPS 采用共享密钥加密和公开密钥加密两者并用的混合加密机制。在交换密钥环节使用公开密钥加密方式，之后的建立通信交换报文阶段则使用共享密钥加密方式。”</li>
</ul>
</li>
<li><p>17.HTTPS通信步骤  </p>
<ul>
<li>“步骤 1： 客户端通过发送 Client Hello 报文开始 SSL 通信。报文中包含客户端支持的 SSL 的指定版本、加密组件（Cipher Suite）列表（所使用的加密算法及密钥长度等）。</li>
<li>步骤 2： 服务器可进行 SSL 通信时，会以 Server Hello 报文作为应答。和客户端一样，在报文中包含 SSL 版本以及加密组件。服务器的加密组件内容是从接收到的客户端加密组件内筛选出来的。</li>
<li>步骤 3： 之后服务器发送 Certificate 报文。报文中包含公开密钥证书。</li>
<li>步骤 4： 最后服务器发送 Server Hello Done 报文通知客户端，最初阶段的 SSL 握手协商部分结束。</li>
<li>“步骤 5： SSL 第一次握手结束之后，客户端以 Client Key Exchange 报文作为回应。报文中包含通信加密中使用的一种被称为 Pre-master secret 的随机密码串。该报文已用步骤 3 中的公开密钥进行加密。</li>
<li>步骤 6： 接着客户端继续发送 Change Cipher Spec 报文。该报文会提示服务器，在此报文之后的通信会采用 Pre-master secret 密钥加密。</li>
<li>步骤 7：客户端发送 Finished 报文。该报文包含连接至今全部报文的整体校验值。这次握手协商是否能够成功，要以服务器是否能够正确解密该报文作为判定标准。</li>
<li>步骤 8： 服务器同样发送 Change Cipher Spec 报文。</li>
<li>步骤 9： 服务器同样发送 Finished 报文。</li>
<li>步骤 10： 服务器和客户端的 Finished 报文交换完毕之后，SSL 连接就算建立完成。当然，通信会受到 SSL 的保护。从此处开始进行应用层协议的通信，即发送 HTTP 请求。</li>
<li>步骤 11： 应用层协议通信，即发送 HTTP 响应。</li>
<li>“步骤 12： 最后由客户端断开连接。断开连接时，发送 close_notify 报文。上图做了一些省略，这步之后再发送 TCP FIN 报文来关闭与 TCP 的通信。”</li>
</ul>
</li>
<li><p>18.“Cookie 来管理 Session”</p>
<ul>
<li>步骤 1： 客户端把用户 ID 和密码等登录信息放入报文的实体部分，通常是以 POST 方法把请求发送给服务器。而这时，会使用 HTTPS 通信来进行 HTML 表单画面的显示和用户输入数据的发送。</li>
<li>步骤 2： 服务器会发放用以识别用户的 Session ID。通过验证从客户端发送过来的登录信息进行身份认证，然后把用户的认证状态与 Session ID 绑定后记录在服务器端。</li>
<li>“步骤 3： 客户端接收到从服务器端发来的 Session ID 后，会将其作为 Cookie 保存在本地。下次向服务器发送请求时，浏览器会自动发送 Cookie，所以 Session ID 也随之发送到服务器。服务器端可通过验证接收到的 Session ID 识别用户和其认证状态。”</li>
</ul>
</li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-框架/Dubbo框架/Dubbo简单Demo搭建"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
     
    <div class="article-meta">
      <a href="/2021/10/14/%E6%A1%86%E6%9E%B6/Dubbo%E6%A1%86%E6%9E%B6/Dubbo%E7%AE%80%E5%8D%95Demo%E6%90%AD%E5%BB%BA/" class="article-date">
  <time datetime="2021-10-14T10:09:31.648Z" itemprop="datePublished">2021-10-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%A1%86%E6%9E%B6/">框架</a> / <a class="article-category-link" href="/categories/%E6%A1%86%E6%9E%B6/Dubbo%E6%A1%86%E6%9E%B6/">Dubbo框架</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="Dubbo简单Demo搭建"><a href="#Dubbo简单Demo搭建" class="headerlink" title="Dubbo简单Demo搭建"></a>Dubbo简单Demo搭建</h2><p>​    上一篇博客简单介绍了一下Dubbo的一些背景，这一篇博客就开始上手一个简单Demo，只有成功的跑起来，才有继续学下去的动力，一直看资料多乏味啊。</p>
<h3 id="搭建注册中心"><a href="#搭建注册中心" class="headerlink" title="搭建注册中心"></a>搭建注册中心</h3><p>​    Dubbo是使用注册中心来注册服务和发现服务的。上一篇博客里面也有一个Dubbo结构图。挺形象的。Dubbo支持很多种注册中心，Nacos、Zookeeper、Multicast、Redis、Simple。官方推荐Zookeeper注册中心，我们这里也是搭建一个Zookeeper集群。其他的注册中心大家可以去官网了解一下。</p>
<p>​    Zookeeper的搭建因为之前学习过Docker，我这里直接就看了官方的文档，参考写了一个Compose文件，直接启动，下载镜像就可以了，很简单，也不需要很复杂的安装很多东西。这里贴上Compose文件，大家直接运行<code>docker-compose -f dubbo-compose.yml up -d</code>即可。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.1&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">zoo1:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">zoo1</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">zookeeper</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">zoo1</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">2181</span><span class="string">:2181</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">dubbo-net</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">ZOO_MY_ID:</span> <span class="number">1</span></span><br><span class="line">      <span class="attr">ZOO_SERVERS:</span> <span class="string">server.1=zoo1:2888:3888;2181</span> <span class="string">server.2=zoo2:2888:3888;2181</span> <span class="string">server.3=zoo3:2888:3888;2181</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">zoo2:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">zoo2</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">zookeeper</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">zoo2</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">2182</span><span class="string">:2181</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">dubbo-net</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">ZOO_MY_ID:</span> <span class="number">2</span></span><br><span class="line">      <span class="attr">ZOO_SERVERS:</span> <span class="string">server.1=zoo1:2888:3888;2181</span> <span class="string">server.2=zoo2:2888:3888;2181</span> <span class="string">server.3=zoo3:2888:3888;2181</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">zoo3:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">zoo3</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">zookeeper</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">zoo3</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">2183</span><span class="string">:2181</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">dubbo-net</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">ZOO_MY_ID:</span> <span class="number">3</span></span><br><span class="line">      <span class="attr">ZOO_SERVERS:</span> <span class="string">server.1=zoo1:2888:3888;2181</span> <span class="string">server.2=zoo2:2888:3888;2181</span> <span class="string">server.3=zoo3:2888:3888;2181</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">dubbo-admin:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">apache/dubbo-admin</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">dubbo-admin</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">8080</span><span class="string">:8080</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">dubbo-net</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">admin.registry.address=zookeeper://zoo1:2181?backup=zoo2:2181,zoo3:2181</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">admin.config-center=zookeeper://zoo1:2181?backup=zoo2:2181,zoo3:2181</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">admin.metadata-report.address=zookeeper://zoo1:2181?backup=zoo2:2181,zoo3:2181</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">zoo1</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">zoo2</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">zoo3</span></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">dubbo-net:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">dubbo-net</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span></span><br></pre></td></tr></table></figure>

<p>​    关于Zookeeper的一些知识后面有机会再学习吧，这一块感觉还挺有意思的。</p>
<h3 id="搭建监控中心"><a href="#搭建监控中心" class="headerlink" title="搭建监控中心"></a>搭建监控中心</h3><p>​    可以看到上面不止启动了一个容器，还有一个dubbo-admin的镜像，这个镜像就是dubbo的管理平台，但是它的界面是这个样子。</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210824224955559.png" alt="image-20210824224955559"></p>
<p>​    和我最开始接触老版的管理界面不一样，老版的页面看GitHub上已经不再更新了，界面如下：</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210824225323418.png" alt="image-20210824225323418"></p>
<p>​    这个监控平台也很好弄，从官网下载老版代码，修改对应的配置，然后直接<code>java -jar dubbo-admin-0.0.1-SNAPSHOT.jar </code>即可。地址如下：<a target="_blank" rel="noopener" href="https://github.com/apache/dubbo-admin/tree/master-0.2.0">老版监控平台代码仓库</a>。</p>
<p>​    需要注意，配置文件修改Zookeeper地址时，修改为如下形式。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">dubbo.registry.address=zookeeper://127.0.0.1:2181?backup=127.0.0.1:2181,127.0.0.1:2181</span></span><br></pre></td></tr></table></figure>

<h3 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h3><p>​    先说一下项目的构成。是一个maven项目，里面有三个子模块，分别是API、生产者和消费者。结构图如下：</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210824230320055.png" alt="image-20210824230320055"></p>
<ul>
<li>API模块：如果生产者需要被多个消费者调用，接口在这些项目中粘贴也不太好，这里将接口定义在API模块中，这样，其他项目直接倒入依赖就可以了，你还可以将这个API打包到你的本地maven仓库。</li>
<li>consumer模块：就是消费者模块，和前端交互的模块。</li>
<li>provider模块：生产者模块，业务的主要实现的地方，例如数据库的查询就是在这个模块。</li>
</ul>
<p>​    父pom文件如下：因为用到的东西比较少，所以依赖不是很多。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.psq<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot-exercise<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>springboot-exercise<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>dubbo-service-provider<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>dubbo-service-consumer<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>dubbo-service-api<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--  个人写代码方便，实际开发不推荐      --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--   SpringBoot依赖  --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="生产者代码编写"><a href="#生产者代码编写" class="headerlink" title="生产者代码编写"></a>生产者代码编写</h3><p>​    生产者先说pom依赖，如果你导入的是阿里的Dubbo依赖，不需要再导入其他依赖了，但是如果你导入的是apache的Dubbo依赖，你需要再根据你使用的注册中心再导入一个依赖，我这里需要再导入一个zookeeper的依赖，pom文件如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot-exercise<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.psq<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo-service-provider<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--  API依赖      --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.psq<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo-service-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 导入这个依赖就不需要再导入其他依赖了 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;dependency&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;groupId&gt;com.alibaba.boot&lt;/groupId&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;artifactId&gt;dubbo-spring-boot-starter&lt;/artifactId&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;version&gt;0.2.0&lt;/version&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;/dependency&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--  下面是导入apacheDubbo的方式     --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.dubbo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.dubbo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dubbo-dependencies-zookeeper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    生产者还需要再配置一些Dubbo的配置，配置文件代码如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">dubbo-service-provider</span></span><br><span class="line"><span class="attr">dubbo:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">dubbo-service-provider</span></span><br><span class="line">  <span class="attr">registry:</span></span><br><span class="line">    <span class="attr">address:</span> <span class="string">zookeeper://127.0.0.1:2181,127.0.0.1:2182,127.0.0.1:2183</span></span><br><span class="line">    <span class="attr">protocol:</span> <span class="string">dubbo</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">20880</span></span><br><span class="line">  <span class="attr">scan:</span></span><br><span class="line">    <span class="attr">base-packages:</span> <span class="string">com.psq.dubbboserviceprovider.server</span></span><br></pre></td></tr></table></figure>

<p>​    需要注意你的applicationname不能和消费者一样，最好这个服务唯一，多个相同生产者相同。zookeeper需要注意集群的配置形式，其他的配置也可以看看官方的文档。如下：<a target="_blank" rel="noopener" href="https://dubbo.apache.org/zh/docs/references/xml/dubbo-registry/">Dubbo官方配置文档</a>。</p>
<p>​    这里只是简单demo，就打印一个hello world吧，一个接口，只是返回一个字符串。API的接口代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psq.dubboserviceapi.service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * com.psq.dubboserviceapi.service.SayHelloService.java</span></span><br><span class="line"><span class="comment"> * Description: 示例接口</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Peng Shiquan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/15</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SayHelloService</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Description:示例方法</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> java.lang.String</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Author</span> Peng Shiquan</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span> 2021-08-15</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">String <span class="title">sayHello</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    实现方法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psq.dubbboserviceprovider.server;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.psq.dubboserviceapi.service.SayHelloService;</span><br><span class="line"><span class="keyword">import</span> org.apache.dubbo.config.annotation.Service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * com.psq.dubbboserviceprovider.server.SayHelloServiceImpl.java</span></span><br><span class="line"><span class="comment"> * Description: SayHelloServiceImpl</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Peng Shiquan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/15</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SayHelloServiceImpl</span> <span class="keyword">implements</span> <span class="title">SayHelloService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;This dubbo test&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    需要注意这里的service注解不是spring的注解。是Dubbo的注解。</p>
<h3 id="消费者代码编写"><a href="#消费者代码编写" class="headerlink" title="消费者代码编写"></a>消费者代码编写</h3><p>​    消费者代码相差不多，pom文件和生产者类似，除了多了一个webstarter，这里就不再贴上代码了。</p>
<p>​    配置文件代码如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8081</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">dubbo-service-consumer</span></span><br><span class="line"></span><br><span class="line"><span class="attr">dubbo:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">dubbo-service-consumer</span></span><br><span class="line">  <span class="attr">registry:</span></span><br><span class="line">    <span class="attr">address:</span> <span class="string">zookeeper://127.0.0.1:2181,127.0.0.1:2182,127.0.0.1:2183</span></span><br><span class="line">    <span class="attr">protocol:</span> <span class="string">dubbo</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">20881</span></span><br></pre></td></tr></table></figure>

<p>​    需要注意不要和你的监控中心端口冲突。其他就没有需要注意的了。</p>
<p>​    这里就简单写一个http请求接口，直接访问生产者的代码，具体代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psq.dubboserviceconsumer.controlle;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.psq.dubboserviceapi.service.SayHelloService;</span><br><span class="line"><span class="keyword">import</span> org.apache.dubbo.config.annotation.Reference;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * SayHelloController.java</span></span><br><span class="line"><span class="comment"> * Description:</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Peng Shiquan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/8/21</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SayHelloController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Reference</span></span><br><span class="line">    <span class="keyword">private</span> SayHelloService sayHelloService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/sayHello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String result = sayHelloService.sayHello();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    启动两个服务后，访问地址：<a target="_blank" rel="noopener" href="http://localhost:8081/sayHello%E5%87%BA%E7%8E%B0%E4%BB%A5%E4%B8%8B%E7%94%BB%E9%9D%A2%E5%8D%B3%E4%BB%A3%E8%A1%A8%E8%B0%83%E7%94%A8%E6%88%90%E5%8A%9F%EF%BC%8C%E7%9B%91%E6%8E%A7%E4%B8%AD%E5%BF%83%E4%B9%9F%E4%BC%9A%E6%9C%89%E5%AF%B9%E5%BA%94%E7%9A%84%E8%AE%B0%E5%BD%95%E3%80%82">http://localhost:8081/sayHello出现以下画面即代表调用成功，监控中心也会有对应的记录。</a></p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210824232818441.png" alt="image-20210824232818441"></p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210824232906127.png" alt="image-20210824232906127"></p>
<p>​    至此，Dubbo的简单Demo就完成了，后续会慢慢补充一下配置的相关信息和对于Dubbo底层的学习。</p>
<p>​    就这样吧，结束。</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-框架/Dubbo框架/Dubbo背景了解"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
     
    <div class="article-meta">
      <a href="/2021/10/14/%E6%A1%86%E6%9E%B6/Dubbo%E6%A1%86%E6%9E%B6/Dubbo%E8%83%8C%E6%99%AF%E4%BA%86%E8%A7%A3/" class="article-date">
  <time datetime="2021-10-14T10:09:31.648Z" itemprop="datePublished">2021-10-14</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%A1%86%E6%9E%B6/">框架</a> / <a class="article-category-link" href="/categories/%E6%A1%86%E6%9E%B6/Dubbo%E6%A1%86%E6%9E%B6/">Dubbo框架</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="Dubbbo背景了解"><a href="#Dubbbo背景了解" class="headerlink" title="Dubbbo背景了解"></a>Dubbbo背景了解</h2><p>​    最近有时间了，同时工作中用到了Dubbo，所以后面慢慢会写一些相关的博客。</p>
<p>​    作为一个技术，我认为最开始的学习要先了解其背景，知道这项技术为什么产生，我们项目中为什么使用这项技术，以及这项技术的优点在什么地方。其实这个在面试中也会经常问到。知道这些后，才能在项目技术选择中更加游刃有余。不多说了，直接开始吧。</p>
<p>​    这一部分知识其实来源于Dubbo的官网，大家也可以在官网上直接查看，我一直认为官方文档应该是第一手参考资料。</p>
<p>​    官网地址：<a target="_blank" rel="noopener" href="https://dubbo.apache.org/zh/">dubbo官网</a></p>
<h3 id="网站应用演进"><a href="#网站应用演进" class="headerlink" title="网站应用演进"></a>网站应用演进</h3><p>​        网站其实是按照用户量来慢慢演进的。最开始用户少，只有几百个用户，所以简单的单体应用就能满足需求，这里和我们平时编写的练手项目相差不多。</p>
<p>​    但是随着用户慢慢增多，单体应用不再满足我们的需求，需要将应用按照业务拆分开来，即将不相关的业务拆分成不同的项目，部署在不同的机器上。</p>
<p>​    但是这种情况比较特殊，只适合特定的几个情况，大多数的业务都是有一定依赖条件的。这个时候就产生了远程过程调用（RPC），Dubbo就是一种RPC框架。这种框架能够自动注册到中心，发现需要的服务并且调用。这样，我们就能够在不同的机器上跑业务相关的代码了。</p>
<p>​    其实这一阶段基本在用户层面就已经满足了，随着用户的增多，只需要增加服务基本就能满足需求了。但是在我们的角度来看，仍然不是很好，因为不同的业务访问量是不一样的，所以如何让资源随着访问量动态的变化就显得极为重要。这个也是网站演进的下一步：流动计算架构。这里了解不多，不再现眼了。</p>
<p>​    以上都是个人的理解，可能部分地方有出入，还希望大佬们指正。</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210823231313441.png" alt="image-20210823231313441"></p>
<h3 id="Dubbo是什么"><a href="#Dubbo是什么" class="headerlink" title="Dubbo是什么"></a>Dubbo是什么</h3><p>​    看完了上面关于网站架构的演进，下面我们就来说一下Dubbo是什么。</p>
<pre><code> Dubbo是一款高性能、轻量级的开源Java RPC框架，它提供了三大核心能力：面向接口的远程方法调用，智能容错和负载均衡，以及服务自动注册和发现。

 这个是百度百科上面找到的解释。可以看到Dubbo是一个能够无缝整合到spring中的rpc框架。它能够提供服务的发现，服务的调用和服务的负载均衡。

 说白了，就相当于一个中间件，能够让我们的消费者（相当于业务调用方，有点类似于mvc中controller）调用消费者（业务实现方，有点类似于controller调用的service）。当然消费者可以和生产者不在同一台机器上，这就要做到服务的发现。最后的负载均衡就是服务调用的优化，让每一个消费者的调用频率相差不多（消费者权值相同的情况下）。
</code></pre>
<h3 id="Dubbo解决了什么问题"><a href="#Dubbo解决了什么问题" class="headerlink" title="Dubbo解决了什么问题"></a>Dubbo解决了什么问题</h3><p> Dubbo解决了什么问题呢？对于不同服务的调用，我编写http服务，传json也可以达到类似的效果。这就要说到Dubbo的优点了。</p>
<ul>
<li>Dubbo是面向代理的高性能RPC调用。我们自己编写的http调用能够满足一些对性能要求不高的接口，但是如果某个接口对性能要求比较高，我们编写的代码就显得很吃力了。Dubbo毕竟是阿里出的，性能这一块肯定要比我们自己的强（大佬除外）。所以我认为Dubbo基本满足了大部分项目的需求。</li>
<li>服务的自动注册发现。我们服务少还好说，我们甚至可以将服务的地址写到代码中或者做成配置文件，但是服务多了后，这个代码或者配置文件就显得臃肿，而且有些服务挂掉后，及时的更新配置文件也是我们要考虑的问题。Dubbo也是能够自动的注册服务，并且发现自己需要的服务，在某些服务挂掉后，也能够及时的更新。</li>
<li>我们自己编写的服务调用对于每次的调用很难监控起来，多数情况下，我们自己的监控系统考虑的情况都是比较少的。但是随着业务的增长，这一部分无法监控的地方也是格外重要，例如：什么时间段访问量增多，哪个服务的调用最多，哪个服务调用的最少。我们根据这些监控信息来达到对不同服务的定制化维护，减少资源的消耗和对系统峰值的把控。</li>
<li>扩展能力。Dubbo里面有很多的扩展点，所有核心能力如Protocol、Transport、Serialization都被设计为扩展点，可以达到自己系统独特的定制效果。（目前这一块了解较少）</li>
</ul>
<h3 id="Dubbo的一些基础结构"><a href="#Dubbo的一些基础结构" class="headerlink" title="Dubbo的一些基础结构"></a>Dubbo的一些基础结构</h3><p> 看了Dubbo的背景，了解了Dubbo是什么东西，并且知道了Dubbo解决了什么问题后，我们就可以看看Dubbo的基础结构。我一直认为学技术要总体的看一遍这个技术，知道各个部分大概是什么东西，代表了什么意思，再去扣细节比较容易理解。</p>
<p><img src="https://1162210866.oss-cn-beijing.aliyuncs.com/uPic/image-20210823231413386.png" alt="image-20210823231413386"></p>
<p> Dubbo分为五个大块，生产者、消费者、注册中心、监控中心、运行容器。</p>
<ul>
<li><p>Provider：服务的提供方。一般是我们代码的实现部分，例如查询数据库的操作。</p>
</li>
<li><p> Consumer：服务的消费方，消费生产者提供的服务。一般和web层交互的一方。</p>
</li>
<li><p>Registry：注册中心，一般是zookeeper，只提供服务的注册和发现，不对请求做转发。</p>
</li>
<li><p>Monitor：监控中心，独立的服务或者应用，是否启动和是否正常不对系统整体有影响，只是对每次的调用做记录和统计。</p>
</li>
<li><p>Container：运行容器，负责启动、加载、运行生产者的服务。</p>
</li>
</ul>
<p>​    概念其实不难理解，后面上手代码的时候也会发现这些东西很容易就明白了。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>​    这片博客简单的介绍了Dubbo的历史背景，解决了什么问题，以及Dubbo的一些基础的结构。没有经历过网站用户量的增长过程，所以对于这些背景都是看过，没有实际接触过。也算是一个遗憾吧，不知道自己经历了这些场景，会不会有一些不一样的想法。</p>
<p>​    下一篇博客会简单的写一个Dubbo的例子，从搭建注册中心和监控中心开始，一直到写一个Hello world的例子为止。</p>
<p>​    就这样吧，结束。</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
    
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/3/">上一页</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/5/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2015-2021
        <i class="ri-heart-fill heart_icon"></i> John Doe
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="Hexo"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/%E6%97%85%E8%A1%8C/">旅行</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="http://shenyu-vip.lofter.com">摄影</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">友链</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/2019/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>